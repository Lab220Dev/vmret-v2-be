import{H as E}from"./vue-datepicker-6e00734e.js";import{r as n,e as se,m as ne,s as re,g as i,o as h,c as N,d as l,h as s,y as P,a as M,w as c,z as H,F as de,l as _,i as Q,t as B,A as ie}from"./index-9455c001.js";/* empty css             */import{L as ce}from"./LoadingSpinner-cd745a8e.js";import"./format-7e97a1d1.js";const ue={class:"card vh"},pe={class:"form"},ve={class:"grid mt-3 mx-1 px-1"},_e=l("h5",{class:"my-4 text-2xl"},"Histórico de Abastecimento",-1),me={key:0,class:"p-0 m-0 p-fluid formgrid grid col-12"},fe={class:"field lg:col-4 md:col-6 sm:col-6"},he=l("label",{for:"dm"},"DM:",-1),be={class:"field lg:col-4 md:col-6 sm:col-6"},ye=l("label",{for:"planta"},"Planta:",-1),we={class:"field lg:col-4 md:col-6 sm:col-6"},ge=l("label",{for:"perfil"},"Setor:",-1),Ve={class:"field lg:col-6 md:col-6 sm:col-6"},De=l("label",{for:"perfil"},"Centro de Custo:",-1),Ie={class:"field lg:col-6 md:col-6 sm:col-6"},ke=l("label",{for:"perfil"},"Operador:",-1),Ce={class:"field lg:col-4 md:col-6 sm:col-6"},Me=l("label",{for:"perfil"},"Data Inicial:",-1),Be={class:"field lg:col-4 md:col-6 sm:col-6"},Oe=l("label",{for:"perfil"},"Data Final:",-1),$e={class:"field lg:col-4 md:col-6 sm:col-6"},xe={class:"datatable-wrapper"},Fe={class:"flex justify-content-end"},Se=l("i",{class:"pi pi-search"},null,-1),Ne={__name:"historicosabastecimento",setup(Te){const O=n(!1),R=n(""),b=n(!1),d=se();ne();const y=n("Ainda não foi feita nenhuma busca"),w=n(null),g=n(null),V=n(null),D=n(null),I=n(null),k=n([]),u={label:"Todos",value:null},$=n(null),x=n([u]),F=n([u]),S=n([u]),T=n([u]),m=n({global:{value:null,matchMode:ie.CONTAINS}}),C=n(!0),A=n([]),o=n({dm:"",id_planta:"",id_centro_custo:"",id_setor:"",id_operador:"",data_inicio:new Date(new Date().getFullYear(),new Date().getMonth(),1),data_final:new Date}),U=t=>{const e=t.getDate(),a=t.getMonth()+1,p=t.getFullYear();return`${e}/${a}/${p}`},L=t=>t?new Date(t).toISOString():null,Y=async()=>{const t={id_cliente:d.userIdCliente,id_dm:o.value.dm===null?void 0:o.value.dm,id_planta:o.value.id_planta===null?void 0:o.value.id_planta,id_centro_custo:o.value.id_centro_custo===null?void 0:o.value.id_centro_custo,id_setor:o.value.id_setor===null?void 0:o.value.id_setor,id_funcionario:o.value.id_funcionario===null?void 0:o.value.id_funcionario,data_inicio:L(o.value.data_inicio),data_final:L(o.value.data_final),id_operador:o.value.id_operador};try{b.value=!0;const e=await _.post("",t,{headers:{Authorization:`Bearer ${d.token}`}});k.value=e.data,k.value.length===0?y.value="Nenhum dado encontrado. Por favor, verifique sua consulta.":y.value=""}catch(e){console.error("Erro ao buscar histórico:",e)}finally{b.value=!1}},j=()=>{C.value=!0,A.value={}},q=n(null),G=async()=>{const t={id_cliente:d.userIdCliente};try{const e=await _.get("",{params:t,headers:{Authorization:`Bearer ${d.token}`}});x.value=[u,...e.data.map(({id_dm:a})=>({label:`DM  ${a}`,value:a}))]}catch(e){console.error("Erro ao carregar lista de dms:",e)}},K=async()=>{const t={id_cliente:d.userIdCliente};try{const e=await _.post("",t,{headers:{Authorization:`Bearer ${d.token}`}});F.value=[u,...e.data.map(({id_planta:a})=>({label:`Planta  ${a}`,value:a}))]}catch(e){console.error("Erro ao buscar opções de plantas:",e)}},J=async()=>{const t={id_cliente:d.userIdCliente};try{const e=await _.post("",t,{headers:{Authorization:`Bearer ${d.token}`}});S.value=[u,...e.data.map(({id_setor:a})=>({label:`Setor  ${a}`,value:a}))]}catch(e){console.error("Erro ao buscar setores/diretorias:",e)}},W=async()=>{const t={id_cliente:d.userIdCliente};try{const e=await _.post("",t,{headers:{Authorization:`Bearer ${d.token}`}});T.value=e.data.map(({id_centro_custo:a})=>({label:`Centro de Custo  ${a}`,value:a}))}catch(e){console.error("Erro ao buscar centros de custo:",e)}},X=async()=>{const t={id_cliente:d.userIdCliente};try{const e=await _.post("",t,{headers:{Authorization:`Bearer ${d.token}`}});$.value=[u,...e.data.map(a=>({label:a.nome,value:a.id_operador}))]}catch(e){console.error("Erro ao carregar usuários:",e)}},Z=()=>{var t,e,a,p,f;(t=w.value)!=null&&t.overlayVisible&&w.value.hide(),(e=g.value)!=null&&e.overlayVisible&&g.value.hide(),(a=V.value)!=null&&a.overlayVisible&&V.value.hide(),(p=D.value)!=null&&p.overlayVisible&&D.value.hide(),(f=I.value)!=null&&f.overlayVisible&&I.value.hide()},z=()=>{Z()};return re(()=>{G(),K(),J(),X(),W()}),(t,e)=>{const a=i("Dropdown"),p=i("Button"),f=i("InputIcon"),ee=i("InputText"),oe=i("IconField"),v=i("Column"),ae=i("DataTable"),le=i("Card"),te=i("Dialog");return h(),N(de,null,[l("div",ue,[l("div",pe,[l("div",ve,[_e,C.value?(h(),N("div",me,[l("div",fe,[he,s(a,{class:"drop",modelValue:o.value.dm,"onUpdate:modelValue":e[0]||(e[0]=r=>o.value.dm=r),options:x.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown1",ref:w},null,8,["modelValue","options"])]),l("div",be,[ye,s(a,{class:"drop",modelValue:o.value.id_planta,"onUpdate:modelValue":e[1]||(e[1]=r=>o.value.id_planta=r),options:F.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown2",ref:g},null,8,["modelValue","options"])]),l("div",we,[ge,s(a,{class:"drop",modelValue:o.value.id_setor,"onUpdate:modelValue":e[2]||(e[2]=r=>o.value.id_setor=r),options:S.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown3",ref:V},null,8,["modelValue","options"])]),l("div",Ve,[De,s(a,{class:"drop",modelValue:o.value.id_centro_custo,"onUpdate:modelValue":e[3]||(e[3]=r=>o.value.id_centro_custo=r),options:T.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown4",ref:D},null,8,["modelValue","options"])]),l("div",Ie,[ke,s(a,{class:"drop",modelValue:o.value.id_operador,"onUpdate:modelValue":e[4]||(e[4]=r=>o.value.id_operador=r),options:$.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown5",ref:I},null,8,["modelValue","options"])]),l("div",Ce,[Me,s(P(E),{class:"drop",modelValue:o.value.data_inicio,"onUpdate:modelValue":e[5]||(e[5]=r=>o.value.data_inicio=r),showIcon:"",showOnFocus:!1,format:U,locale:"pt-BR","auto-apply":"","enable-time-picker":!1,onOpen:z,teleport:"body",placeholder:"Selecione uma data inicial"},null,8,["modelValue"])]),l("div",Be,[Oe,s(P(E),{class:"drop",modelValue:o.value.data_final,"onUpdate:modelValue":e[6]||(e[6]=r=>o.value.data_final=r),showIcon:"",showOnFocus:!1,format:U,locale:"pt-BR","auto-apply":"","enable-time-picker":!1,onOpen:z,teleport:"body",placeholder:"Selecione uma data final"},null,8,["modelValue"])]),l("div",$e,[s(p,{class:"filtrar",type:"button",label:"Filtrar Dados",icon:"pi pi-search",severity:"info",onClick:Y})])])):M("",!0),l("div",xe,[s(ae,{filters:m.value,"onUpdate:filters":e[8]||(e[8]=r=>m.value=r),value:k.value,stripedRows:"",showGridlines:"",paginator:"",rows:10,rowsPerPageOptions:[5,10,20,50],rowHover:"",globalFilterFields:["ID_DM","Data","operador","item","Quantidade","Mola"],tableStyle:{width:"100%"},ref_key:"dt",ref:q},{header:c(()=>[l("div",Fe,[s(oe,{iconPosition:"left"},{default:c(()=>[s(f,null,{default:c(()=>[Se]),_:1}),s(ee,{modelValue:m.value.global.value,"onUpdate:modelValue":e[7]||(e[7]=r=>m.value.global.value=r),placeholder:"Busca"},null,8,["modelValue"])]),_:1})])]),empty:c(()=>[Q(B(y.value),1)]),default:c(()=>[s(v,{field:"ID_DM",sortable:"",header:"DM"}),s(v,{field:"Data",sortable:"",header:"Data"}),s(v,{field:"operador",sortable:"",header:"Operador"}),s(v,{field:"item",sortable:"",header:"Item"}),s(v,{field:"Quantidade",sortable:"",header:"Quantidade",class:"text-center"}),s(v,{field:"Mola",sortable:"",header:"Mola"})]),_:1},8,["filters","value"])]),C.value?M("",!0):(h(),H(le,{key:1},{title:c(()=>[Q(B(A.value.dm),1)]),content:c(()=>[s(p,{type:"button",label:"Voltar",icon:"pi pi-arrow-left",severity:"info",onClick:j})]),_:1}))])])]),b.value?(h(),H(ce,{key:0})):M("",!0),s(te,{header:"Informação",visible:O.value,style:{width:"50vw"},modal:!0,closable:!0},{footer:c(()=>[s(p,{label:"OK",icon:"pi pi-check",onClick:e[9]||(e[9]=r=>O.value=!1)})]),default:c(()=>[l("p",null,B(R.value),1)]),_:1},8,["visible"])],64)}}};export{Ne as default};
