import{H as z}from"./vue-datepicker-7654ddb0.js";import{e as le,s as te,r,n as ne,g as p,o as b,c as N,d as t,h as n,x as T,a as I,w as m,y as E,F as se,l as _,i as L,t as re,z as ie}from"./index-8679b923.js";/* empty css             */import{L as de}from"./LoadingSpinner-a3a18303.js";const ce={class:"card vh"},ue={class:"form"},pe={class:"grid mt-3 mx-1 px-1"},me=t("h5",{class:"my-4 text-2xl"},"Retiradas Realizadas",-1),_e={key:0,class:"p-0 m-0 p-fluid formgrid grid col-12"},fe={class:"field lg:col-3 md:col-6 sm:col-6"},ve=t("label",{for:"dm"},"DM:",-1),he={class:"field lg:col-3 md:col-6 sm:col-6"},be=t("label",{for:"planta"},"Planta:",-1),ye={class:"field lg:col-3 md:col-6 sm:col-6"},Ve=t("label",{for:"perfil"},"Centro de Custo:",-1),we={class:"field lg:col-3 md:col-6 sm:col-6"},Ce=t("label",{for:"perfil"},"Setor:",-1),ge={class:"field lg:col-3 md:col-6 sm:col-6"},ke=t("label",{for:"perfil"},"Funcionário:",-1),De={class:"field lg:col-3 md:col-6 sm:col-6"},Ie=t("label",{for:"perfil"},"Data Inicial:",-1),xe={class:"field lg:col-3 md:col-6 sm:col-6"},Se=t("label",{for:"perfil"},"Data Final:",-1),Be={class:"field lg:col-3 md:col-6 sm:col-6"},Oe={class:"field lg:col-3 md:col-6 sm:col-6"},Re={class:"field lg:col-3 md:col-6 sm:col-6"},Fe={class:"datatable-wrapper"},Ue={class:"flex justify-content-end"},$e=t("i",{class:"pi pi-search"},null,-1),Le={__name:"retiradasrealizadas",setup(Ae){const d=le();te();const y=r(null),V=r(null),w=r(null),C=r(null),g=r(null),f=r([]),c={label:"Todos",value:null},x=r(null),S=r([c]),B=r([c]),O=r([c]),R=r([c]),v=r({global:{value:null,matchMode:ie.CONTAINS}}),k=r(!0),F=r([]),D=r(!1),l=r({dm:"",id_planta:"",id_centro_custo:"",id_setor:"",id_funcionario:"",data_inicio:"",data_final:""}),U=a=>{const e=a.getDate(),o=a.getMonth()+1,i=a.getFullYear();return`${e}/${o}/${i}`},$=a=>a?new Date(a).toISOString():null,M=async()=>{const a={id_cliente:d.userIdCliente,id_dm:l.value.dm===null?void 0:l.value.dm,id_planta:l.value.id_planta===null?void 0:l.value.id_planta,id_centro_custo:l.value.id_centro_custo===null?void 0:l.value.id_centro_custo,id_setor:l.value.id_setor===null?void 0:l.value.id_setor,id_funcionario:l.value.id_funcionario===null?void 0:l.value.id_funcionario,data_inicio:$(l.value.data_inicio),data_final:$(l.value.data_final)};try{D.value=!0;const e=await _.post("relatorioRetiRe/relatorio",a,{headers:{Authorization:`Bearer ${d.token}`}});f.value=e.data}catch(e){console.error("Erro ao buscar retiradas:",e)}finally{D.value=!1}},j=()=>{k.value=!0,F.value={}},P=r(null),H=a=>{const e=Object.keys(a[0]).join(","),o=a.map(i=>Object.values(i).join(",")).join(`
`);return`${e}
${o}`},J=()=>{const a=H(f.value),e=new Blob([a],{type:"text/csv;charset=utf-8;"}),o=document.createElement("a"),i=URL.createObjectURL(e);o.setAttribute("href",i),o.setAttribute("download","RetiradasRealizadas.csv"),document.body.appendChild(o),o.click(),document.body.removeChild(o)},Q=()=>{const a=JSON.stringify(f.value,null,2),e=new Blob([a],{type:"application/json;charset=utf-8;"}),o=document.createElement("a"),i=URL.createObjectURL(e);o.setAttribute("href",i),o.setAttribute("download","RetiradasRealizadas.json"),document.body.appendChild(o),o.click(),document.body.removeChild(o)},K=async()=>{const a={id_cliente:d.userIdCliente};try{const e=await _.get("/relatorioRetiRe/listardm",{params:a,headers:{Authorization:`Bearer ${d.token}`}});S.value=[c,...e.data.map(({id_dm:o})=>({label:`DM  ${o}`,value:o}))]}catch(e){console.error("Erro ao carregar lista de dms:",e)}},G=async()=>{const a={id_cliente:d.userIdCliente};try{const e=await _.post("funcionarios/listarplanta",a,{headers:{Authorization:`Bearer ${d.token}`}});B.value=[c,...e.data.map(({id_planta:o})=>({label:`Planta  ${o}`,value:o}))]}catch(e){console.error("Erro ao buscar opções de plantas:",e)}},Y=async()=>{const a={id_cliente:d.userIdCliente};try{const e=await _.post("funcionarios/listarsetor",a,{headers:{Authorization:`Bearer ${d.token}`}});O.value=[c,...e.data.map(({id_setor:o})=>({label:`Setor  ${o}`,value:o}))]}catch(e){console.error("Erro ao buscar setores/diretorias:",e)}},q=async()=>{const a={id_cliente:d.userIdCliente};try{const e=await _.post("funcionarios/listarcentrocusto",a,{headers:{Authorization:`Bearer ${d.token}`}});R.value=[c,...e.data.map(({id_centro_custo:o})=>({label:`Centro de Custo  ${o}`,value:o}))]}catch(e){console.error("Erro ao buscar centros de custo:",e)}},W=async()=>{const a={id_cliente:d.userIdCliente};try{const e=await _.post("/funcionarios/listar",a,{headers:{Authorization:`Bearer ${d.token}`}});x.value=e.data.map(o=>({label:o.nome,value:o.id_funcionario}))}catch(e){console.error("Erro ao carregar usuários:",e)}},X=()=>{var a,e,o,i,h;(a=y.value)!=null&&a.overlayVisible&&y.value.hide(),(e=V.value)!=null&&e.overlayVisible&&V.value.hide(),(o=w.value)!=null&&o.overlayVisible&&w.value.hide(),(i=C.value)!=null&&i.overlayVisible&&C.value.hide(),(h=g.value)!=null&&h.overlayVisible&&g.value.hide()},A=()=>{X()};return ne(()=>{K(),G(),Y(),W(),q()}),(a,e)=>{const o=p("Dropdown"),i=p("Button"),h=p("InputIcon"),Z=p("InputText"),ee=p("IconField"),u=p("Column"),oe=p("DataTable"),ae=p("Card");return b(),N(se,null,[t("div",ce,[t("div",ue,[t("div",pe,[me,k.value?(b(),N("div",_e,[t("div",fe,[ve,n(o,{class:"drop",modelValue:l.value.dm,"onUpdate:modelValue":e[0]||(e[0]=s=>l.value.dm=s),options:S.value,optionLabel:"label",optionValue:"value",ref_key:"dropdown1",ref:y,placeholder:"Todos"},null,8,["modelValue","options"])]),t("div",he,[be,n(o,{class:"drop",modelValue:l.value.id_planta,"onUpdate:modelValue":e[1]||(e[1]=s=>l.value.id_planta=s),options:B.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown2",ref:V},null,8,["modelValue","options"])]),t("div",ye,[Ve,n(o,{class:"drop",modelValue:l.value.id_centro_custo,"onUpdate:modelValue":e[2]||(e[2]=s=>l.value.id_centro_custo=s),options:R.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown3",ref:w},null,8,["modelValue","options"])]),t("div",we,[Ce,n(o,{class:"drop",modelValue:l.value.id_setor,"onUpdate:modelValue":e[3]||(e[3]=s=>l.value.id_setor=s),options:O.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown4",ref:C},null,8,["modelValue","options"])]),t("div",ge,[ke,n(o,{class:"drop",modelValue:l.value.id_funcionario,"onUpdate:modelValue":e[4]||(e[4]=s=>l.value.id_funcionario=s),options:x.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown5",ref:g},null,8,["modelValue","options"])]),t("div",De,[Ie,n(T(z),{class:"drop",modelValue:l.value.data_inicio,"onUpdate:modelValue":e[5]||(e[5]=s=>l.value.data_inicio=s),showIcon:"",showOnFocus:!1,format:U,locale:"pt-BR","auto-apply":"","enable-time-picker":!1,placeholder:"Selecione uma data inicial",ref:"datepicker1",onOpen:A},null,8,["modelValue"])]),t("div",xe,[Se,n(T(z),{class:"drop",modelValue:l.value.data_final,"onUpdate:modelValue":e[6]||(e[6]=s=>l.value.data_final=s),showIcon:"",showOnFocus:!1,format:U,locale:"pt-BR","auto-apply":"","enable-time-picker":!1,placeholder:"Selecione uma data final",ref:"datepicker2",onOpen:A},null,8,["modelValue"])]),t("div",Be,[n(i,{class:"filtrar",type:"button",label:"Filtrar Dados",icon:"pi pi-search",severity:"info",onClick:M})]),t("div",Oe,[n(i,{class:"exportar",icon:"pi pi-file",label:"Exportar CSV",onClick:J})]),t("div",Re,[n(i,{class:"exportar",icon:"pi pi-file",label:"Exportar JSON",onClick:Q})])])):I("",!0),t("div",Fe,[n(oe,{filters:v.value,"onUpdate:filters":e[8]||(e[8]=s=>v.value=s),value:f.value,stripedRows:"",showGridlines:"",paginator:"",rows:10,rowsPerPageOptions:[5,10,20,50],rowHover:"",globalFilterFields:["ID_DM","Dia","matricula","nome","email","ProdutoNome","Quantidade","ProdutoSKU"],tableStyle:{width:"100%"},ref_key:"dt",ref:P,class:""},{header:m(()=>[t("div",Ue,[n(ee,{iconPosition:"left"},{default:m(()=>[n(h,null,{default:m(()=>[$e]),_:1}),n(Z,{modelValue:v.value.global.value,"onUpdate:modelValue":e[7]||(e[7]=s=>v.value.global.value=s),placeholder:"Busca"},null,8,["modelValue"])]),_:1})])]),empty:m(()=>[L(" Nenhuma retirada realizada ")]),default:m(()=>[n(u,{field:"ID_DM",sortable:"",header:"DM"}),n(u,{field:"Dia",sortable:"",header:"Data"}),n(u,{field:"matricula",sortable:"",header:"Matricula"}),n(u,{field:"nome",sortable:"",header:"Nome"}),n(u,{field:"email",sortable:"",header:"E-mail"}),n(u,{field:"ProdutoNome",sortable:"",header:"Item"}),n(u,{field:"Quantidade",sortable:"",header:"Quant",class:"text-center"}),n(u,{field:"ProdutoSKU",sortable:"",header:"CA"})]),_:1},8,["filters","value"])]),k.value?I("",!0):(b(),E(ae,{key:1},{title:m(()=>[L(re(F.value.dm),1)]),content:m(()=>[n(i,{type:"button",label:"Voltar",icon:"pi pi-check",severity:"info",onClick:j})]),_:1}))])])]),D.value?(b(),E(de,{key:0})):I("",!0)],64)}}};export{Le as default};
