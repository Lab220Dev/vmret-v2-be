import{r as f,e as K,m as H,q as J,C as Y,s as G,g as s,o as C,c as Q,h as l,w as i,z as I,a as T,l as V,d as a,S as W,i as x,t as A,k as X,y as r,A as Z}from"./index-ac32e295.js";import{L as ee}from"./LoadingSpinner-d16fdc18.js";const te={class:"card"},ae={class:"col-12"},le={class:"flex justify-content-end"},oe=a("i",{class:"pi pi-search"},null,-1),ne={class:"grid"},ie={class:"col-12"},se={class:"card"},re={class:"p-fluid formgrid grid m-0 p-0"},ce={class:"full lg:col-12 md:col-12 sm:col-12"},de=a("label",{for:"id_planta"},"Nome:",-1),ue={class:"full lg:col-12 md:col-12 sm:col-12"},me=a("label",{for:"cpfcnpj"},"CNPJ/CPF:",-1),pe={class:"full lg:col-6 md:col-6 sm:col-6"},fe=a("label",{for:"codigo"},"Menção Ficha Retirada:",-1),ve=a("label",{class:"mt-3 ml-4",for:"switch1"},"Tem integração?",-1),_e=a("label",{class:"mt-3 ml-4",for:"switch2"},"Cliente Ativo?",-1),ye={class:"mr-1 mt-4 grid justify-content-end"},he={class:"confirmation-content"},ge=a("i",{class:"pi pi-exclamation-triangle mr-1",style:{"font-size":"2rem"}},null,-1),be={class:""},Se={__name:"Clientes",setup(we){const u=f(0),h=K(),z=H(),c=f(!1),$=f([]),_=f(!1),g=f(!1),b=f({}),w=f({global:{value:null,matchMode:Z.CONTAINS}});let n=J({nome:"",cpfcnpj:"",ativo:!0,usarApi:!1,textoretirada:""});const M=o=>{n=o.data,u.value=1,_.value=!0,v()},U=()=>{_.value?N():j()},j=async()=>{const o={...n};c.value=!0;try{const e=await V.post("/admin/cliente/adicionar",o,{headers:{Authorization:`Bearer ${h.token}`}});v(),u.value=0,S()}catch(e){console.error("Erro ao adicionar Clientes:",e)}finally{c.value=!1}},E=o=>{b.value=o,g.value=!0},P=async o=>{c.value=!0;let e={id_cliente:o.id_cliente};try{await V.post("/admin/cliente/delete",e,{headers:{Authorization:`Bearer ${h.token}`}}),z.add({severity:"success",summary:"Successful",detail:"Ciente Deletada",life:3e3}),g.value=!1,v()}catch{z.add({severity:"error",summary:"Error",detail:"Erro ao deletar a planta.",life:3e3})}finally{c.value=!1}},N=async()=>{c.value=!0;const o={id_cliente:n.id_cliente,...n};try{const e=await V.post("/admin/cliente/atualizar",o,{headers:{Authorization:`Bearer ${h.token}`}});v(),u.value=0,S()}catch(e){console.error("Erro ao atualizar Plantas:",e)}finally{c.value=!1}};Y(u,(o,e)=>{o!==e&&o===0&&(S(),v(),_.value=!1)});const S=()=>{n.nome="",n.cpfcnpj="",n.ativo=!0,n.created=new Date,n.usarApi=!1,n.textoretirada=""},v=async()=>{c.value=!0;try{const o=await V.post("/admin/cliente/listar",{headers:{Authorization:`Bearer ${h.token}`}});$.value=o.data}catch(o){console.error("Erro ao listar plantas:",o)}finally{c.value=!1}},L=o=>{if(!o)return"";try{const e=new Date(o);if(isNaN(e))throw new Error("Data inválida");const m=new Date(e.getTime()+e.getTimezoneOffset()*6e4),y=String(m.getDate()).padStart(2,"0"),k=String(m.getMonth()+1).padStart(2,"0"),p=m.getFullYear(),d=String(m.getHours()).padStart(2,"0"),D=String(m.getMinutes()).padStart(2,"0");return`${y}/${k}/${p} ${d}:${D}`}catch(e){return console.error("Erro ao formatar data:",e),"Data inválida"}};return G(()=>{v()}),(o,e)=>{const m=s("InputIcon"),y=s("InputText"),k=s("IconField"),p=s("Column"),d=s("Button"),D=s("DataTable"),B=s("TabPanel"),q=s("Textarea"),F=s("InputSwitch"),R=s("TabView"),O=s("Dialog");return C(),Q("div",te,[l(R,{activeIndex:u.value,"onUpdate:activeIndex":e[8]||(e[8]=t=>u.value=t)},{default:i(()=>[l(B,{header:"Listar Clientes"},{default:i(()=>[a("div",ae,[l(D,{filters:w.value,"onUpdate:filters":e[1]||(e[1]=t=>w.value=t),value:$.value,selectionMode:"single",tableStyle:"min-width: 25%",rowsPerPageOptions:[5,10,20,50],stripedRows:"",dataKey:"id",metaKeySelection:!1,onRowSelect:M,globalFilterFields:["id_cliente","nome","last_login"]},{header:i(()=>[a("div",le,[l(k,{iconPosition:"left"},{default:i(()=>[l(m,null,{default:i(()=>[oe]),_:1}),l(y,{modelValue:w.value.global.value,"onUpdate:modelValue":e[0]||(e[0]=t=>w.value.global.value=t),placeholder:"Busca"},null,8,["modelValue"])]),_:1})])]),default:i(()=>[l(p,{field:"id_cliente",header:"Id"}),l(p,{field:"nome",header:"Nome"}),l(p,{field:"ativo",header:"Ativo"},{body:i(({data:t})=>[a("i",{class:W(["pi",{"pi-check-circle text-green-500 ":t.ativo,"pi-times-circle text-red-500":!t.ativo}])},null,2)]),_:1}),l(p,{field:"last_login",header:"Último Login"},{body:i(({data:t})=>[x(A(L(new Date(t.last_login))),1)]),_:1}),l(p,{style:{"min-width":"8rem"}},{body:i(t=>[l(d,{icon:"pi pi-trash",outlined:"",rounded:"",severity:"danger",onClick:Ce=>E(t.data)},null,8,["onClick"])]),_:1})]),_:1},8,["filters","value"])])]),_:1}),l(B,{header:"Adicionar Clientes"},{default:i(()=>[a("div",ne,[a("div",ie,[a("div",se,[a("form",{onSubmit:X(U,["prevent"])},[a("div",re,[a("div",ce,[de,l(y,{class:"my-2",id:"id_planta",modelValue:r(n).nome,"onUpdate:modelValue":e[2]||(e[2]=t=>r(n).nome=t),required:""},null,8,["modelValue"])]),a("div",ue,[me,l(y,{class:"my-2",id:"cpfcnpj",modelValue:r(n).cpfcnpj,"onUpdate:modelValue":e[3]||(e[3]=t=>r(n).cpfcnpj=t),required:""},null,8,["modelValue"])]),a("div",pe,[fe,l(q,{modelValue:r(n).textoretirada,"onUpdate:modelValue":e[4]||(e[4]=t=>r(n).textoretirada=t),class:"my-2 overflow-scroll",rows:"5",cols:"30"},null,8,["modelValue"])]),l(F,{class:"grid mt-3 ml-3",modelValue:r(n).usarApi,"onUpdate:modelValue":e[5]||(e[5]=t=>r(n).usarApi=t),inputId:"switch1"},null,8,["modelValue"]),ve,l(F,{class:"grid mt-3 ml-3",modelValue:r(n).ativo,"onUpdate:modelValue":e[6]||(e[6]=t=>r(n).ativo=t),inputId:"switch2"},null,8,["modelValue"]),_e]),a("div",ye,[_.value?(C(),I(d,{key:0,style:{width:"15%"},class:"flex align-items-center justify-content-center m-2 mr-0",label:"Atualizar",icon:"pi pi-refresh",severity:"primary",onClick:N})):T("",!0),l(d,{style:{width:"15%"},class:"flex align-items-center justify-content-center m-2 mr-0",label:"Voltar",icon:"pi pi-arrow-left",severity:"primary",onClick:e[7]||(e[7]=t=>u.value=0)}),_.value?T("",!0):(C(),I(d,{key:1,style:{width:"15%"},class:"flex align-items-center justify-content-center m-2 mr-0",label:"Salvar",icon:"pi pi-check",severity:"info",onClick:j}))])],32)])])])]),_:1})]),_:1},8,["activeIndex"]),l(O,{header:"Deletar Cliente",visible:g.value,"onUpdate:visible":e[11]||(e[11]=t=>g.value=t),style:{width:"400px"},modal:!0,closable:!1},{footer:i(()=>[l(d,{label:"Não",icon:"pi pi-times",onClick:e[9]||(e[9]=t=>o.deleteFuncionarioDialog=!1),class:"p-button-text"}),l(d,{label:"Sim",icon:"pi pi-check",onClick:e[10]||(e[10]=t=>P(b.value)),class:"p-button-text"})]),default:i(()=>[a("div",he,[ge,a("span",be,[x(" Você tem certeza que deseja deletar o Cliente "),a("b",null,A(b.value.id_cliente),1),x(" - "),a("b",null,A(b.value.nome),1),x(" ?")])])]),_:1},8,["visible"]),c.value?(C(),I(ee,{key:0})):T("",!0)])}}};export{Se as default};
