import{r as m,e as O,m as R,q,C as K,s as G,g as r,o as h,c as H,d as a,h as l,w as u,z as w,a as V,l as U,S as Y,i as S,t as k}from"./index-47c49ab3.js";import{L as J}from"./LoadingSpinner-5d33e654.js";const Q={class:"grid"},X={class:"col-12"},Z={class:"card"},ee=a("h5",{class:"mt-2"},"Usuário Web",-1),te={class:"col-12"},oe={class:"mt-2"},ae={class:"mt-5 mx-0 p-fluid grid"},le={class:"full lg:col-12 md:col-12 sm:col-12"},se=a("label",{for:"name"},"Nome:",-1),ne={class:"full lg:col-7 md:col-7 sm:col-12"},ie=a("label",{for:"email"},"E-mail:",-1),re={class:"full lg:col-5 md:col-5 sm:col-12"},ue=a("label",{for:"senha"},"Senha:",-1),de={class:"full lg:col-5 md:col-5 sm:col-12"},ce=a("label",{for:"senha"},"Confirme a Senha:",-1),me={class:"full lg:col-4 md:col-4 sm:col-12"},pe=a("label",{for:"perfil"},"Perfil:",-1),ve={class:"full lg:col-4 md:col-4 sm:col-12"},fe=a("label",{for:"planta"},"Planta:",-1),he={class:"full lg:col-4 md:col-4 sm:col-12"},_e=a("label",{class:"mt-3 ml-4",for:"switch2"},"Usuario Ativo?",-1),ye={class:"flex align-items-center justify-content-end field col-12"},be={class:"confirmation-content"},ge=a("i",{class:"pi pi-exclamation-triangle mr-1",style:{"font-size":"2rem"}},null,-1),we={class:""},De={__name:"web",setup(Ve){const p=m(0),c=O(),d=m(!1),C=R(),z={label:"Todos",value:null},v=m(!1),$=m(""),E=m([z]),s=q({nome:"",email:"",perfil:"",planta:"",senha:"",Status:""}),T=m([]),x=m([{name:"Gestor",value:"gestor"},{name:"Master",value:"master"},{name:"Operador",value:"operador"},{name:"Liberação Avulsa",value:"avulsa"}]),B=t=>{show.value=!0,s.value=t.data},I=()=>{p.value=0,y()},A=()=>{v.value?P():N()},N=async()=>{const t={...s};try{const e=await U.post("/usuario/adicionar",t,{headers:{Authorization:`Bearer ${c.token}`}});C.add({severity:"success",summary:"Successful",detail:"Usuario WEB criado",life:3e3}),_(),p.value=0,y()}catch(e){console.error("Erro ao adicionar Usuario:",e)}finally{d.value=!1}d.value=!0},P=async()=>{d.value=!0;const t={...s};try{const e=await U.post("/usuario/atualizar",t,{headers:{Authorization:`Bearer ${c.token}`}});C.add({severity:"success",summary:"Successful",detail:"Usuario WEB atualizado",life:3e3}),_(),p.value=0,y()}catch(e){console.error("Erro ao atualizar o Usuario:",e)}finally{d.value=!1}d.value=!0},L=async()=>{const t={id_cliente:c.userIdCliente};try{const e=await U.post("/usuarios/listarPlanta",t,{headers:{Authorization:`Bearer ${c.token}`}});E.value=[z,...e.data.map(({id_planta:n})=>({label:`Planta  ${n}`,value:n}))]}catch(e){console.error("Erro ao buscar opções de plantas:",e)}},_=async()=>{d.value=!0;let t=null;c.userRole==="Administrador"?t="":(t={},t.id_cliente=c.userIdCliente);try{const e=await U.post("/usuarios/listar",t,{headers:{Authorization:`Bearer ${c.token}`}});T.value=e.data}catch(e){console.error("Erro ao carregar usuários:",e)}finally{d.value=!1}},j=t=>{if(!t)return"";try{const e=new Date(t);if(isNaN(e))throw new Error("Data inválida");const n=new Date(e.getTime()+e.getTimezoneOffset()*6e4),i=String(n.getDate()).padStart(2,"0"),D=String(n.getMonth()+1).padStart(2,"0"),b=n.getFullYear(),f=String(n.getHours()).padStart(2,"0"),g=String(n.getMinutes()).padStart(2,"0");return`${i}/${D}/${b} ${f}:${g}`}catch(e){return console.error("Erro ao formatar data:",e),"Data inválida"}};K(p,(t,e)=>{t!==e&&t===0&&(y(),_(),v.value=!1)}),G(()=>{L(),_()});const y=()=>{s.nome="",s.Status=!0,s.email="",s.perfil="",s.planta="",s.senha=""};return(t,e)=>{const n=r("Column"),i=r("Button"),D=r("DataTable"),b=r("TabPanel"),f=r("InputText"),g=r("Dropdown"),F=r("InputSwitch"),W=r("TabView"),M=r("Dialog");return h(),H("div",Q,[a("div",X,[a("div",Z,[ee,l(W,{activeIndex:p.value,"onUpdate:activeIndex":e[9]||(e[9]=o=>p.value=o)},{default:u(()=>[l(b,{header:"Listar  Usuário Web"},{default:u(()=>[a("div",te,[l(D,{value:T.value,selectionMode:"single",tableStyle:"min-width: 25%",rowsPerPageOptions:[5,10,20,50],stripedRows:"",dataKey:"id",metaKeySelection:!1,onRowSelect:B,paginator:"",rows:10},{default:u(()=>[l(n,{field:"id_usuario",header:"Id"}),l(n,{field:"nome",header:"Nome"}),l(n,{field:"email",header:"E-mail"}),l(n,{field:"role",header:"role"}),l(n,{field:"ativo",header:"Ativo"},{body:u(({data:o})=>[a("i",{class:Y(["pi",{"pi-check-circle text-green-500 ":o.ativo,"pi-times-circle text-red-500":!o.ativo}])},null,2)]),_:1}),l(n,{field:"last_login",header:"Último Login"},{body:u(({data:o})=>[S(k(j(new Date(o.last_login))),1)]),_:1}),l(n,{style:{"min-width":"8rem"}},{body:u(o=>[l(i,{icon:"pi pi-trash",outlined:"",rounded:"",severity:"danger",onClick:Ue=>t.deleteUsuario(o.data)},null,8,["onClick"])]),_:1})]),_:1},8,["value"])])]),_:1}),l(b,{header:"Adicionar Usuário Web"},{default:u(()=>[a("h5",oe,k(v.value?"Editar ":"Novo ")+"Usuário Web",1),a("div",ae,[a("div",le,[se,l(f,{class:"my-2",modelValue:s.nome,"onUpdate:modelValue":e[0]||(e[0]=o=>s.nome=o),id:"name",type:"text"},null,8,["modelValue"])]),a("div",ne,[ie,l(f,{class:"my-2",modelValue:s.email,"onUpdate:modelValue":e[1]||(e[1]=o=>s.email=o),id:"email"},null,8,["modelValue"])]),a("div",re,[ue,l(f,{class:"my-2",id:"senha",modelValue:s.senha,"onUpdate:modelValue":e[2]||(e[2]=o=>s.senha=o),type:"password"},null,8,["modelValue"])]),a("div",de,[ce,l(f,{class:"my-2",id:"senha",modelValue:$.value,"onUpdate:modelValue":e[3]||(e[3]=o=>$.value=o),type:"password"},null,8,["modelValue"])]),a("div",me,[pe,l(g,{class:"my-2",id:"perfil",modelValue:s.perfil,"onUpdate:modelValue":e[4]||(e[4]=o=>s.perfil=o),options:x.value,optionLabel:"label",optionValue:"value",placeholder:"Escolha um"},null,8,["modelValue","options"])]),a("div",ve,[fe,l(g,{class:"my-2",id:"planta",modelValue:s.planta,"onUpdate:modelValue":e[5]||(e[5]=o=>s.planta=o),options:E.value,optionLabel:"label",optionValue:"value",placeholder:"Todos"},null,8,["modelValue","options"])]),a("div",he,[_e,l(F,{class:"grid mt-3 ml-3",modelValue:s.status,"onUpdate:modelValue":e[6]||(e[6]=o=>s.status=o),inputId:"switch2"},null,8,["modelValue"])]),a("div",ye,[v.value?(h(),w(i,{key:0,style:{width:"15%"},class:"buttons flex align-items-center justify-content-center m-2",label:"Atualizar",icon:"pi pi-refresh",severity:"primary",onClick:t.atualizarFuncionario},null,8,["onClick"])):V("",!0),v.value?(h(),w(i,{key:1,style:{width:"15%"},class:"buttons flex align-items-center justify-content-center m-2",label:"Excluir",icon:"pi pi-trash",severity:"danger",onClick:e[7]||(e[7]=o=>t.deleteFuncionarioDialog=!0)})):V("",!0),l(i,{style:{width:"15%"},class:"flex align-items-center justify-content-center m-2 mr-0",label:"Voltar",icon:"pi pi-trash",severity:"primary",onClick:e[8]||(e[8]=o=>I())}),v.value?V("",!0):(h(),w(i,{key:2,style:{width:"15%"},class:"buttons flex align-items-center justify-content-center m-2",label:"Salvar",icon:"pi pi-check",severity:"info",onClick:A}))])])]),_:1})]),_:1},8,["activeIndex"]),l(M,{header:"Deletar Usuario",visible:t.deleteUsuarioDialog,"onUpdate:visible":e[12]||(e[12]=o=>t.deleteUsuarioDialog=o),style:{width:"400px"},modal:!0,closable:!1},{footer:u(()=>[l(i,{label:"Não",icon:"pi pi-times",onClick:e[10]||(e[10]=o=>t.deleteFuncionarioDialog=!1),class:"p-button-text"}),l(i,{label:"Sim",icon:"pi pi-check",onClick:e[11]||(e[11]=o=>t.deleteUsuario(t.item)),class:"p-button-text"})]),default:u(()=>[a("div",be,[ge,a("span",we,[S(" Você tem certeza que deseja deletar o Usuario "),a("b",null,k(t.item.id_cliente),1),S(" - "),a("b",null,k(t.item.nome),1),S(" ?")])])]),_:1},8,["visible"]),d.value?(h(),w(J,{key:0})):V("",!0)])])])}}};export{De as default};
