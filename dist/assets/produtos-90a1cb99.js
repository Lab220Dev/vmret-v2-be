import{_ as le,e as te,m as se,r as d,q as ie,C as ne,s as de,g as m,o as $,c as re,h as s,w as g,z as k,a as C,l as w,d as a,y as i,i as _,t as G,p as ce,b as ue}from"./index-539dbcb2.js";/* empty css             */import{i as v,_ as j}from"./ImageUpload-94f54ed5.js";import{L as me}from"./LoadingSpinner-7f802481.js";const r=S=>(ce("data-v-25ab2a38"),S=S(),ue(),S),pe={class:"card vh"},_e={class:"col-12"},ve=["src"],fe={class:"grid"},ge={class:"col-12"},ye={class:"card"},he={class:"p-fluid formgrid grid m-0 p-0"},be={class:"full lg:col-6 md:col-6 sm:col-6"},we=r(()=>a("label",{for:"codigo"},"SKU:",-1)),xe={class:"full lg:col-6 md:col-6 sm:col-6"},Ie=r(()=>a("label",{for:"nome"},"Nome:",-1)),Ve={class:"full lg:col-6 md:col-6 sm:col-6"},Pe=r(()=>a("label",{for:"nome"},"Descrição:",-1)),$e={class:"full lg:col-6 md:col-6 sm:col-6"},Se=r(()=>a("label",{for:"codigo"},"Especificação:",-1)),De={class:"full lg:col-6 md:col-6 sm:col-6"},ke=r(()=>a("label",{for:"tipo"},"Tipo:",-1)),Ce={class:"full lg:col-6 md:col-6 sm:col-6"},Ue=r(()=>a("label",{for:"tipo"},"Planta:",-1)),Ee={class:"full med lg:col-6 md:col-6 sm:col-6"},Te=r(()=>a("label",{for:"UndMedida"},"Unidade de Medida:",-1)),ze={class:"full lg:col-6 md:col-6 sm:col-6"},Ae=r(()=>a("label",{for:"vldDias"},"Validade:",-1)),Be={class:"card p-0 col-12",style:{width:"100%"}},Fe={class:"p-fluid grid flex-wrap col-12 my-4 p-0 mx-0"},Ne={class:"full lg:col-4 md:col-4 col-12 my-4 mx-0 p-0 text-center"},je=r(()=>a("h4",{class:"titulo"},[_("Imagem"),a("br"),_("Principal:")],-1)),Le={class:"full lg:col-4 md:col-4 col-12 my-4 mx-0 p-0 text-center"},qe=r(()=>a("h4",{class:"titulo"},[_("Imagem"),a("br"),_("Secundária:")],-1)),Me={class:"full lg:col-4 md:col-4 col-12 my-4 mx-0 p-0 text-center"},Ke=r(()=>a("h4",{class:"titulo"},[_("Informações"),a("br"),_("Adicionais:")],-1)),Oe={class:"mt-7 grid justify-content-end flex-wrap"},Re={class:"confirmation-content"},Ge=r(()=>a("i",{class:"pi pi-exclamation-triangle mr-1",style:{"font-size":"2rem"}},null,-1)),He={class:""},Je={__name:"produtos",setup(S){const u=te(),y=se(),c=d(0),p=d(!1);let L=d([]),q=d([]);const H=d([{label:"EPI",value:1},{label:"Insumo",value:2},{label:"Consumivel",value:3}]),f=d(null),h=d(null),x=d(null),U=d(v),E=d(v),T=d(v),z=d([]),I=d(!1),V=d(!1),A=(o,e)=>{e==="principal"?f.value=o:e==="secundaria"?h.value=o:e==="info"&&(x.value=o)};let l=ie({codigo:"",id_planta:"",id_tipoProduto:"",id_categoria:71,nome:"",descricao:" ",unidade_medida:"",validadedias:""});const B=async(o,e)=>{o?e.value=await M(o):e.value=null},J=async o=>{l=o.data,await B(l.imagem1,U),await B(l.imagem2,E),await B(l.imagemdetalhe,T),V.value=!0,c.value=1,b()},b=async()=>{const o={id_cliente:u.userIdCliente};try{p.value=!0;const e=await w.post("/produtos/listar",o,{headers:{Authorization:`Bearer ${u.token}`}});z.value=e.data,z.value.forEach(async n=>{n.imagemUrl=await M(n.imagem1)})}catch(e){console.error("Erro ao carregar produtos:",e)}finally{p.value=!1}},Q=async()=>{const o={id_cliente:u.userIdCliente};try{L=(await w.post("produtos/listarplanta",o,{headers:{Authorization:`Bearer ${u.token}`}})).data,q=L.map(n=>({label:`Planta ${n.id_planta}`,value:n.id_planta}))}catch(e){console.error("Erro ao buscar opções de plantas:",e)}},W=async()=>{const o=new FormData;if(f.value){const e=`produto_${l.nome}_${l.codigo}_Princ${Date.now()}.png`;o.append("imagem1",e),o.append("file_principal",f.value)}if(x.value){const e=`produto_${l.nome}_${l.codigo}_info${Date.now()}.png`;o.append("imagemdetalhe",e),o.append("file_info",f.value)}if(h.value){const e=`produto_${l.nome}_${l.codigo}_Sec${Date.now()}.png`;o.append("imagem2",e),o.append("file_secundario",h.value)}Object.entries(l).forEach(([e,n])=>{o.append(e,n)}),o.append("id_cliente",u.userIdCliente);try{p.value=!0,await w.post("/produtos/adicionar",o,{headers:{Authorization:`Bearer ${u.token}`,"Content-Type":"multipart/form-data"}}),y.add({severity:"success",summary:"Successful",detail:"Produto cadastrado",life:3e3}),b(),c.value=0,D()}catch(e){console.error("Erro ao adicionar o produto:",e),y.add({severity:"error",summary:"Error",detail:"erro ao criar o produto",life:3e3})}finally{p.value=!1}c.value=0},X=async()=>{let o={id_produto:l.id_produto};try{p.value=!0,await w.post("/produtos/deleteProduto",o,{headers:{Authorization:`Bearer ${u.token}`}}),y.add({severity:"success",summary:"Successful",detail:"Produto Deletado",life:3e3}),I.value=!1,b(),c.value=0,D()}catch{y.add({severity:"error",summary:"Error",detail:"Erro ao deletar o produto",life:3e3})}finally{p.value=!1}c.value=0},Y=async()=>{const o=new FormData;Object.entries(l).forEach(([e,n])=>{o.append(e,n)}),f.value&&(o.append("imagem1",`produto_${l.nome}_${l.codigo}_Princ${Date.now()}.png`),o.append("file_principal",f.value)),x.value&&(o.append("imagemdetalhe",`produto_${l.nome}_${l.codigo}_info${Date.now()}.png`),o.append("file_info",x.value)),h.value&&(o.append("imagem2",`produto_${l.nome}_${l.codigo}_Sec${Date.now()}.png`),o.append("file_secundario",h.value));try{p.value=!0,await w.post("/produtos/atualizar",o,{headers:{Authorization:`Bearer ${u.token}`,"Content-Type":"multipart/form-data"}}),y.add({severity:"success",summary:"Successful",detail:"Produto atualizado",life:3e3}),b(),c.value=0,D()}catch(e){console.error("Erro ao atualizar o produto:",e),y.add({severity:"error",summary:"Error",detail:"Erro ao atualizar o produto",life:3e3})}finally{p.value=!1}},M=async o=>{if(o==="")return v;try{const e=await w.get(`/image/produto/${u.userIdCliente}/${o}`,{headers:{Authorization:`Bearer ${u.token}`}});if(e.status===200){const{image:n,mimeType:F}=e.data;return`data:${F};base64,${n}`}}catch{return v}};ne(c,(o,e)=>{o!==e&&o===0&&(D(),b(),V.value=!1)});const D=()=>{l={codigo:"",id_planta:"",id_tipoProduto:"",id_categoria:71,nome:"",descricao:" ",unidade_medida:"",validadedias:"",imagem1:"",imagem2:"",imagem3:"",imagem4:"",imagemdetalhe:""},f.value=null,h.value=null,x.value=null,U.value=v,E.value=v,T.value=v},Z=async o=>{await J(o)};return de(async()=>{await b(),await Q()}),(o,e)=>{const n=m("Column"),F=m("DataTable"),K=m("TabPanel"),N=m("InputText"),O=m("Textarea"),R=m("Dropdown"),ee=m("InputNumber"),P=m("Button"),oe=m("Dialog"),ae=m("TabView");return $(),re("div",pe,[s(ae,{activeIndex:c.value,"onUpdate:activeIndex":e[15]||(e[15]=t=>c.value=t)},{default:g(()=>[s(K,{header:"Listar Produtos"},{default:g(()=>[a("div",_e,[s(F,{value:z.value,selectionMode:"single",stripedRows:"",dataKey:"id",metaKeySelection:!1,onRowSelect:Z},{default:g(()=>[s(n,{header:"Imagem",class:"col-3"},{body:g(t=>[a("div",null,[a("img",{src:t.data.imagemUrl,alt:"Imagem do Produto",class:"w-6rem border-round"},null,8,ve)])]),_:1}),s(n,{field:"codigo",header:"SKU",class:"col-2"}),s(n,{field:"nome",header:"Nome",class:"col-7"})]),_:1},8,["value"])])]),_:1}),s(K,{header:"Adicionar Produto",activeIndex:c.value,"onUpdate:activeIndex":e[14]||(e[14]=t=>c.value=t)},{default:g(()=>[a("div",fe,[a("div",ge,[a("div",ye,[a("div",he,[a("div",be,[we,s(N,{class:"my-2",modelValue:i(l).codigo,"onUpdate:modelValue":e[0]||(e[0]=t=>i(l).codigo=t),id:"codigo",type:"text"},null,8,["modelValue"])]),a("div",xe,[Ie,s(N,{class:"my-2",modelValue:i(l).nome,"onUpdate:modelValue":e[1]||(e[1]=t=>i(l).nome=t),id:"nome",type:"text"},null,8,["modelValue"])]),a("div",Ve,[Pe,s(O,{modelValue:i(l).descricao,"onUpdate:modelValue":e[2]||(e[2]=t=>i(l).descricao=t),class:"my-2 overflow-scroll",rows:"5",cols:"30"},null,8,["modelValue"])]),a("div",$e,[Se,s(O,{modelValue:i(l).especificacoes,"onUpdate:modelValue":e[3]||(e[3]=t=>i(l).especificacoes=t),class:"my-2 overflow-scroll",rows:"5",cols:"30"},null,8,["modelValue"])]),a("div",De,[ke,s(R,{class:"my-2",modelValue:i(l).id_tipoProduto,"onUpdate:modelValue":e[4]||(e[4]=t=>i(l).id_tipoProduto=t),options:H.value,optionLabel:"label",optionValue:"value",placeholder:"Selecione um tipo"},null,8,["modelValue","options"])]),a("div",Ce,[Ue,s(R,{class:"my-2",modelValue:i(l).id_planta,"onUpdate:modelValue":e[5]||(e[5]=t=>i(l).id_planta=t),options:i(q),optionLabel:"label",optionValue:"value",placeholder:"Selecione uma planta"},null,8,["modelValue","options"])]),a("div",Ee,[Te,s(N,{class:"my-2",modelValue:i(l).unidade_medida,"onUpdate:modelValue":e[6]||(e[6]=t=>i(l).unidade_medida=t),id:"UndMedida",type:"text"},null,8,["modelValue"])]),a("div",ze,[Ae,s(ee,{class:"my-2",modelValue:i(l).validadedias,"onUpdate:modelValue":e[7]||(e[7]=t=>i(l).validadedias=t),inputId:"vldDias",suffix:" dias"},null,8,["modelValue"])])])]),a("div",Be,[a("div",Fe,[a("div",Ne,[je,s(j,{onFileSelected:e[8]||(e[8]=t=>A(t,"principal")),externalImages:U.value},null,8,["externalImages"])]),a("div",Le,[qe,s(j,{onFileSelected:e[9]||(e[9]=t=>A(t,"secundaria")),externalImages:E.value},null,8,["externalImages"])]),a("div",Me,[Ke,s(j,{onFileSelected:e[10]||(e[10]=t=>A(t,"info")),externalImages:T.value},null,8,["externalImages"])])])])])]),a("div",Oe,[V.value?($(),k(P,{key:0,style:{width:"15%"},class:"flex align-items-center justify-content-center m-2",label:"Atualizar",icon:"pi pi-refresh",severity:"primary",onClick:Y})):C("",!0),V.value?($(),k(P,{key:1,style:{width:"15%"},class:"flex align-items-center justify-content-center m-2",label:"Excluir",icon:"pi pi-trash",severity:"danger",onClick:e[11]||(e[11]=t=>I.value=!0)})):C("",!0),V.value?C("",!0):($(),k(P,{key:2,style:{width:"15%"},class:"mr-6 flex align-items-center justify-content-center m-2",label:"Salvar",icon:"pi pi-check",severity:"info",onClick:W}))]),s(oe,{header:"Deletar Produto",visible:I.value,"onUpdate:visible":e[13]||(e[13]=t=>I.value=t),style:{width:"400px"},modal:!0,closable:!1},{footer:g(()=>[s(P,{label:"Não",icon:"pi pi-times",onClick:e[12]||(e[12]=t=>I.value=!1),class:"p-button-text"}),s(P,{label:"Sim",icon:"pi pi-check",onClick:X,class:"p-button-text"})]),default:g(()=>[a("div",Re,[Ge,a("span",He,[_(" Você tem certeza que deseja deletar o produto "),a("b",null,G(i(l).id_produto),1),_(" - "),a("b",null,G(i(l).nome),1),_(" ?")])])]),_:1},8,["visible"])]),_:1},8,["activeIndex"])]),_:1},8,["activeIndex"]),p.value?($(),k(me,{key:0})):C("",!0)])}}},Ze=le(Je,[["__scopeId","data-v-25ab2a38"]]);export{Ze as default};
