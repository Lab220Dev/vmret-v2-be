import{H as E}from"./vue-datepicker-23f52441.js";import{r as s,e as ie,m as de,s as ce,g as c,o as b,c as L,d as n,h as t,y as j,a as x,w as u,z as P,F as ue,l as f,i as H,t as A,A as pe}from"./index-9a3304b5.js";/* empty css             */import{L as me}from"./LoadingSpinner-46f73b0a.js";import"./format-7e97a1d1.js";const ve={class:"card vh"},fe={class:"form"},_e={class:"grid mt-3 mx-1 px-1"},he=n("h5",{class:"my-4 text-2xl"},"Retiradas Realizadas",-1),be={key:0,class:"p-0 m-0 p-fluid formgrid grid col-12"},ye={class:"field lg:col-3 md:col-6 sm:col-6"},we=n("label",{for:"dm"},"DM:",-1),ge={class:"field lg:col-3 md:col-6 sm:col-6"},Ve=n("label",{for:"planta"},"Planta:",-1),Ce={class:"field lg:col-3 md:col-6 sm:col-6"},ke=n("label",{for:"perfil"},"Centro de Custo:",-1),De={class:"field lg:col-3 md:col-6 sm:col-6"},Ie=n("label",{for:"perfil"},"Setor:",-1),Se={class:"field lg:col-3 md:col-6 sm:col-6"},xe=n("label",{for:"perfil"},"Funcionário:",-1),Ae={class:"field lg:col-3 md:col-6 sm:col-6"},Oe=n("label",{for:"perfil"},"Data Inicial:",-1),Be={class:"field lg:col-3 md:col-6 sm:col-6"},Re=n("label",{for:"perfil"},"Data Final:",-1),Fe={class:"field lg:col-3 md:col-6 sm:col-6"},$e={class:"field lg:col-3 md:col-6 sm:col-6"},Me={class:"field lg:col-3 md:col-6 sm:col-6"},Ue={class:"datatable-wrapper"},Ne={class:"flex justify-content-end"},Te=n("i",{class:"pi pi-search"},null,-1),Je={__name:"retiradasrealizadas",setup(ze){const y=s(!1),O=s(""),d=ie();de();const w=s(null),g=s(null),V=s(null),C=s(null),k=s(null),v=s([]),p={label:"Todos",value:null},B=s(null),R=s([p]),F=s([p]),$=s([p]),M=s([p]),_=s({global:{value:null,matchMode:pe.CONTAINS}}),D=s("Ainda não foi feita nenhuma busca"),I=s(!0),U=s([]),S=s(!1),l=s({dm:"",id_planta:"",id_centro_custo:"",id_setor:"",id_funcionario:"",data_inicio:new Date(new Date().getFullYear(),new Date().getMonth(),1),data_final:new Date}),N=a=>{const e=a.getDate(),o=a.getMonth()+1,i=a.getFullYear();return`${e}/${o}/${i}`},T=a=>a?new Date(a).toISOString():null,J=async()=>{const a={id_cliente:d.userIdCliente,id_dm:l.value.dm===null?void 0:l.value.dm,id_planta:l.value.id_planta===null?void 0:l.value.id_planta,id_centro_custo:l.value.id_centro_custo===null?void 0:l.value.id_centro_custo,id_setor:l.value.id_setor===null?void 0:l.value.id_setor,id_funcionario:l.value.id_funcionario===null?void 0:l.value.id_funcionario,data_inicio:T(l.value.data_inicio),data_final:T(l.value.data_final)};try{S.value=!0;const e=await f.post("relatorioRetiRe/relatorio",a,{headers:{Authorization:`Bearer ${d.token}`}});v.value=e.data,Array.isArray(v.value)&&v.value.length===0&&(O.value="Nenhum resultado encontrado para os filtros aplicados.",y.value=!0),v.value.length===0?D.value="Nenhum dado encontrado. Por favor, verifique sua consulta.":D.value=""}catch(e){console.error("Erro ao buscar retiradas:",e)}finally{S.value=!1}},K=()=>{I.value=!0,U.value={}},Q=s(null),Y=a=>{const e=Object.keys(a[0]).join(","),o=a.map(i=>Object.values(i).join(",")).join(`
`);return`${e}
${o}`},q=()=>{const a=Y(v.value),e=new Blob([a],{type:"text/csv;charset=utf-8;"}),o=document.createElement("a"),i=URL.createObjectURL(e);o.setAttribute("href",i),o.setAttribute("download","RetiradasRealizadas.csv"),document.body.appendChild(o),o.click(),document.body.removeChild(o)},G=()=>{const a=JSON.stringify(v.value,null,2),e=new Blob([a],{type:"application/json;charset=utf-8;"}),o=document.createElement("a"),i=URL.createObjectURL(e);o.setAttribute("href",i),o.setAttribute("download","RetiradasRealizadas.json"),document.body.appendChild(o),o.click(),document.body.removeChild(o)},W=async()=>{const a={id_cliente:d.userIdCliente};try{const e=await f.get("/relatorioRetiRe/listardm",{params:a,headers:{Authorization:`Bearer ${d.token}`}});R.value=[p,...e.data.map(({id_dm:o})=>({label:`DM  ${o}`,value:o}))]}catch(e){console.error("Erro ao carregar lista de dms:",e)}},X=async()=>{const a={id_cliente:d.userIdCliente};try{const e=await f.post("funcionarios/listarplanta",a,{headers:{Authorization:`Bearer ${d.token}`}});F.value=[p,...e.data.map(({id_planta:o})=>({label:`Planta  ${o}`,value:o}))]}catch(e){console.error("Erro ao buscar opções de plantas:",e)}},Z=async()=>{const a={id_cliente:d.userIdCliente};try{const e=await f.post("funcionarios/listarsetor",a,{headers:{Authorization:`Bearer ${d.token}`}});$.value=[p,...e.data.map(({id_setor:o})=>({label:`Setor  ${o}`,value:o}))]}catch(e){console.error("Erro ao buscar setores/diretorias:",e)}},ee=async()=>{const a={id_cliente:d.userIdCliente};try{const e=await f.post("funcionarios/listarcentrocusto",a,{headers:{Authorization:`Bearer ${d.token}`}});M.value=[p,...e.data.map(({id_centro_custo:o})=>({label:`Centro de Custo  ${o}`,value:o}))]}catch(e){console.error("Erro ao buscar centros de custo:",e)}},oe=async()=>{const a={id_cliente:d.userIdCliente};try{const e=await f.post("/funcionarios/listar",a,{headers:{Authorization:`Bearer ${d.token}`}});B.value=e.data.map(o=>({label:o.nome,value:o.id_funcionario}))}catch(e){console.error("Erro ao carregar usuários:",e)}},ae=()=>{var a,e,o,i,h;(a=w.value)!=null&&a.overlayVisible&&w.value.hide(),(e=g.value)!=null&&e.overlayVisible&&g.value.hide(),(o=V.value)!=null&&o.overlayVisible&&V.value.hide(),(i=C.value)!=null&&i.overlayVisible&&C.value.hide(),(h=k.value)!=null&&h.overlayVisible&&k.value.hide()},z=()=>{ae()};return ce(()=>{W(),X(),Z(),oe(),ee()}),(a,e)=>{const o=c("Dropdown"),i=c("Button"),h=c("InputIcon"),le=c("InputText"),te=c("IconField"),m=c("Column"),ne=c("DataTable"),se=c("Card"),re=c("Dialog");return b(),L(ue,null,[n("div",ve,[n("div",fe,[n("div",_e,[he,I.value?(b(),L("div",be,[n("div",ye,[we,t(o,{class:"drop",modelValue:l.value.dm,"onUpdate:modelValue":e[0]||(e[0]=r=>l.value.dm=r),options:R.value,optionLabel:"label",optionValue:"value",ref_key:"dropdown1",ref:w,placeholder:"Todos"},null,8,["modelValue","options"])]),n("div",ge,[Ve,t(o,{class:"drop",modelValue:l.value.id_planta,"onUpdate:modelValue":e[1]||(e[1]=r=>l.value.id_planta=r),options:F.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown2",ref:g},null,8,["modelValue","options"])]),n("div",Ce,[ke,t(o,{class:"drop",modelValue:l.value.id_centro_custo,"onUpdate:modelValue":e[2]||(e[2]=r=>l.value.id_centro_custo=r),options:M.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown3",ref:V},null,8,["modelValue","options"])]),n("div",De,[Ie,t(o,{class:"drop",modelValue:l.value.id_setor,"onUpdate:modelValue":e[3]||(e[3]=r=>l.value.id_setor=r),options:$.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown4",ref:C},null,8,["modelValue","options"])]),n("div",Se,[xe,t(o,{class:"drop",modelValue:l.value.id_funcionario,"onUpdate:modelValue":e[4]||(e[4]=r=>l.value.id_funcionario=r),options:B.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown5",ref:k},null,8,["modelValue","options"])]),n("div",Ae,[Oe,t(j(E),{class:"drop",modelValue:l.value.data_inicio,"onUpdate:modelValue":e[5]||(e[5]=r=>l.value.data_inicio=r),showIcon:"",showOnFocus:!1,format:N,locale:"pt-BR","auto-apply":"","enable-time-picker":!1,placeholder:"Selecione uma data inicial",ref:"datepicker1",onOpen:z},null,8,["modelValue"])]),n("div",Be,[Re,t(j(E),{class:"drop",modelValue:l.value.data_final,"onUpdate:modelValue":e[6]||(e[6]=r=>l.value.data_final=r),showIcon:"",showOnFocus:!1,format:N,locale:"pt-BR","auto-apply":"","enable-time-picker":!1,placeholder:"Selecione uma data final",ref:"datepicker2",onOpen:z},null,8,["modelValue"])]),n("div",Fe,[t(i,{class:"filtrar",type:"button",label:"Filtrar Dados",icon:"pi pi-search",severity:"info",onClick:J})]),n("div",$e,[t(i,{class:"exportar",icon:"pi pi-file",label:"Exportar CSV",onClick:q})]),n("div",Me,[t(i,{class:"exportar",icon:"pi pi-file",label:"Exportar JSON",onClick:G})])])):x("",!0),n("div",Ue,[t(ne,{filters:_.value,"onUpdate:filters":e[8]||(e[8]=r=>_.value=r),value:v.value,stripedRows:"",showGridlines:"",paginator:"",rows:10,rowsPerPageOptions:[5,10,20,50],rowHover:"",globalFilterFields:["ID_DM","Dia","matricula","nome","email","ProdutoNome","Quantidade","ProdutoSKU"],tableStyle:{width:"100%"},ref_key:"dt",ref:Q,class:""},{header:u(()=>[n("div",Ne,[t(te,{iconPosition:"left"},{default:u(()=>[t(h,null,{default:u(()=>[Te]),_:1}),t(le,{modelValue:_.value.global.value,"onUpdate:modelValue":e[7]||(e[7]=r=>_.value.global.value=r),placeholder:"Busca"},null,8,["modelValue"])]),_:1})])]),empty:u(()=>[H(A(D.value),1)]),default:u(()=>[t(m,{field:"ID_DM",sortable:"",header:"DM"}),t(m,{field:"Dia",sortable:"",header:"Data"}),t(m,{field:"matricula",sortable:"",header:"Matricula"}),t(m,{field:"nome",sortable:"",header:"Nome"}),t(m,{field:"email",sortable:"",header:"E-mail"}),t(m,{field:"ProdutoNome",sortable:"",header:"Item"}),t(m,{field:"Quantidade",sortable:"",header:"Quant",class:"text-center"}),t(m,{field:"ProdutoSKU",sortable:"",header:"CA"})]),_:1},8,["filters","value"])]),I.value?x("",!0):(b(),P(se,{key:1},{title:u(()=>[H(A(U.value.dm),1)]),content:u(()=>[t(i,{type:"button",label:"Voltar",icon:"pi pi-check",severity:"info",onClick:K})]),_:1}))])])]),S.value?(b(),P(me,{key:0})):x("",!0),t(re,{header:"Informação",visible:y.value,style:{width:"50vw"},modal:!0,closable:!0},{footer:u(()=>[t(i,{label:"OK",icon:"pi pi-check",onClick:e[9]||(e[9]=r=>y.value=!1)})]),default:u(()=>[n("p",null,A(O.value),1)]),_:1},8,["visible"])],64)}}};export{Je as default};
