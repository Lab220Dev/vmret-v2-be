import{r as m,e as j,m as F,q as R,C as O,s as q,g as n,o as f,c as K,d as t,h as s,w as r,z as b,a as g,l as w,S as W,t as U,i as k}from"./index-ac32e295.js";import{L as G}from"./LoadingSpinner-d16fdc18.js";const H={class:"grid"},J={class:"col-12"},Q={class:"card"},X=t("h5",{class:"mt-2"},"Usuários Dispenser Machines",-1),Y={class:"col-12"},Z={class:"mt-2"},ee={class:"mt-5 mx-0 p-fluid grid"},ae={class:"full lg:col-12 md:col-12 sm:col-12"},te=t("label",{for:"name"},"Nome:",-1),oe={class:"full lg:col-7 md:col-7 sm:col-12"},se=t("label",{for:"email"},"Login:",-1),le={class:"full lg:col-5 md:col-5 sm:col-12"},ie=t("label",{for:"senha"},"Senha:",-1),ne={class:"full lg:col-5 md:col-5 sm:col-12"},re=t("label",{for:"senha"},"Confirme a Senha:",-1),ue={class:"full lg:col-4 md:col-4 sm:col-12"},ce=t("label",{class:"mt-3 ml-4",for:"switch2"},"Usuario Ativo?",-1),de={class:"flex align-items-center justify-content-end field col-12"},me={class:"confirmation-content"},pe=t("i",{class:"pi pi-exclamation-triangle mr-1",style:{"font-size":"2rem"}},null,-1),ve={class:""},be={__name:"UsuariosDMs",setup(fe){const p=m(0),u=j(),i=m(!1),V=F(),C={label:"Todos",value:null},v=m(!1),S=m(""),x=m([C]),l=R({nome:"",email:"",perfil:"",planta:"",senha:"",Status:""}),D=m([]);m([{name:"Gestor",value:"gestor"},{name:"Master",value:"master"},{name:"Operador",value:"operador"},{name:"Liberação Avulsa",value:"avulsa"}]);const B=a=>{show.value=!0,l.value=a.data},A=()=>{p.value=0,y()},T=()=>{v.value?$():I()},I=async()=>{const a={...l};try{const e=await w.post("/usuario/adicionar",a,{headers:{Authorization:`Bearer ${u.token}`}});V.add({severity:"success",summary:"Successful",detail:"Usuario WEB criado",life:3e3}),h(),p.value=0,y()}catch(e){console.error("Erro ao adicionar Usuario:",e)}finally{i.value=!1}i.value=!0},$=async()=>{i.value=!0;const a={...l};try{const e=await w.post("/usuario/atualizar",a,{headers:{Authorization:`Bearer ${u.token}`}});V.add({severity:"success",summary:"Successful",detail:"Usuario WEB atualizado",life:3e3}),h(),p.value=0,y()}catch(e){console.error("Erro ao atualizar o Usuario:",e)}finally{i.value=!1}i.value=!0},E=async()=>{const a={id_cliente:u.userIdCliente};try{const e=await w.post("/usuarios/listarPlanta",a,{headers:{Authorization:`Bearer ${u.token}`}});x.value=[C,...e.data.map(({id_planta:c})=>({label:`Planta  ${c}`,value:c}))]}catch(e){console.error("Erro ao buscar opções de plantas:",e)}},h=async()=>{i.value=!0;let a=null;u.userRole==="Administrador"?a="":(a={},a.id_cliente=u.userIdCliente);try{const e=await w.post("/usuarios/listar",a,{headers:{Authorization:`Bearer ${u.token}`}});D.value=e.data}catch(e){console.error("Erro ao carregar usuários:",e)}finally{i.value=!1}};O(p,(a,e)=>{a!==e&&a===0&&(y(),h(),v.value=!1)}),q(()=>{E(),h()});const y=()=>{l.nome="",l.Status=!0,l.email="",l.perfil="",l.planta="",l.senha=""};return(a,e)=>{const c=n("Column"),d=n("Button"),M=n("DataTable"),z=n("TabPanel"),_=n("InputText"),N=n("InputSwitch"),L=n("TabView"),P=n("Dialog");return f(),K("div",H,[t("div",J,[t("div",Q,[X,s(L,{activeIndex:p.value,"onUpdate:activeIndex":e[7]||(e[7]=o=>p.value=o)},{default:r(()=>[s(z,{header:"Listar  Usuário DM"},{default:r(()=>[t("div",Y,[s(M,{value:D.value,selectionMode:"single",tableStyle:"min-width: 25%",rowsPerPageOptions:[5,10,20,50],stripedRows:"",dataKey:"id",metaKeySelection:!1,onRowSelect:B,paginator:"",rows:10},{default:r(()=>[s(c,{field:"nome",header:"Nome"}),s(c,{field:"email",header:"Login"}),s(c,{field:"ativo",header:"Ativo"},{body:r(({data:o})=>[t("i",{class:W(["pi",{"pi-check-circle text-green-500 ":o.ativo,"pi-times-circle text-red-500":!o.ativo}])},null,2)]),_:1}),s(c,{style:{"min-width":"8rem"}},{body:r(o=>[s(d,{icon:"pi pi-trash",outlined:"",rounded:"",severity:"danger",onClick:he=>a.deleteUsuario(o.data)},null,8,["onClick"])]),_:1})]),_:1},8,["value"])])]),_:1}),s(z,{header:"Adicionar Usuário DM"},{default:r(()=>[t("h5",Z,U(v.value?"Editar ":"Novo ")+"Usuário",1),t("div",ee,[t("div",ae,[te,s(_,{class:"my-2",modelValue:l.nome,"onUpdate:modelValue":e[0]||(e[0]=o=>l.nome=o),id:"name",type:"text"},null,8,["modelValue"])]),t("div",oe,[se,s(_,{class:"my-2",modelValue:l.email,"onUpdate:modelValue":e[1]||(e[1]=o=>l.email=o),id:"email"},null,8,["modelValue"])]),t("div",le,[ie,s(_,{class:"my-2",id:"senha",modelValue:l.senha,"onUpdate:modelValue":e[2]||(e[2]=o=>l.senha=o),type:"password"},null,8,["modelValue"])]),t("div",ne,[re,s(_,{class:"my-2",id:"senha",modelValue:S.value,"onUpdate:modelValue":e[3]||(e[3]=o=>S.value=o),type:"password"},null,8,["modelValue"])]),t("div",ue,[ce,s(N,{class:"grid mt-3 ml-3",modelValue:l.status,"onUpdate:modelValue":e[4]||(e[4]=o=>l.status=o),inputId:"switch2"},null,8,["modelValue"])]),t("div",de,[v.value?(f(),b(d,{key:0,style:{width:"15%"},class:"buttons flex align-items-center justify-content-center m-2",label:"Atualizar",icon:"pi pi-refresh",severity:"primary",onClick:a.atualizarFuncionario},null,8,["onClick"])):g("",!0),v.value?(f(),b(d,{key:1,style:{width:"15%"},class:"buttons flex align-items-center justify-content-center m-2",label:"Excluir",icon:"pi pi-trash",severity:"danger",onClick:e[5]||(e[5]=o=>a.deleteFuncionarioDialog=!0)})):g("",!0),s(d,{style:{width:"15%"},class:"flex align-items-center justify-content-center m-2 mr-0",label:"Voltar",icon:"pi pi-arrow-left",severity:"primary",onClick:e[6]||(e[6]=o=>A())}),v.value?g("",!0):(f(),b(d,{key:2,style:{width:"15%"},class:"buttons flex align-items-center justify-content-center m-2",label:"Salvar",icon:"pi pi-check",severity:"info",onClick:T}))])])]),_:1})]),_:1},8,["activeIndex"]),s(P,{header:"Deletar Usuario",visible:a.deleteUsuarioDialog,"onUpdate:visible":e[10]||(e[10]=o=>a.deleteUsuarioDialog=o),style:{width:"400px"},modal:!0,closable:!1},{footer:r(()=>[s(d,{label:"Não",icon:"pi pi-times",onClick:e[8]||(e[8]=o=>a.deleteFuncionarioDialog=!1),class:"p-button-text"}),s(d,{label:"Sim",icon:"pi pi-check",onClick:e[9]||(e[9]=o=>a.deleteUsuario(a.item)),class:"p-button-text"})]),default:r(()=>[t("div",me,[pe,t("span",ve,[k(" Você tem certeza que deseja deletar o Usuario "),t("b",null,U(a.item.id_cliente),1),k(" - "),t("b",null,U(a.item.nome),1),k(" ?")])])]),_:1},8,["visible"]),i.value?(f(),b(G,{key:0})):g("",!0)])])])}}};export{be as default};
