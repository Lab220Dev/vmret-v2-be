import{H as R}from"./vue-datepicker-d4babe2b.js";import{r as s,e as se,s as re,g as d,o as y,c as H,d as a,h as t,y as K,a as M,w as u,z as Q,F as ie,l as f,i as j,t as S,A as de}from"./index-2c4d9b34.js";/* empty css             */import{L as ue}from"./LoadingSpinner-e33360a4.js";import"./format-7e97a1d1.js";const ce={class:"card vh"},pe={class:"form"},ve={class:"grid mt-3 mx-1 px-1"},fe=a("h5",{class:"my-4 text-2xl"},"Retiradas Avulsas",-1),me={key:0,class:"p-0 m-0 p-fluid formgrid grid col-12"},_e={class:"field xl:col-4 lg:col-4 md:col-6 sm:col-12"},he=a("label",{for:"dm"},"DM:",-1),be={class:"field xl:col-4 lg:col-4 md:col-6 sm:col-12"},ye=a("label",{for:"planta"},"Planta:",-1),Ve={class:"field xl:col-4 lg:col-4 md:col-6 sm:col-12"},we=a("label",{for:"perfil"},"Setor:",-1),ge={class:"field xl:col-4 lg:col-4 md:col-6 sm:col-12"},De=a("label",{for:"perfil"},"Centro de Custo:",-1),ke={class:"field xl:col-4 lg:col-4 md:col-6 sm:col-12"},Ie=a("label",{for:"perfil"},"Funcionário:",-1),Ce={class:"field xl:col-4 lg:col-4 md:col-6 sm:col-12"},xe=a("label",{for:"perfil"},"Voucher:",-1),Fe={class:"field xl:col-4 lg:col-4 md:col-4 sm:col-12"},Ae=a("label",{for:"perfil"},"Data Inicial:",-1),Be={class:"field xl:col-4 lg:col-4 md:col-4 sm:col-12"},Me=a("label",{for:"perfil"},"Data Final:",-1),Se={class:"field xl:col-4 lg:col-4 md:col-4 sm:col-12 justify-self-end"},$e={class:"datatable-wrapper"},Te={class:"flex justify-content-end"},Ue=a("i",{class:"pi pi-search"},null,-1),Re={__name:"retiradasavulsas",setup(Oe){const V=s(!1),$=s(""),w=s(!1),i=se(),g=s("Ainda não foi feita nenhuma busca"),m=s([]),D=s(null),k=s(null),I=s(null),C=s(null),x=s(null),F=s(null),c={label:"Todos",value:null},A=s(null),T=s([c]),U=s([c]),O=s([c]),L=s([c]),_=s({global:{value:null,matchMode:de.CONTAINS}}),B=s(!0),N=s([]),o=s({dm:"",id_planta:"",id_setor:"",id_centro_custo:"",id_funcionario:"",voucher:"",data_inicio:new Date(new Date().getFullYear(),new Date().getMonth(),1),data_final:new Date}),P=n=>{const e=n.getDate(),l=n.getMonth()+1,p=n.getFullYear();return`${e}/${l}/${p}`},E=n=>n?new Date(n).toISOString():null,Y=async()=>{const n={id_cliente:i.userIdCliente,id_dm:o.value.dm===null?void 0:o.value.dm,id_planta:o.value.id_planta===null?void 0:o.value.id_planta,id_centro_custo:o.value.id_centro_custo===null?void 0:o.value.id_centro_custo,id_setor:o.value.id_setor===null?void 0:o.value.id_setor,id_funcionario:o.value.id_funcionario===null?void 0:o.value.id_funcionario,data_inicio:E(o.value.data_inicio),data_final:E(o.value.data_final)};try{w.value=!0;const e=await f.post("",n,{headers:{Authorization:`Bearer ${i.token}`}});m.value=e.data,Array.isArray(m.value)&&m.value.length===0&&($.value="Nenhum resultado encontrado para os filtros aplicados.",V.value=!0),m.value.length===0?g.value="Nenhum dado encontrado. Por favor, verifique sua consulta.":g.value=""}catch(e){console.error("Erro ao buscar centros de custo:",e)}finally{w.value=!1}},q=()=>{B.value=!0,N.value={}},G=s(null),J=async()=>{const n={id_cliente:i.userIdCliente};try{const e=await f.get("/relatorioRetiAv/listardm",{params:n,headers:{Authorization:`Bearer ${i.token}`}});T.value=[c,...e.data.map(({id_dm:l})=>({label:`DM  ${l}`,value:l}))]}catch(e){console.error("Erro ao carregar lista de dms:",e)}},W=async()=>{const n={id_cliente:i.userIdCliente};try{const e=await f.post("funcionarios/listarplanta",n,{headers:{Authorization:`Bearer ${i.token}`}});U.value=[c,...e.data.map(({id_planta:l})=>({label:`Planta  ${l}`,value:l}))]}catch(e){console.error("Erro ao buscar opções de plantas:",e)}},X=async()=>{const n={id_cliente:i.userIdCliente};try{const e=await f.post("funcionarios/listarsetor",n,{headers:{Authorization:`Bearer ${i.token}`}});O.value=[c,...e.data.map(({id_setor:l})=>({label:`Setor  ${l}`,value:l}))]}catch(e){console.error("Erro ao buscar setores/diretorias:",e)}},Z=async()=>{const n={id_cliente:i.userIdCliente};try{const e=await f.post("funcionarios/listarcentrocusto",n,{headers:{Authorization:`Bearer ${i.token}`}});L.value=[c,...e.data.map(({id_centro_custo:l})=>({label:`Centro de Custo  ${l}`,value:l}))]}catch(e){console.error("Erro ao buscar centros de custo:",e)}},ee=async()=>{const n={id_cliente:i.userIdCliente};try{const e=await f.post("/funcionarios/listar",n,{headers:{Authorization:`Bearer ${i.token}`}});A.value=e.data.map(l=>({label:l.nome,value:l.id_funcionario}))}catch(e){console.error("Erro ao carregar usuários:",e)}},oe=()=>{var n,e,l,p,h,b;(n=D.value)!=null&&n.overlayVisible&&D.value.hide(),(e=k.value)!=null&&e.overlayVisible&&k.value.hide(),(l=I.value)!=null&&l.overlayVisible&&I.value.hide(),(p=C.value)!=null&&p.overlayVisible&&C.value.hide(),(h=x.value)!=null&&h.overlayVisible&&x.value.hide(),(b=F.value)!=null&&b.overlayVisible&&F.value.hide()},z=()=>{oe()};return re(()=>{J(),W(),X(),ee(),Z()}),(n,e)=>{const l=d("Dropdown"),p=d("Button"),h=d("InputIcon"),b=d("InputText"),le=d("IconField"),v=d("Column"),ae=d("DataTable"),te=d("Card"),ne=d("Dialog");return y(),H(ie,null,[a("div",ce,[a("div",pe,[a("div",ve,[fe,B.value?(y(),H("div",me,[a("div",_e,[he,t(l,{class:"drop",modelValue:o.value.dm,"onUpdate:modelValue":e[0]||(e[0]=r=>o.value.dm=r),options:T.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown1",ref:D},null,8,["modelValue","options"])]),a("div",be,[ye,t(l,{class:"drop",modelValue:o.value.id_planta,"onUpdate:modelValue":e[1]||(e[1]=r=>o.value.id_planta=r),options:U.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown2",ref:k},null,8,["modelValue","options"])]),a("div",Ve,[we,t(l,{class:"drop",modelValue:o.value.id_setor,"onUpdate:modelValue":e[2]||(e[2]=r=>o.value.id_setor=r),options:O.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown3",ref:I},null,8,["modelValue","options"])]),a("div",ge,[De,t(l,{class:"drop",modelValue:o.value.id_centro_custo,"onUpdate:modelValue":e[3]||(e[3]=r=>o.value.id_centro_custo=r),options:L.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown4",ref:C},null,8,["modelValue","options"])]),a("div",ke,[Ie,t(l,{class:"drop",modelValue:o.value.id_funcionario,"onUpdate:modelValue":e[4]||(e[4]=r=>o.value.id_funcionario=r),options:A.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown5",ref:x},null,8,["modelValue","options"])]),a("div",Ce,[xe,t(l,{class:"drop",modelValue:o.value.id_funcionario,"onUpdate:modelValue":e[5]||(e[5]=r=>o.value.id_funcionario=r),options:A.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown6",ref:F},null,8,["modelValue","options"])]),a("div",Fe,[Ae,t(K(R),{class:"drop",modelValue:o.value.data_inicio,"onUpdate:modelValue":e[6]||(e[6]=r=>o.value.data_inicio=r),showIcon:"",showOnFocus:!1,format:P,locale:"pt-BR","auto-apply":"",ref:"datepicker1","enable-time-picker":!1,teleport:"body",onOpen:z,placeholder:"Selecione uma data inicial"},null,8,["modelValue"])]),a("div",Be,[Me,t(K(R),{class:"drop",modelValue:o.value.data_final,"onUpdate:modelValue":e[7]||(e[7]=r=>o.value.data_final=r),showIcon:"",showOnFocus:!1,format:P,locale:"pt-BR","auto-apply":"",ref:"datepicker1","enable-time-picker":!1,teleport:"body",placeholder:"Selecione uma data final",onOpen:z},null,8,["modelValue"])]),a("div",Se,[t(p,{class:"filtrar",type:"button",label:"Filtrar Dados",icon:"pi pi-search",severity:"info",onClick:Y})])])):M("",!0),a("div",$e,[t(ae,{filters:_.value,"onUpdate:filters":e[9]||(e[9]=r=>_.value=r),value:m.value,stripedRows:"",showGridlines:"",paginator:"",rows:10,rowsPerPageOptions:[5,10,20,50],rowHover:"",globalFilterFields:["ID_DM","Dia","matricula","nome","email","ProdutoSKU","item","Quantidade"],tableStyle:{width:"100%"},ref_key:"dt",ref:G},{header:u(()=>[a("div",Te,[t(le,{iconPosition:"left"},{default:u(()=>[t(h,null,{default:u(()=>[Ue]),_:1}),t(b,{modelValue:_.value.global.value,"onUpdate:modelValue":e[8]||(e[8]=r=>_.value.global.value=r),placeholder:"Busca"},null,8,["modelValue"])]),_:1})])]),empty:u(()=>[j(S(g.value),1)]),default:u(()=>[t(v,{field:"ID_DM",sortable:"",header:"DM"}),t(v,{field:"Dia",sortable:"",header:"Data"}),t(v,{field:"matricula",sortable:"",header:"Matricula"}),t(v,{field:"nome",sortable:"",header:"Nome do Funcionário"}),t(v,{field:"email",sortable:"",header:"E-mail"}),t(v,{field:"ProdutoSKU",sortable:"",header:"CA"}),t(v,{field:"item",sortable:"",header:"Item"}),t(v,{field:"Quantidade",sortable:"",header:"Quantidade",class:"text-center"})]),_:1},8,["filters","value"])]),B.value?M("",!0):(y(),Q(te,{key:1},{title:u(()=>[j(S(N.value.dm),1)]),content:u(()=>[t(p,{type:"button",label:"Voltar",icon:"pi pi-arrow-left",severity:"info",onClick:q})]),_:1}))])])]),w.value?(y(),Q(ue,{key:0})):M("",!0),t(ne,{header:"Informação",visible:V.value,style:{width:"50vw"},modal:!0,closable:!0},{footer:u(()=>[t(p,{label:"OK",icon:"pi pi-check",onClick:e[10]||(e[10]=r=>V.value=!1)})]),default:u(()=>[a("p",null,S($.value),1)]),_:1},8,["visible"])],64)}}};export{Re as default};
