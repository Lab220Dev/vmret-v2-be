import{H as S}from"./vue-datepicker-91db1dd2.js";import{_ as R,r as o,e as H,m as Y,s as q,g as _,o as f,c as x,d as l,h as i,y as O,a as g,z as A,w as v,F as K,l as w,i as j,t as M,p as G,b as J,A as Q}from"./index-47c49ab3.js";/* empty css             */import{L as W}from"./LoadingSpinner-5d33e654.js";import"./format-7e97a1d1.js";const d=u=>(G("data-v-4508aaa8"),u=u(),J(),u),X={class:"card"},Z={class:"form"},ee={class:"grid mt-3 mx-1 px-1"},ae=d(()=>l("h5",{class:"my-4 text-2xl"},"Fichas Retiradas",-1)),oe={key:0,class:"p-0 m-0 p-fluid formgrid grid col-12"},le={class:"field lg:col-6 md:col-6 sm:col-6"},te=d(()=>l("label",{for:"planta"},"Planta:",-1)),se={class:"field lg:col-6 md:col-6 sm:col-6"},ne=d(()=>l("label",{for:"perfil"},"Funcionário:",-1)),ie={class:"field datepicker lg:col-4 md:col-6 sm:col-6"},re=d(()=>l("label",{for:"perfil"},"Data Inicial:",-1)),ce={class:"field lg:col-4 md:col-6 sm:col-6"},de=d(()=>l("label",{for:"perfil"},"Data Final:",-1)),ue={class:"field lg:col-4 md:col-6 sm:col-6"},pe={__name:"fichasretiradas",setup(u){const k=o(!1),$=o(""),m=o(!1),r=H();Y();const V=o("Ainda não foi feita nenhuma busca"),p={label:"Todos",value:null};o([]);const D=o([p]),h=o(null),b=o(null),I=o([p]);o({global:{value:null,matchMode:Q.CONTAINS}});const y=o(!0),F=o([]),a=o({id_planta:"",id_funcionario:"",data_inicio:new Date(new Date().getFullYear(),new Date().getMonth(),1),data_final:new Date}),C=t=>{const e=t.getDate(),s=t.getMonth()+1,c=t.getFullYear();return`${e}/${s}/${c}`},N=async()=>{const t={id_cliente:r.userIdCliente,id_planta:a.value.id_planta===null?void 0:a.value.id_planta,id_funcionario:a.value.id_funcionario===null?void 0:a.value.id_funcionario,data_inicio:toISODate(a.value.data_inicio),data_final:toISODate(a.value.data_final)};try{m.value=!0;const e=await w.post("",t,{headers:{Authorization:`Bearer ${r.token}`}});retiradas.value=e.data,retiradas.value.length===0?V.value="Nenhum dado encontrado. Por favor, verifique sua consulta.":V.value=""}catch(e){console.error("Erro ao buscar fichas:",e)}finally{m.value=!1}},T=()=>{y.value=!0,F.value={}};o(null);const L=async()=>{const t={id_cliente:r.userIdCliente};try{const e=await w.post("funcionarios/listarplanta",t,{headers:{Authorization:`Bearer ${r.token}`}});I.value=[p,...e.data.map(({id_planta:s})=>({label:`Planta  ${s}`,value:s}))]}catch(e){console.error("Erro ao buscar opções de plantas:",e)}},z=async()=>{const t={id_cliente:r.userIdCliente};try{const e=await w.post("/funcionarios/listar",t,{headers:{Authorization:`Bearer ${r.token}`}});D.value=[p,...e.data.map(s=>({label:s.nome,value:s.id_funcionario}))]}catch(e){console.error("Erro ao carregar usuários:",e)}},E=()=>{var t,e;(t=h.value)!=null&&t.overlayVisible&&h.value.hide(),(e=b.value)!=null&&e.overlayVisible&&b.value.hide()},B=()=>{E()};return q(()=>{L(),z()}),(t,e)=>{const s=_("Dropdown"),c=_("Button"),P=_("Card"),U=_("Dialog");return f(),x(K,null,[l("div",X,[l("div",Z,[l("div",ee,[ae,y.value?(f(),x("div",oe,[l("div",le,[te,i(s,{class:"drop",modelValue:a.value.id_planta,"onUpdate:modelValue":e[0]||(e[0]=n=>a.value.id_planta=n),options:I.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown1",ref:h},null,8,["modelValue","options"])]),l("div",se,[ne,i(s,{class:"drop",modelValue:a.value.id_funcionario,"onUpdate:modelValue":e[1]||(e[1]=n=>a.value.id_funcionario=n),options:D.value,optionLabel:"label",optionValue:"value",ref_key:"dropdown2",ref:b,placeholder:"Todos"},null,8,["modelValue","options"])]),l("div",ie,[re,i(O(S),{class:"drop",modelValue:a.value.data_inicio,"onUpdate:modelValue":e[2]||(e[2]=n=>a.value.data_inicio=n),showIcon:"",showOnFocus:!1,format:C,locale:"pt-BR","auto-apply":"","enable-time-picker":!1,onOpen:B,placeholder:"Selecione uma data"},null,8,["modelValue"])]),l("div",ce,[de,i(O(S),{class:"datepicker",modelValue:a.value.data_final,"onUpdate:modelValue":e[3]||(e[3]=n=>a.value.data_final=n),showIcon:"",showOnFocus:!1,format:C,locale:"pt-BR","auto-apply":"","enable-time-picker":!1,placeholder:"Selecione uma data",onOpen:B},null,8,["modelValue"])]),l("div",ue,[i(c,{class:"filtrar",type:"button",label:"Filtrar Dados",icon:"pi pi-search",severity:"info",onClick:N})])])):g("",!0),y.value?g("",!0):(f(),A(P,{key:1},{title:v(()=>[j(M(F.value.dm),1)]),content:v(()=>[i(c,{type:"button",label:"Voltar",icon:"pi pi-check",severity:"info",onClick:T})]),_:1}))])])]),m.value?(f(),A(W,{key:0})):g("",!0),i(U,{header:"",visible:k.value,style:{width:"50vw"},modal:!0,closable:!1},{footer:v(()=>[i(c,{label:"OK",icon:"pi pi-check",onClick:e[4]||(e[4]=n=>k.value=!1)})]),default:v(()=>[l("p",null,M($.value),1)]),_:1},8,["visible"])],64)}}},be=R(pe,[["__scopeId","data-v-4508aaa8"]]);export{be as default};
