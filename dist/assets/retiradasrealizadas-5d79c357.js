import{H as E}from"./vue-datepicker-5538490c.js";import{r,e as ie,m as de,s as ce,g as u,o as b,c as L,d as n,h as t,y as P,a as S,w as p,z as j,F as ue,l as f,i as H,t as A,A as pe}from"./index-cbac5dd2.js";/* empty css             */import{L as me}from"./LoadingSpinner-007dd4da.js";import"./format-7e97a1d1.js";/* empty css                                                       */const ve={class:"card vh"},fe={class:"form"},_e={class:"grid mt-3 mx-1 px-1"},he=n("h5",{class:"my-4 text-2xl"},"Retiradas Realizadas",-1),be={key:0,class:"p-0 m-0 p-fluid formgrid grid col-12"},ye={class:"field xl:col-3 lg:col-6 md:col-6 sm:col-6"},we=n("label",{for:"dm"},"DM:",-1),ge={class:"field xl:col-3 lg:col-6 md:col-6 sm:col-6"},Ce=n("label",{for:"planta"},"Planta:",-1),Ve={class:"field xl:col-3 lg:col-4 md:col-6 sm:col-6"},De=n("label",{for:"perfil"},"Centro de Custo:",-1),ke={class:"field xl:col-3 lg:col-4 md:col-6 sm:col-6"},xe=n("label",{for:"perfil"},"Setor:",-1),Ie={class:"field xl:col-3 lg:col-4 md:col-6 sm:col-6"},Se=n("label",{for:"perfil"},"Funcionário:",-1),Ae={class:"field xl:col-3 lg:col-4 md:col-6 sm:col-6"},Oe=n("label",{for:"perfil"},"Data Inicial:",-1),Be={class:"field xl:col-3 lg:col-4 md:col-6 sm:col-6"},Re=n("label",{for:"perfil"},"Data Final:",-1),Fe={class:"field xl:col-3 lg:col-4 md:col-6 sm:col-6"},$e={class:"field xl:col-3 lg:col-4 md:col-6 sm:col-6"},Me={class:"field xl:col-3 lg:col-4 md:col-6 sm:col-6"},Ue={class:"datatable-wrapper"},Ne={class:"flex justify-content-end"},Te=n("i",{class:"pi pi-search"},null,-1),Ke={__name:"retiradasrealizadas",setup(ze){const y=r(!1),O=r(""),d=ie();de();const w=r(null),g=r(null),C=r(null),V=r(null),D=r(null),v=r([]),c={label:"Todos",value:null},B=r(null),R=r([c]),F=r([c]),$=r([c]),M=r([c]),_=r({global:{value:null,matchMode:pe.CONTAINS}}),k=r("Ainda não foi feita nenhuma busca"),x=r(!0),U=r([]),I=r(!1),a=r({id_dm:"",id_planta:"",ID_CentroCusto:"",id_setor:"",id_funcionario:"",data_inicio:new Date(new Date().getFullYear(),new Date().getMonth(),1),data_final:new Date}),N=l=>{const e=l.getDate(),o=l.getMonth()+1,s=l.getFullYear();return`${e}/${o}/${s}`},T=l=>l?new Date(l).toISOString():null,J=async()=>{const l={id_cliente:d.userIdCliente,id_dm:a.value.dm===null?void 0:a.value.dm,id_planta:a.value.id_planta===null?void 0:a.value.id_planta,id_centro_custo:a.value.id_centro_custo===null?void 0:a.value.id_centro_custo,id_setor:a.value.id_setor===null?void 0:a.value.id_setor,id_funcionario:a.value.id_funcionario===null?void 0:a.value.id_funcionario,data_inicio:T(a.value.data_inicio),data_final:T(a.value.data_final)};try{I.value=!0;const e=await f.post("relatorioRetiRe/relatorio",l,{headers:{Authorization:`Bearer ${d.token}`}});v.value=e.data,Array.isArray(v.value)&&v.value.length===0&&(O.value="Nenhum dado encontrado. Por favor, verifique sua consulta.",y.value=!0),v.value.length===0?k.value="Nenhum dado encontrado. Por favor, verifique sua consulta.":k.value=""}catch(e){console.error("Erro ao buscar retiradas:",e)}finally{I.value=!1}},K=()=>{x.value=!0,U.value={}},Q=r(null),q=l=>{const e=Object.keys(l[0]).join(","),o=l.map(s=>Object.values(s).join(",")).join(`
`);return`${e}
${o}`},Y=()=>{const l=q(v.value),e=new Blob([l],{type:"text/csv;charset=utf-8;"}),o=document.createElement("a"),s=URL.createObjectURL(e);o.setAttribute("href",s),o.setAttribute("download","RetiradasRealizadas.csv"),document.body.appendChild(o),o.click(),document.body.removeChild(o)},G=()=>{const l=JSON.stringify(v.value,null,2),e=new Blob([l],{type:"application/json;charset=utf-8;"}),o=document.createElement("a"),s=URL.createObjectURL(e);o.setAttribute("href",s),o.setAttribute("download","RetiradasRealizadas.json"),document.body.appendChild(o),o.click(),document.body.removeChild(o)},W=async()=>{const l={id_cliente:d.userIdCliente};try{const e=await f.post("/relatorioRetiRe/listardm",l,{headers:{Authorization:`Bearer ${d.token}`}});R.value=[c,...e.data.map(({ID_DM:o,Identificacao:s})=>({label:`DM  ${s}`,value:o}))]}catch(e){console.error("Erro ao carregar lista de dms:",e)}},X=async()=>{const l={id_cliente:d.userIdCliente};try{const e=await f.post("plantas/listar",l,{headers:{Authorization:`Bearer ${d.token}`}});F.value=[c,...e.data.map(({nome:o,id_planta:s})=>({label:`Planta  ${o}`,value:s}))]}catch(e){console.error("Erro ao buscar opções de plantas:",e)}},Z=async()=>{const l={id_cliente:d.userIdCliente};try{const e=await f.post("Setor/listar",l,{headers:{Authorization:`Bearer ${d.token}`}});$.value=[c,...e.data.map(({id_setor:o,nome:s})=>({label:`Setor  ${s}`,value:o}))]}catch(e){console.error("Erro ao buscar setores/diretorias:",e)}},ee=async()=>{const l={id_cliente:d.userIdCliente};try{const e=await f.post("cdc/listar",l,{headers:{Authorization:`Bearer ${d.token}`}});M.value=[c,...e.data.map(({ID_CentroCusto:o,Nome:s})=>({label:`Centro de Custo  ${s}`,value:o}))]}catch(e){console.error("Erro ao buscar centros de custo:",e)}},oe=async()=>{const l={id_cliente:d.userIdCliente};try{const e=await f.post("/funcionarios/listar",l,{headers:{Authorization:`Bearer ${d.token}`}});B.value=[c,...e.data.map(o=>({label:o.nome,value:o.id_funcionario}))]}catch(e){console.error("Erro ao carregar usuários:",e)}},le=()=>{var l,e,o,s,h;(l=w.value)!=null&&l.overlayVisible&&w.value.hide(),(e=g.value)!=null&&e.overlayVisible&&g.value.hide(),(o=C.value)!=null&&o.overlayVisible&&C.value.hide(),(s=V.value)!=null&&s.overlayVisible&&V.value.hide(),(h=D.value)!=null&&h.overlayVisible&&D.value.hide()},z=()=>{le()};return ce(()=>{W(),X(),Z(),oe(),ee()}),(l,e)=>{const o=u("Dropdown"),s=u("Button"),h=u("InputIcon"),ae=u("InputText"),te=u("IconField"),m=u("Column"),ne=u("DataTable"),se=u("Card"),re=u("Dialog");return b(),L(ue,null,[n("div",ve,[n("div",fe,[n("div",_e,[he,x.value?(b(),L("div",be,[n("div",ye,[we,t(o,{class:"drop",modelValue:a.value.id_dm,"onUpdate:modelValue":e[0]||(e[0]=i=>a.value.id_dm=i),options:R.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown1",ref:w},null,8,["modelValue","options"])]),n("div",ge,[Ce,t(o,{class:"drop",modelValue:a.value.id_planta,"onUpdate:modelValue":e[1]||(e[1]=i=>a.value.id_planta=i),options:F.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown2",ref:g},null,8,["modelValue","options"])]),n("div",Ve,[De,t(o,{class:"drop",modelValue:a.value.ID_CentroCusto,"onUpdate:modelValue":e[2]||(e[2]=i=>a.value.ID_CentroCusto=i),options:M.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown3",ref:C},null,8,["modelValue","options"])]),n("div",ke,[xe,t(o,{class:"drop",modelValue:a.value.id_setor,"onUpdate:modelValue":e[3]||(e[3]=i=>a.value.id_setor=i),options:$.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown4",ref:V},null,8,["modelValue","options"])]),n("div",Ie,[Se,t(o,{class:"drop",modelValue:a.value.id_funcionario,"onUpdate:modelValue":e[4]||(e[4]=i=>a.value.id_funcionario=i),options:B.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown5",ref:D},null,8,["modelValue","options"])]),n("div",Ae,[Oe,t(P(E),{class:"drop",modelValue:a.value.data_inicio,"onUpdate:modelValue":e[5]||(e[5]=i=>a.value.data_inicio=i),showIcon:"",showOnFocus:!1,format:N,locale:"pt-BR","auto-apply":"","enable-time-picker":!1,placeholder:"Selecione uma data inicial",teleport:"body",ref:"datepicker1",onOpen:z},null,8,["modelValue"])]),n("div",Be,[Re,t(P(E),{class:"drop",modelValue:a.value.data_final,"onUpdate:modelValue":e[6]||(e[6]=i=>a.value.data_final=i),showIcon:"",showOnFocus:!1,format:N,locale:"pt-BR","auto-apply":"","enable-time-picker":!1,placeholder:"Selecione uma data final",teleport:"body",ref:"datepicker2",onOpen:z},null,8,["modelValue"])]),n("div",Fe,[t(s,{class:"filtrar",type:"button",label:"Filtrar Dados",icon:"pi pi-search",severity:"info",onClick:J})]),n("div",$e,[t(s,{class:"exportar",icon:"pi pi-file",label:"Exportar CSV",onClick:Y})]),n("div",Me,[t(s,{class:"exportar",icon:"pi pi-file",label:"Exportar JSON",onClick:G})])])):S("",!0),n("div",Ue,[t(ne,{filters:_.value,"onUpdate:filters":e[8]||(e[8]=i=>_.value=i),value:v.value,stripedRows:"",showGridlines:"",paginator:"",rows:10,rowsPerPageOptions:[5,10,20,50],rowHover:"",globalFilterFields:["ID_DM","Dia","matricula","nome","email","ProdutoNome","Quantidade","ProdutoSKU"],tableStyle:{width:"100%"},ref_key:"dt",ref:Q,class:""},{header:p(()=>[n("div",Ne,[t(te,{iconPosition:"left"},{default:p(()=>[t(h,null,{default:p(()=>[Te]),_:1}),t(ae,{modelValue:_.value.global.value,"onUpdate:modelValue":e[7]||(e[7]=i=>_.value.global.value=i),placeholder:"Busca"},null,8,["modelValue"])]),_:1})])]),empty:p(()=>[H(A(k.value),1)]),default:p(()=>[t(m,{field:"ID_DM",sortable:"",header:"DM"}),t(m,{field:"Dia",sortable:"",header:"Data"}),t(m,{field:"matricula",sortable:"",header:"Matricula"}),t(m,{field:"nome",sortable:"",header:"Nome"}),t(m,{field:"email",sortable:"",header:"E-mail"}),t(m,{field:"ProdutoNome",sortable:"",header:"Item"}),t(m,{field:"Quantidade",sortable:"",header:"Quant",class:"text-center"}),t(m,{field:"ProdutoSKU",sortable:"",header:"CA"})]),_:1},8,["filters","value"])]),x.value?S("",!0):(b(),j(se,{key:1},{title:p(()=>[H(A(U.value.dm),1)]),content:p(()=>[t(s,{type:"button",label:"Voltar",icon:"pi pi-arrow-left",severity:"info",onClick:K})]),_:1}))])])]),I.value?(b(),j(me,{key:0})):S("",!0),t(re,{header:"Informação",visible:y.value,style:{width:"30vw"},modal:!0,closable:!1},{footer:p(()=>[t(s,{label:"OK",icon:"pi pi-check",onClick:e[9]||(e[9]=i=>y.value=!1)})]),default:p(()=>[n("p",null,A(O.value),1)]),_:1},8,["visible"])],64)}}};export{Ke as default};
