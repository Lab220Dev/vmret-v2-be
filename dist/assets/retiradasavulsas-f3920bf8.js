import{H as R}from"./vue-datepicker-586ac984.js";import{r as s,e as se,s as re,g as c,o as y,c as H,d as l,h as a,y as K,a as B,w as p,z as Q,F as ie,l as f,i as j,t as M,A as de}from"./index-049900ab.js";/* empty css             */import{L as ue}from"./LoadingSpinner-fcf5a171.js";import"./format-7e97a1d1.js";/* empty css                                                       */const ce={class:"card vh"},pe={class:"form"},ve={class:"grid mt-3 mx-1 px-1"},fe=l("h5",{class:"my-4 text-2xl"},"Retiradas Avulsas",-1),_e={key:0,class:"p-0 m-0 p-fluid formgrid grid col-12"},me={class:"field xl:col-4 lg:col-4 md:col-6 sm:col-12"},he=l("label",{for:"dm"},"DM:",-1),be={class:"field xl:col-4 lg:col-4 md:col-6 sm:col-12"},ye=l("label",{for:"planta"},"Planta:",-1),Ve={class:"field xl:col-4 lg:col-4 md:col-6 sm:col-12"},we=l("label",{for:"perfil"},"Setor:",-1),ge={class:"field xl:col-4 lg:col-4 md:col-6 sm:col-12"},De=l("label",{for:"perfil"},"Centro de Custo:",-1),ke={class:"field xl:col-4 lg:col-4 md:col-6 sm:col-12"},Ie=l("label",{for:"perfil"},"Funcionário:",-1),Ce={class:"field xl:col-4 lg:col-4 md:col-6 sm:col-12"},xe=l("label",{for:"perfil"},"Voucher:",-1),Fe={class:"field xl:col-4 lg:col-4 md:col-4 sm:col-12"},Se=l("label",{for:"perfil"},"Data Inicial:",-1),Ae={class:"field xl:col-4 lg:col-4 md:col-4 sm:col-12"},Be=l("label",{for:"perfil"},"Data Final:",-1),Me={class:"field xl:col-4 lg:col-4 md:col-4 sm:col-12 justify-self-end"},$e={class:"datatable-wrapper"},Te={class:"flex justify-content-end"},Ue=l("i",{class:"pi pi-search"},null,-1),He={__name:"retiradasavulsas",setup(Oe){const V=s(!1),$=s(""),w=s(!1),d=se(),g=s("Ainda não foi feita nenhuma busca"),_=s([]),D=s(null),k=s(null),I=s(null),C=s(null),x=s(null),F=s(null),u={label:"Todos",value:null},S=s(null),T=s([u]),U=s([u]),O=s([u]),L=s([u]),m=s({global:{value:null,matchMode:de.CONTAINS}}),A=s(!0),N=s([]),o=s({dm:"",id_planta:"",id_setor:"",id_centro_custo:"",id_funcionario:"",voucher:"",data_inicio:new Date(new Date().getFullYear(),new Date().getMonth(),1),data_final:new Date}),P=t=>{const e=t.getDate(),n=t.getMonth()+1,i=t.getFullYear();return`${e}/${n}/${i}`},E=t=>t?new Date(t).toISOString():null,Y=async()=>{const t={id_cliente:d.userIdCliente,id_dm:o.value.dm===null?void 0:o.value.dm,id_planta:o.value.id_planta===null?void 0:o.value.id_planta,id_centro_custo:o.value.id_centro_custo===null?void 0:o.value.id_centro_custo,id_setor:o.value.id_setor===null?void 0:o.value.id_setor,id_funcionario:o.value.id_funcionario===null?void 0:o.value.id_funcionario,data_inicio:E(o.value.data_inicio),data_final:E(o.value.data_final)};try{w.value=!0;const e=await f.post("",t,{headers:{Authorization:`Bearer ${d.token}`}});_.value=e.data,Array.isArray(_.value)&&_.value.length===0&&($.value="Nenhum resultado encontrado para os filtros aplicados.",V.value=!0),_.value.length===0?g.value="Nenhum dado encontrado. Por favor, verifique sua consulta.":g.value=""}catch(e){console.error("Erro ao buscar centros de custo:",e)}finally{w.value=!1}},q=()=>{A.value=!0,N.value={}},G=s(null),J=async()=>{const t={id_cliente:d.userIdCliente};try{const e=await f.post("/relatorioRetiRe/listardm",t,{headers:{Authorization:`Bearer ${d.token}`}});T.value=[u,...e.data.map(({ID_DM:n,Identificacao:i})=>({label:`DM  ${i}`,value:n}))]}catch(e){console.error("Erro ao carregar lista de dms:",e)}},W=async()=>{const t={id_cliente:d.userIdCliente};try{const e=await f.post("plantas/listar",t,{headers:{Authorization:`Bearer ${d.token}`}});U.value=[u,...e.data.map(({nome:n,id_planta:i})=>({label:`Planta  ${n}`,value:i}))]}catch(e){console.error("Erro ao buscar opções de plantas:",e)}},X=async()=>{const t={id_cliente:d.userIdCliente};try{const e=await f.post("Setor/listar",t,{headers:{Authorization:`Bearer ${d.token}`}});O.value=[u,...e.data.map(({id_setor:n,nome:i})=>({label:`Setor  ${i}`,value:n}))]}catch(e){console.error("Erro ao buscar setores/diretorias:",e)}},Z=async()=>{const t={id_cliente:d.userIdCliente};try{const e=await f.post("cdc/listar",t,{headers:{Authorization:`Bearer ${d.token}`}});L.value=[u,...e.data.map(({ID_CentroCusto:n,Nome:i})=>({label:`Centro de Custo  ${i}`,value:n}))]}catch(e){console.error("Erro ao buscar centros de custo:",e)}},ee=async()=>{const t={id_cliente:d.userIdCliente};try{const e=await f.post("/funcionarios/listar",t,{headers:{Authorization:`Bearer ${d.token}`}});S.value=[u,...e.data.map(n=>({label:n.nome,value:n.id_funcionario}))]}catch(e){console.error("Erro ao carregar usuários:",e)}},oe=()=>{var t,e,n,i,h,b;(t=D.value)!=null&&t.overlayVisible&&D.value.hide(),(e=k.value)!=null&&e.overlayVisible&&k.value.hide(),(n=I.value)!=null&&n.overlayVisible&&I.value.hide(),(i=C.value)!=null&&i.overlayVisible&&C.value.hide(),(h=x.value)!=null&&h.overlayVisible&&x.value.hide(),(b=F.value)!=null&&b.overlayVisible&&F.value.hide()},z=()=>{oe()};return re(()=>{J(),W(),X(),ee(),Z()}),(t,e)=>{const n=c("Dropdown"),i=c("Button"),h=c("InputIcon"),b=c("InputText"),le=c("IconField"),v=c("Column"),ae=c("DataTable"),te=c("Card"),ne=c("Dialog");return y(),H(ie,null,[l("div",ce,[l("div",pe,[l("div",ve,[fe,A.value?(y(),H("div",_e,[l("div",me,[he,a(n,{class:"drop",modelValue:o.value.dm,"onUpdate:modelValue":e[0]||(e[0]=r=>o.value.dm=r),options:T.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown1",ref:D},null,8,["modelValue","options"])]),l("div",be,[ye,a(n,{class:"drop",modelValue:o.value.id_planta,"onUpdate:modelValue":e[1]||(e[1]=r=>o.value.id_planta=r),options:U.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown2",ref:k},null,8,["modelValue","options"])]),l("div",Ve,[we,a(n,{class:"drop",modelValue:o.value.id_setor,"onUpdate:modelValue":e[2]||(e[2]=r=>o.value.id_setor=r),options:O.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown3",ref:I},null,8,["modelValue","options"])]),l("div",ge,[De,a(n,{class:"drop",modelValue:o.value.id_centro_custo,"onUpdate:modelValue":e[3]||(e[3]=r=>o.value.id_centro_custo=r),options:L.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown4",ref:C},null,8,["modelValue","options"])]),l("div",ke,[Ie,a(n,{class:"drop",modelValue:o.value.id_funcionario,"onUpdate:modelValue":e[4]||(e[4]=r=>o.value.id_funcionario=r),options:S.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown5",ref:x},null,8,["modelValue","options"])]),l("div",Ce,[xe,a(n,{class:"drop",modelValue:o.value.id_funcionario,"onUpdate:modelValue":e[5]||(e[5]=r=>o.value.id_funcionario=r),options:S.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown6",ref:F},null,8,["modelValue","options"])]),l("div",Fe,[Se,a(K(R),{class:"drop",modelValue:o.value.data_inicio,"onUpdate:modelValue":e[6]||(e[6]=r=>o.value.data_inicio=r),showIcon:"",showOnFocus:!1,format:P,locale:"pt-BR","auto-apply":"",ref:"datepicker1","enable-time-picker":!1,teleport:"body",onOpen:z,placeholder:"Selecione uma data inicial"},null,8,["modelValue"])]),l("div",Ae,[Be,a(K(R),{class:"drop",modelValue:o.value.data_final,"onUpdate:modelValue":e[7]||(e[7]=r=>o.value.data_final=r),showIcon:"",showOnFocus:!1,format:P,locale:"pt-BR","auto-apply":"",ref:"datepicker1","enable-time-picker":!1,teleport:"body",placeholder:"Selecione uma data final",onOpen:z},null,8,["modelValue"])]),l("div",Me,[a(i,{class:"filtrar",type:"button",label:"Filtrar Dados",icon:"pi pi-search",severity:"info",onClick:Y})])])):B("",!0),l("div",$e,[a(ae,{filters:m.value,"onUpdate:filters":e[9]||(e[9]=r=>m.value=r),value:_.value,stripedRows:"",showGridlines:"",paginator:"",rows:10,rowsPerPageOptions:[5,10,20,50],rowHover:"",globalFilterFields:["ID_DM","Dia","matricula","nome","email","ProdutoSKU","item","Quantidade"],tableStyle:{width:"100%"},ref_key:"dt",ref:G},{header:p(()=>[l("div",Te,[a(le,{iconPosition:"left"},{default:p(()=>[a(h,null,{default:p(()=>[Ue]),_:1}),a(b,{modelValue:m.value.global.value,"onUpdate:modelValue":e[8]||(e[8]=r=>m.value.global.value=r),placeholder:"Busca"},null,8,["modelValue"])]),_:1})])]),empty:p(()=>[j(M(g.value),1)]),default:p(()=>[a(v,{field:"ID_DM",sortable:"",header:"DM"}),a(v,{field:"Dia",sortable:"",header:"Data"}),a(v,{field:"matricula",sortable:"",header:"Matricula"}),a(v,{field:"nome",sortable:"",header:"Nome do Funcionário"}),a(v,{field:"email",sortable:"",header:"E-mail"}),a(v,{field:"ProdutoSKU",sortable:"",header:"CA"}),a(v,{field:"item",sortable:"",header:"Item"}),a(v,{field:"Quantidade",sortable:"",header:"Quantidade",class:"text-center"})]),_:1},8,["filters","value"])]),A.value?B("",!0):(y(),Q(te,{key:1},{title:p(()=>[j(M(N.value.dm),1)]),content:p(()=>[a(i,{type:"button",label:"Voltar",icon:"pi pi-arrow-left",severity:"info",onClick:q})]),_:1}))])])]),w.value?(y(),Q(ue,{key:0})):B("",!0),a(ne,{header:"Informação",visible:V.value,style:{width:"50vw"},modal:!0,closable:!0},{footer:p(()=>[a(i,{label:"OK",icon:"pi pi-check",onClick:e[10]||(e[10]=r=>V.value=!1)})]),default:p(()=>[l("p",null,M($.value),1)]),_:1},8,["visible"])],64)}}};export{He as default};
