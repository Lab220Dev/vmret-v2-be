import{r as v,e as R,m as K,q as P,C as O,s as G,g as c,o as h,c as H,h as n,w as u,z as w,a as C,l as b,d as o,i as k,k as J,y as d,t as N}from"./index-40d2c570.js";import{L as Q}from"./LoadingSpinner-99c31137.js";/* empty css                                                       */const W={class:"card vh"},X={class:"col-12"},Y={class:"grid"},Z={class:"col-12"},ee={class:"card"},oe={class:"p-fluid formgrid grid m-0 p-0"},te={class:"full lg:col-12 md:col-12 sm:col-12"},ae=o("label",{for:"id_funcao"},"Código da Função:",-1),se={class:"full lg:col-12 md:col-12 sm:col-12"},ne=o("label",{for:"nome"},"Função (Nome):",-1),le={class:"field lg:col-4 md:col-6 sm:col-6"},ie=o("label",{for:"perfil"},"Centro de Custo:",-1),re={class:"mr-1 mt-4 grid justify-content-end"},ce=o("div",{class:"mr-1 mt-7 grid justify-content-end flex-wrap"},null,-1),de={class:"confirmation-content"},ue=o("i",{class:"pi pi-exclamation-triangle mr-1",style:{"font-size":"2rem"}},null,-1),me={class:""},ye={__name:"funcao",setup(fe){const i=v(0),r=R(),F=K(),V=v([]),m=v(!1),D={label:"Todos",value:null},S=v([D]),l=v(!1),p=v(!1);let a=P({codigo:"",nome:"",id_centro_custo:""});const E=t=>{a=t.data,m.value=!0,i.value=1,f()},$=()=>{m.value?z():T()},f=async()=>{const t={id_cliente:r.userIdCliente};l.value=!0;try{const e=await b.post("/funcao/listar",t,{headers:{Authorization:`Bearer ${r.token}`}});V.value=e.data}catch(e){console.error("Erro ao listar Funções e Diretorias:",e)}finally{l.value=!1}},T=async()=>{const t={id_cliente:r.userIdCliente,...a};l.value=!0;try{const e=await b.post("/funcao/adicionar",t,{headers:{Authorization:`Bearer ${r.token}`}});f(),i.value=0,g()}catch(e){console.error("Erro ao adicionar Funções e Diretorias:",e)}finally{l.value=!1}},A=async()=>{let t={id_funcao:a.id_funcao};l.value=!0;try{await b.post("/funcao/deletar",t,{headers:{Authorization:`Bearer ${r.token}`}}),F.add({severity:"success",summary:"Successful",detail:"Função Deletada",life:3e3}),p.value=!1,f(),i.value=0,g()}catch{F.add({severity:"error",summary:"Error",detail:"Erro ao deletar a função",life:3e3})}finally{l.value=!1}i.value=0},z=async()=>{l.value=!0;const t={...a};try{const e=await b.post("/funcao/atualizar",t,{headers:{Authorization:`Bearer ${r.token}`}});f(),i.value=0,g()}catch(e){console.error("Erro ao atualizar Funções e Diretorias:",e)}finally{l.value=!1}};O(i,(t,e)=>{t!==e&&t===0&&(g(),f(),m.value=!1)});const g=()=>{a.id_funcao="",a.nome="",a.id_centro_custo=""},j=async t=>{await E(t)},U=async()=>{l.value=!0;const t={id_cliente:r.userIdCliente};try{const e=await b.post("/cdc/listar",t,{headers:{Authorization:`Bearer ${r.token}`}});S.value=[D,...e.data.map(({ID_CentroCusto:_,Nome:x})=>({label:`DM  ${x}`,value:_}))]}catch(e){console.error("Erro ao listar centros de custo:",e)}finally{l.value=!1}};return G(()=>{f(),U()}),(t,e)=>{const _=c("Column"),x=c("DataTable"),B=c("TabPanel"),I=c("InputText"),L=c("Dropdown"),y=c("Button"),q=c("Dialog"),M=c("TabView");return h(),H("div",W,[n(M,{activeIndex:i.value,"onUpdate:activeIndex":e[7]||(e[7]=s=>i.value=s)},{default:u(()=>[n(B,{header:"Listar Funções"},{default:u(()=>[o("div",X,[n(x,{value:V.value,selectionMode:"single",tableStyle:"min-width: 25%",stripedRows:"",dataKey:"id",metaKeySelection:!1,onRowSelect:j},{empty:u(()=>[k(" Nenhuma Função adicionada. ")]),default:u(()=>[n(_,{field:"id_funcao",header:"Código"}),n(_,{field:"nome",header:"Função (Nome)"}),n(_,{field:"id_centro_custo",header:"Centro de Custo (Nome)"})]),_:1},8,["value"])])]),_:1}),n(B,{header:"Adicionar Função",activeIndex:i.value,"onUpdate:activeIndex":e[6]||(e[6]=s=>i.value=s)},{default:u(()=>[o("div",Y,[o("div",Z,[o("div",ee,[o("form",{onSubmit:J($,["prevent"])},[o("div",oe,[o("div",te,[ae,n(I,{class:"my-2",id:"id_funcao",modelValue:d(a).codigo,"onUpdate:modelValue":e[0]||(e[0]=s=>d(a).codigo=s),required:""},null,8,["modelValue"])]),o("div",se,[ne,n(I,{class:"my-2",id:"nome",modelValue:d(a).nome,"onUpdate:modelValue":e[1]||(e[1]=s=>d(a).nome=s),required:""},null,8,["modelValue"])]),o("div",le,[ie,n(L,{class:"drop",modelValue:d(a).id_centro_custo,"onUpdate:modelValue":e[2]||(e[2]=s=>d(a).id_centro_custo=s),options:S.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref:"dropdown3"},null,8,["modelValue","options"])])]),o("div",re,[m.value?(h(),w(y,{key:0,style:{width:"15%"},class:"flex align-items-center justify-content-center m-2 mr-0",label:"Salvar",icon:"pi pi-check",severity:"primary",onClick:z})):C("",!0),m.value?(h(),w(y,{key:1,style:{width:"15%"},class:"flex align-items-center justify-content-center m-2 mr-0",label:"Excluir",icon:"pi pi-trash",severity:"danger",onClick:e[3]||(e[3]=s=>p.value=!0)})):C("",!0),m.value?C("",!0):(h(),w(y,{key:2,style:{width:"15%"},class:"flex align-items-center justify-content-center m-2 mr-0",label:"Salvar",icon:"pi pi-check",severity:"info",onClick:T}))])],32)]),ce,n(q,{header:"Deletar Função",visible:p.value,"onUpdate:visible":e[5]||(e[5]=s=>p.value=s),style:{width:"400px"},modal:!0,closable:!1},{footer:u(()=>[n(y,{label:"Não",icon:"pi pi-times",onClick:e[4]||(e[4]=s=>p.value=!1),class:"p-button-text"}),n(y,{label:"Sim",icon:"pi pi-check",onClick:A,class:"p-button-text"})]),default:u(()=>[o("div",de,[ue,o("span",me,[k(" Você tem certeza que deseja deletar essa função? "),o("b",null,N(d(a).id_funcao),1),k(" - "),o("b",null,N(d(a).nome),1),k(" ?")])])]),_:1},8,["visible"])])])]),_:1},8,["activeIndex"])]),_:1},8,["activeIndex"]),l.value?(h(),w(Q,{key:0})):C("",!0)])}}};export{ye as default};
