import{H as A}from"./vue-datepicker-7654ddb0.js";import{e as X,s as Z,r,n as ee,g as c,o as D,c as F,d as t,h as s,x as U,a as z,w as p,y as oe,l as m,i as E,t as ae,z as le}from"./index-8679b923.js";/* empty css             */const te={class:"card vh"},se={class:"form"},ne={class:"grid mt-3 mx-1 px-1"},re=t("h5",{class:"my-4 text-2xl"},"Histórico de Abastecimento",-1),de={key:0,class:"p-0 m-0 p-fluid formgrid grid col-12"},ie={class:"field lg:col-3 md:col-6 sm:col-6"},ce=t("label",{for:"dm"},"DM:",-1),ue={class:"field lg:col-3 md:col-6 sm:col-6"},pe=t("label",{for:"planta"},"Planta:",-1),_e={class:"field lg:col-3 md:col-6 sm:col-6"},me=t("label",{for:"perfil"},"Setor:",-1),ve={class:"field lg:col-3 md:col-6 sm:col-6"},fe=t("label",{for:"perfil"},"Centro de Custo:",-1),he={class:"field lg:col-3 md:col-6 sm:col-6"},be=t("label",{for:"perfil"},"Operador:",-1),ye={class:"field lg:col-3 md:col-6 sm:col-6"},Ve=t("label",{for:"perfil"},"Data Inicial:",-1),we={class:"field lg:col-3 md:col-6 sm:col-6"},ge=t("label",{for:"perfil"},"Data Final:",-1),De={class:"field lg:col-3 md:col-6 sm:col-6"},Ie={class:"datatable-wrapper"},ke={class:"flex justify-content-end"},Ce=t("i",{class:"pi pi-search"},null,-1),Te={__name:"historicosabastecimento",setup(Be){const d=X();Z();const h=r(null),b=r(null),y=r(null),V=r(null),w=r(null),I=r([]),i={label:"Todos",value:null},k=r(null),C=r([i]),B=r([i]),x=r([i]),M=r([i]),v=r({global:{value:null,matchMode:le.CONTAINS}}),g=r(!0),O=r([]),o=r({dm:"",id_planta:"",id_centro_custo:"",id_setor:"",id_operador:"",data_inicio:"",data_final:""}),T=l=>{const e=l.getDate(),a=l.getMonth()+1,u=l.getFullYear();return`${e}/${a}/${u}`},$=l=>l?new Date(l).toISOString():null,N=async()=>{const l={id_cliente:d.userIdCliente,id_dm:o.value.dm===null?void 0:o.value.dm,id_planta:o.value.id_planta===null?void 0:o.value.id_planta,id_centro_custo:o.value.id_centro_custo===null?void 0:o.value.id_centro_custo,id_setor:o.value.id_setor===null?void 0:o.value.id_setor,id_funcionario:o.value.id_funcionario===null?void 0:o.value.id_funcionario,data_inicio:$(o.value.data_inicio),data_final:$(o.value.data_final),id_operador:o.value.id_operador};try{const e=await m.post("",l,{headers:{Authorization:`Bearer ${d.token}`}});I.value=e.data}catch(e){console.error("Erro ao buscar histórico:",e)}},L=()=>{g.value=!0,O.value={}},P=r(null),H=async()=>{const l={id_cliente:d.userIdCliente};try{const e=await m.get("",{params:l,headers:{Authorization:`Bearer ${d.token}`}});C.value=[i,...e.data.map(({id_dm:a})=>({label:`DM  ${a}`,value:a}))]}catch(e){console.error("Erro ao carregar lista de dms:",e)}},Q=async()=>{const l={id_cliente:d.userIdCliente};try{const e=await m.post("",l,{headers:{Authorization:`Bearer ${d.token}`}});B.value=[i,...e.data.map(({id_planta:a})=>({label:`Planta  ${a}`,value:a}))]}catch(e){console.error("Erro ao buscar opções de plantas:",e)}},R=async()=>{const l={id_cliente:d.userIdCliente};try{const e=await m.post("",l,{headers:{Authorization:`Bearer ${d.token}`}});x.value=[i,...e.data.map(({id_setor:a})=>({label:`Setor  ${a}`,value:a}))]}catch(e){console.error("Erro ao buscar setores/diretorias:",e)}},j=async()=>{const l={id_cliente:d.userIdCliente};try{const e=await m.post("",l,{headers:{Authorization:`Bearer ${d.token}`}});M.value=e.data.map(({id_centro_custo:a})=>({label:`Centro de Custo  ${a}`,value:a}))}catch(e){console.error("Erro ao buscar centros de custo:",e)}},G=async()=>{const l={id_cliente:d.userIdCliente};try{const e=await m.post("",l,{headers:{Authorization:`Bearer ${d.token}`}});k.value=[i,...e.data.map(a=>({label:a.nome,value:a.id_operador}))]}catch(e){console.error("Erro ao carregar usuários:",e)}},Y=()=>{var l,e,a,u,f;(l=h.value)!=null&&l.overlayVisible&&h.value.hide(),(e=b.value)!=null&&e.overlayVisible&&b.value.hide(),(a=y.value)!=null&&a.overlayVisible&&y.value.hide(),(u=V.value)!=null&&u.overlayVisible&&V.value.hide(),(f=w.value)!=null&&f.overlayVisible&&w.value.hide()},S=()=>{Y()};return ee(()=>{H(),Q(),R(),G(),j()}),(l,e)=>{const a=c("Dropdown"),u=c("Button"),f=c("InputIcon"),q=c("InputText"),J=c("IconField"),_=c("Column"),K=c("DataTable"),W=c("Card");return D(),F("div",te,[t("div",se,[t("div",ne,[re,g.value?(D(),F("div",de,[t("div",ie,[ce,s(a,{class:"drop",modelValue:o.value.dm,"onUpdate:modelValue":e[0]||(e[0]=n=>o.value.dm=n),options:C.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown1",ref:h},null,8,["modelValue","options"])]),t("div",ue,[pe,s(a,{class:"drop",modelValue:o.value.id_planta,"onUpdate:modelValue":e[1]||(e[1]=n=>o.value.id_planta=n),options:B.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown2",ref:b},null,8,["modelValue","options"])]),t("div",_e,[me,s(a,{class:"drop",modelValue:o.value.id_setor,"onUpdate:modelValue":e[2]||(e[2]=n=>o.value.id_setor=n),options:x.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown3",ref:y},null,8,["modelValue","options"])]),t("div",ve,[fe,s(a,{class:"drop",modelValue:o.value.id_centro_custo,"onUpdate:modelValue":e[3]||(e[3]=n=>o.value.id_centro_custo=n),options:M.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown4",ref:V},null,8,["modelValue","options"])]),t("div",he,[be,s(a,{class:"drop",modelValue:o.value.id_operador,"onUpdate:modelValue":e[4]||(e[4]=n=>o.value.id_operador=n),options:k.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown5",ref:w},null,8,["modelValue","options"])]),t("div",ye,[Ve,s(U(A),{class:"drop",modelValue:o.value.data_inicio,"onUpdate:modelValue":e[5]||(e[5]=n=>o.value.data_inicio=n),showIcon:"",showOnFocus:!1,format:T,locale:"pt-BR","auto-apply":"","enable-time-picker":!1,onOpen:S,placeholder:"Selecione uma data inicial"},null,8,["modelValue"])]),t("div",we,[ge,s(U(A),{class:"drop",modelValue:o.value.data_final,"onUpdate:modelValue":e[6]||(e[6]=n=>o.value.data_final=n),showIcon:"",showOnFocus:!1,format:T,locale:"pt-BR","auto-apply":"","enable-time-picker":!1,onOpen:S,placeholder:"Selecione uma data final"},null,8,["modelValue"])]),t("div",De,[s(u,{class:"filtrar",type:"button",label:"Filtrar Dados",icon:"pi pi-search",severity:"info",onClick:N})])])):z("",!0),t("div",Ie,[s(K,{filters:v.value,"onUpdate:filters":e[8]||(e[8]=n=>v.value=n),value:I.value,stripedRows:"",showGridlines:"",paginator:"",rows:10,rowsPerPageOptions:[5,10,20,50],rowHover:"",globalFilterFields:["ID_DM","Data","operador","item","Quantidade","Mola"],tableStyle:{width:"100%"},ref_key:"dt",ref:P},{header:p(()=>[t("div",ke,[s(J,{iconPosition:"left"},{default:p(()=>[s(f,null,{default:p(()=>[Ce]),_:1}),s(q,{modelValue:v.value.global.value,"onUpdate:modelValue":e[7]||(e[7]=n=>v.value.global.value=n),placeholder:"Busca"},null,8,["modelValue"])]),_:1})])]),empty:p(()=>[E(" Nenhum abastecimento encontrado ")]),default:p(()=>[s(_,{field:"ID_DM",sortable:"",header:"DM"}),s(_,{field:"Data",sortable:"",header:"Data"}),s(_,{field:"operador",sortable:"",header:"Operador"}),s(_,{field:"item",sortable:"",header:"Item"}),s(_,{field:"Quantidade",sortable:"",header:"Quantidade",class:"text-center"}),s(_,{field:"Mola",sortable:"",header:"Mola"})]),_:1},8,["filters","value"])]),g.value?z("",!0):(D(),oe(W,{key:1},{title:p(()=>[E(ae(O.value.dm),1)]),content:p(()=>[s(u,{type:"button",label:"Voltar",icon:"pi pi-check",severity:"info",onClick:L})]),_:1}))])])])}}};export{Te as default};
