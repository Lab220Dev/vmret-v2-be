import{e as le,s as se,r as d,m as ie,A as ne,n as de,g as u,o as S,c as re,h as i,w as y,y as E,a as U,l as h,d as a,x as n,i as _,t as K}from"./index-1ab4de76.js";/* empty css             */import{i as A,_ as T}from"./ImageUpload-cfd80793.js";import{L as ce}from"./LoadingSpinner-b57db0d7.js";const ue={class:"card vh"},me={class:"col-12"},pe=["src"],_e={class:"grid"},ve={class:"col-12"},fe={class:"card"},ge={class:"p-fluid formgrid grid m-0 p-0"},ye={class:"full lg:col-6 md:col-6 sm:col-6"},he=a("label",{for:"codigo"},"SKU:",-1),be={class:"full lg:col-6 md:col-6 sm:col-6"},we=a("label",{for:"nome"},"Nome:",-1),xe={class:"full lg:col-6 md:col-6 sm:col-6"},$e=a("label",{for:"nome"},"Descrição:",-1),Ie={class:"full lg:col-6 md:col-6 sm:col-6"},Ve=a("label",{for:"codigo"},"Especificação:",-1),Pe={class:"full lg:col-6 md:col-6 sm:col-6"},Se=a("label",{for:"tipo"},"Tipo:",-1),Ae={class:"full lg:col-6 md:col-6 sm:col-6"},ke=a("label",{for:"tipo"},"Planta:",-1),De={class:"full med lg:col-6 md:col-6 sm:col-6"},Ee=a("label",{for:"UndMedida"},"Unidade de Medida:",-1),Ue={class:"full lg:col-6 md:col-6 sm:col-6"},Ce=a("label",{for:"vldDias"},"Validade:",-1),Te={class:"card p-0 col-12",style:{width:"100%"}},ze={class:"p-fluid grid flex-wrap col-12 my-4 p-0 mx-0"},Be={class:"full lg:col-4 md:col-4 col-12 my-4 mx-0 p-0 text-center"},Fe=a("h4",{class:"titulo"},[_("Imagem"),a("br"),_("Principal:")],-1),Ne={class:"full lg:col-4 md:col-4 col-12 my-4 mx-0 p-0 text-center"},je=a("h4",{class:"titulo"},[_("Imagem"),a("br"),_("Secundária:")],-1),Le={class:"full lg:col-4 md:col-4 col-12 my-4 mx-0 p-0 text-center"},qe=a("h4",{class:"titulo"},[_("Informações"),a("br"),_("Adicionais:")],-1),Me={class:"mt-7 grid justify-content-end flex-wrap"},Ke={class:"confirmation-content"},Oe=a("i",{class:"pi pi-exclamation-triangle mr-1",style:{"font-size":"2rem"}},null,-1),Re={class:""},Xe={__name:"produtos",setup(Ge){const r=le(),b=se(),c=d(0),m=d(!1);let z=d([]),B=d([]);const O=d([{label:"EPI",value:1},{label:"Insumo",value:2},{label:"Consumivel",value:3}]),g=d(null),x=d(null),v=d([]),F=d(""),N=d([]),j=d(""),C=d([]),$=d(!1),I=d(!1),R=o=>{v.value.push(o)},G=o=>{g.value=o},H=o=>{x.value=o};let t=ie({codigo:"",id_planta:"",id_tipoProduto:"",id_categoria:71,nome:"",descricao:" ",unidade_medida:"",validadedias:""});const L=async(o,e)=>{o?e.value=await q(o):e.value=null},J=async o=>{t=o.data;const{imagem2:e,imagem3:l,imagem4:p}=t,f=[e,l,p].filter(D=>D!=="");await L(t.imagem1,F),await L(t.imagemdetalhe,j);const V=await Z(f);N.value=V,I.value=!0,c.value=1,w()},w=async()=>{const o={id_cliente:r.userIdCliente};try{m.value=!0;const e=await h.post("/produtos/listar",o,{headers:{Authorization:`Bearer ${r.token}`}});C.value=e.data,C.value.forEach(async l=>{l.imagemUrl=await q(l.imagem1)})}catch(e){console.error("Erro ao carregar produtos:",e)}finally{m.value=!1}},Q=async()=>{const o={id_cliente:r.userIdCliente};try{z=(await h.post("produtos/listarplanta",o,{headers:{Authorization:`Bearer ${r.token}`}})).data,B=z.map(l=>({label:`Planta ${l.id_planta}`,value:l.id_planta}))}catch(e){console.error("Erro ao buscar opções de plantas:",e)}},W=async()=>{const o=new FormData;if(g.value){const e=`produto_${t.nome}_${t.codigo}_Princ${Date.now()}.png`;o.append("imagem1",e),o.append("file_principal",g.value)}if(x.value){const e=`produto_${t.nome}_${t.codigo}_info${Date.now()}.png`;o.append("imagemdetalhe",e),o.append("file_info",g.value)}v.value&&Array.isArray(v.value)&&v.value.forEach((e,l)=>{const p=e.name.split(".").pop(),f=`produto_${t.nome}_${t.codigo}_Sec${l}.${p}`;o.append(`file_secundario_${l}`,e),o.append(`imagem${l+2}`,f)}),Object.entries(t).forEach(([e,l])=>{o.append(e,l)}),o.append("id_cliente",r.userIdCliente);try{m.value=!0,await h.post("/produtos/adicionar",o,{headers:{Authorization:`Bearer ${r.token}`,"Content-Type":"multipart/form-data"}}),b.add({severity:"success",summary:"Successful",detail:"Produto cadastrado",life:3e3}),w(),c.value=0,k()}catch(e){console.error("Erro ao adicionar o produto:",e),b.add({severity:"error",summary:"Error",detail:"erro ao criar o produto",life:3e3})}finally{m.value=!1}c.value=0},X=async()=>{let o={id_produto:t.id_produto};try{m.value=!0,await h.post("/produtos/deleteProduto",o,{headers:{Authorization:`Bearer ${r.token}`}}),b.add({severity:"success",summary:"Successful",detail:"Produto Deletado",life:3e3}),$.value=!1,w(),c.value=0,k()}catch{b.add({severity:"error",summary:"Error",detail:"Erro ao deletar o produto",life:3e3})}finally{m.value=!1}c.value=0},Y=async()=>{const o=new FormData;Object.entries(t).forEach(([e,l])=>{o.append(e,l)}),g.value&&(o.append("imagem1",`produto_${t.nome}_${t.codigo}_Princ${Date.now()}.png`),o.append("file_principal",g.value)),x.value&&(o.append("imagemdetalhe",`produto_${t.nome}_${t.codigo}_info${Date.now()}.png`),o.append("file_info",x.value)),v.value&&Array.isArray(v.value)&&v.value.forEach((e,l)=>{const p=e.name.split(".").pop(),f=`produto_${t.nome}_${t.codigo}_Sec${l}.${p}`;o.append(`file_secundario_${l}`,e),o.append(`imagem${l+2}`,f)});try{m.value=!0,await h.post("/produtos/atualizar",o,{headers:{Authorization:`Bearer ${r.token}`,"Content-Type":"multipart/form-data"}}),b.add({severity:"success",summary:"Successful",detail:"Produto atualizado",life:3e3}),w(),c.value=0,k()}catch(e){console.error("Erro ao atualizar o produto:",e),b.add({severity:"error",summary:"Error",detail:"Erro ao atualizar o produto",life:3e3})}finally{m.value=!1}},q=async o=>{if(o==="")return A;try{const e=await h.get(`/image/produto/${r.userIdCliente}/${o}`,{headers:{Authorization:`Bearer ${r.token}`}});if(e.status===200){const{image:l,mimeType:p}=e.data;return`data:${p};base64,${l}`}}catch{return A}},Z=async o=>{if(!Array.isArray(o)||o.length===0)return o.map(()=>A);try{return(await h.post("image/produtos/imagesAdicionais",{idcliente:r.userIdCliente,imageNames:o},{headers:{Authorization:`Bearer ${r.token}`}})).data.map(l=>l!==""?l:A)}catch(e){return console.error("Erro ao buscar imagens:",e),o.map(()=>A)}};ne(c,(o,e)=>{o!==e&&o===0&&(k(),w(),I.value=!1)});const k=()=>{t={codigo:"",id_planta:"",id_tipoProduto:"",id_categoria:71,nome:"",descricao:" ",unidade_medida:"",validadedias:"",imagem1:"",imagem2:"",imagem3:"",imagem4:"",imagemdetalhe:""},g.value=null,x.value=null,v.value=[]},ee=async o=>{await J(o)};return de(async()=>{await w(),await Q()}),(o,e)=>{const l=u("Column"),p=u("DataTable"),f=u("TabPanel"),V=u("InputText"),D=u("Textarea"),M=u("Dropdown"),oe=u("InputNumber"),P=u("Button"),ae=u("Dialog"),te=u("TabView");return S(),re("div",ue,[i(te,{activeIndex:c.value,"onUpdate:activeIndex":e[12]||(e[12]=s=>c.value=s)},{default:y(()=>[i(f,{header:"Listar Produtos"},{default:y(()=>[a("div",me,[i(p,{value:C.value,selectionMode:"single",stripedRows:"",dataKey:"id",metaKeySelection:!1,onRowSelect:ee},{default:y(()=>[i(l,{header:"Imagem",class:"col-3"},{body:y(s=>[a("div",null,[a("img",{src:s.data.imagemUrl,alt:"Imagem do Produto",class:"w-6rem border-round"},null,8,pe)])]),_:1}),i(l,{field:"codigo",header:"SKU",class:"col-2"}),i(l,{field:"nome",header:"Nome",class:"col-7"})]),_:1},8,["value"])])]),_:1}),i(f,{header:"Adicionar Produto",activeIndex:c.value,"onUpdate:activeIndex":e[11]||(e[11]=s=>c.value=s)},{default:y(()=>[a("div",_e,[a("div",ve,[a("div",fe,[a("div",ge,[a("div",ye,[he,i(V,{class:"my-2",modelValue:n(t).codigo,"onUpdate:modelValue":e[0]||(e[0]=s=>n(t).codigo=s),id:"codigo",type:"text"},null,8,["modelValue"])]),a("div",be,[we,i(V,{class:"my-2",modelValue:n(t).nome,"onUpdate:modelValue":e[1]||(e[1]=s=>n(t).nome=s),id:"nome",type:"text"},null,8,["modelValue"])]),a("div",xe,[$e,i(D,{modelValue:n(t).descricao,"onUpdate:modelValue":e[2]||(e[2]=s=>n(t).descricao=s),class:"my-2 overflow-scroll",rows:"5",cols:"30"},null,8,["modelValue"])]),a("div",Ie,[Ve,i(D,{modelValue:n(t).especificacoes,"onUpdate:modelValue":e[3]||(e[3]=s=>n(t).especificacoes=s),class:"my-2 overflow-scroll",rows:"5",cols:"30"},null,8,["modelValue"])]),a("div",Pe,[Se,i(M,{class:"my-2",modelValue:n(t).id_tipoProduto,"onUpdate:modelValue":e[4]||(e[4]=s=>n(t).id_tipoProduto=s),options:O.value,optionLabel:"label",optionValue:"value",placeholder:"Selecione um tipo"},null,8,["modelValue","options"])]),a("div",Ae,[ke,i(M,{class:"my-2",modelValue:n(t).id_planta,"onUpdate:modelValue":e[5]||(e[5]=s=>n(t).id_planta=s),options:n(B),optionLabel:"label",optionValue:"value",placeholder:"Selecione uma planta"},null,8,["modelValue","options"])]),a("div",De,[Ee,i(V,{class:"my-2",modelValue:n(t).unidade_medida,"onUpdate:modelValue":e[6]||(e[6]=s=>n(t).unidade_medida=s),id:"UndMedida",type:"text"},null,8,["modelValue"])]),a("div",Ue,[Ce,i(oe,{class:"my-2",modelValue:n(t).validadedias,"onUpdate:modelValue":e[7]||(e[7]=s=>n(t).validadedias=s),inputId:"vldDias",suffix:" dias"},null,8,["modelValue"])])])]),a("div",Te,[a("div",ze,[a("div",Be,[Fe,i(T,{onFileSelected:G,externalImages:F.value,multiple:!1},null,8,["externalImages"])]),a("div",Ne,[je,i(T,{onFileSelected:R,externalImages:N.value,multiple:!0},null,8,["externalImages"])]),a("div",Le,[qe,i(T,{onFileSelected:H,externalImages:j.value,multiple:!1},null,8,["externalImages"])])])])])]),a("div",Me,[I.value?(S(),E(P,{key:0,style:{width:"15%"},class:"flex align-items-center justify-content-center m-2",label:"Atualizar",icon:"pi pi-refresh",severity:"primary",onClick:Y})):U("",!0),I.value?(S(),E(P,{key:1,style:{width:"15%"},class:"flex align-items-center justify-content-center m-2",label:"Excluir",icon:"pi pi-trash",severity:"danger",onClick:e[8]||(e[8]=s=>$.value=!0)})):U("",!0),I.value?U("",!0):(S(),E(P,{key:2,style:{width:"15%"},class:"mr-6 flex align-items-center justify-content-center m-2",label:"Salvar",icon:"pi pi-check",severity:"info",onClick:W}))]),i(ae,{header:"Deletar Produto",visible:$.value,"onUpdate:visible":e[10]||(e[10]=s=>$.value=s),style:{width:"400px"},modal:!0,closable:!1},{footer:y(()=>[i(P,{label:"Não",icon:"pi pi-times",onClick:e[9]||(e[9]=s=>$.value=!1),class:"p-button-text"}),i(P,{label:"Sim",icon:"pi pi-check",onClick:X,class:"p-button-text"})]),default:y(()=>[a("div",Ke,[Oe,a("span",Re,[_(" Você tem certeza que deseja deletar o produto "),a("b",null,K(n(t).id_produto),1),_(" - "),a("b",null,K(n(t).nome),1),_(" ?")])])]),_:1},8,["visible"])]),_:1},8,["activeIndex"])]),_:1},8,["activeIndex"]),m.value?(S(),E(ce,{key:0})):U("",!0)])}}};export{Xe as default};
