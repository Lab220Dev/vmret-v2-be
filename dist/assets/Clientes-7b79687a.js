import{r as f,e as K,m as H,q as J,C as Y,s as G,g as r,o as V,c as Q,h as a,w as i,z as T,a as A,l as S,d as t,U as W,i as g,t as y,k as X,y as n,A as Z}from"./index-7226cd4f.js";import{L as ee}from"./LoadingSpinner-6fe77d13.js";/* empty css                                                       */const te={class:"card"},le={class:"col-12"},oe={class:"flex justify-content-end"},ae=t("i",{class:"pi pi-search"},null,-1),se={class:"grid"},ie={class:"col-12"},ne={class:"card"},re={class:"p-fluid formgrid grid m-0 p-0"},ce={class:"full mt-5 xl:col-6 lg:col-12 md:col-12 sm:col-12"},de={class:""},ue=t("label",{for:"id_planta"},"Nome:",-1),me={class:"mt-4"},pe=t("label",{for:"cpfcnpj"},"CNPJ/CPF:",-1),fe={class:"flex justify-center mt-5"},ve={class:"full flex flex-column align-items-center xl:col-6 lg:col-6 md:col-6 sm:col-12"},_e=t("label",{class:"mt-0 text-nowrap",for:"switch1"},"Tem integração?",-1),he={class:"grid mt-3"},ge={class:"ml-2"},ye={class:"full flex flex-column align-items-center xl:col-6 lg:col-6 md:col-6 sm:col-12"},we=t("label",{class:"mt-0 text-nowrap",for:"switch2"},"Cliente Ativo?",-1),xe={class:"grid mt-3"},be={class:"ml-2"},Ce={class:"full xl:col-6 lg:col-12 md:col-12 sm:col-12"},Ve=t("label",{for:"codigo"},"Menção Ficha Retirada:",-1),Se=t("div",{class:"full xl:col-4 flex flex-column align-items-center m-0 lg:col-6 md:col-4 sm:col-6"},null,-1),ke={class:"mr-1 mt-8 grid justify-content-end"},De={class:"confirmation-content"},Ie=t("i",{class:"pi pi-exclamation-triangle mr-1",style:{"font-size":"2rem"}},null,-1),Te={class:""},Be={__name:"Clientes",setup(Ae){const u=f(0),w=K(),N=H(),c=f(!1),j=f([]),_=f(!1),x=f(!1),b=f({}),C=f({global:{value:null,matchMode:Z.CONTAINS}});let o=J({nome:"",cpfcnpj:"",ativo:!0,usarApi:!1,textoretirada:""});const U=s=>{o=s.data,u.value=1,_.value=!0,v()},M=()=>{_.value?z():$()},$=async()=>{const s={...o};c.value=!0;try{const e=await S.post("/admin/cliente/adicionar",s,{headers:{Authorization:`Bearer ${w.token}`}});v(),u.value=0,k()}catch(e){console.error("Erro ao adicionar Clientes:",e)}finally{c.value=!1}},E=s=>{b.value=s,x.value=!0},P=async s=>{c.value=!0;let e={id_cliente:s.id_cliente};try{await S.post("/admin/cliente/delete",e,{headers:{Authorization:`Bearer ${w.token}`}}),N.add({severity:"success",summary:"Successful",detail:"Ciente Deletada",life:3e3}),x.value=!1,v()}catch{N.add({severity:"error",summary:"Error",detail:"Erro ao deletar a planta.",life:3e3})}finally{c.value=!1}},z=async()=>{c.value=!0;const s={id_cliente:o.id_cliente,...o};try{const e=await S.post("/admin/cliente/atualizar",s,{headers:{Authorization:`Bearer ${w.token}`}});v(),u.value=0,k()}catch(e){console.error("Erro ao atualizar Plantas:",e)}finally{c.value=!1}};Y(u,(s,e)=>{s!==e&&s===0&&(k(),v(),_.value=!1)});const k=()=>{o.nome="",o.cpfcnpj="",o.ativo=!0,o.created=new Date,o.usarApi=!1,o.textoretirada=""},v=async()=>{c.value=!0;try{const s=await S.post("/admin/cliente/listar",{headers:{Authorization:`Bearer ${w.token}`}});j.value=s.data}catch(s){console.error("Erro ao listar plantas:",s)}finally{c.value=!1}},L=s=>{if(!s)return"";try{const e=new Date(s);if(isNaN(e))throw new Error("Data inválida");const m=new Date(e.getTime()+e.getTimezoneOffset()*6e4),h=String(m.getDate()).padStart(2,"0"),D=String(m.getMonth()+1).padStart(2,"0"),p=m.getFullYear(),d=String(m.getHours()).padStart(2,"0"),I=String(m.getMinutes()).padStart(2,"0");return`${h}/${D}/${p} ${d}:${I}`}catch(e){return console.error("Erro ao formatar data:",e),"Data inválida"}};return G(()=>{v()}),(s,e)=>{const m=r("InputIcon"),h=r("InputText"),D=r("IconField"),p=r("Column"),d=r("Button"),I=r("DataTable"),B=r("TabPanel"),F=r("InputSwitch"),q=r("Textarea"),R=r("TabView"),O=r("Dialog");return V(),Q("div",te,[a(R,{activeIndex:u.value,"onUpdate:activeIndex":e[8]||(e[8]=l=>u.value=l)},{default:i(()=>[a(B,{header:"Listar Clientes"},{default:i(()=>[t("div",le,[a(I,{filters:C.value,"onUpdate:filters":e[1]||(e[1]=l=>C.value=l),value:j.value,selectionMode:"single",tableStyle:"min-width: 25%",rowsPerPageOptions:[5,10,20,50],stripedRows:"",dataKey:"id",metaKeySelection:!1,onRowSelect:U,globalFilterFields:["id_cliente","nome","last_login"]},{header:i(()=>[t("div",oe,[a(D,{iconPosition:"left"},{default:i(()=>[a(m,null,{default:i(()=>[ae]),_:1}),a(h,{modelValue:C.value.global.value,"onUpdate:modelValue":e[0]||(e[0]=l=>C.value.global.value=l),placeholder:"Busca"},null,8,["modelValue"])]),_:1})])]),default:i(()=>[a(p,{field:"id_cliente",header:"Id"}),a(p,{field:"nome",header:"Nome"}),a(p,{field:"ativo",header:"Ativo"},{body:i(({data:l})=>[t("i",{class:W(["pi",{"pi-check-circle text-green-500 ":l.ativo,"pi-times-circle text-red-500":!l.ativo}])},null,2)]),_:1}),a(p,{field:"last_login",header:"Último Login"},{body:i(({data:l})=>[g(y(L(new Date(l.last_login))),1)]),_:1}),a(p,{style:{"min-width":"8rem"}},{body:i(l=>[a(d,{icon:"pi pi-trash",outlined:"",rounded:"",severity:"danger",onClick:Ne=>E(l.data)},null,8,["onClick"])]),_:1})]),_:1},8,["filters","value"])])]),_:1}),a(B,{header:"Adicionar Clientes"},{default:i(()=>[t("div",se,[t("div",ie,[t("div",ne,[t("form",{onSubmit:X(M,["prevent"])},[t("div",re,[t("div",ce,[t("div",de,[ue,g(),a(h,{class:"my-2",id:"id_planta",modelValue:n(o).nome,"onUpdate:modelValue":e[2]||(e[2]=l=>n(o).nome=l),required:""},null,8,["modelValue"])]),t("div",me,[pe,a(h,{class:"my-2",id:"cpfcnpj",modelValue:n(o).cpfcnpj,"onUpdate:modelValue":e[3]||(e[3]=l=>n(o).cpfcnpj=l),required:""},null,8,["modelValue"])]),t("div",fe,[t("div",ve,[_e,t("div",he,[a(F,{class:"mr-2",modelValue:n(o).usarApi,"onUpdate:modelValue":e[4]||(e[4]=l=>n(o).usarApi=l),inputId:"switch1"},null,8,["modelValue"]),t("span",ge,y(n(o).usarApi?"Sim":"Não"),1)])]),t("div",ye,[we,t("div",xe,[a(F,{class:"mr-2",modelValue:n(o).ativo,"onUpdate:modelValue":e[5]||(e[5]=l=>n(o).ativo=l),inputId:"switch2"},null,8,["modelValue"]),t("span",be,y(n(o).ativo?"Sim":"Não"),1)])])])]),t("div",Ce,[Ve,a(q,{style:{overflow:"hidden",height:"100%","min-width":"200px",width:"100%"},modelValue:n(o).textoretirada,"onUpdate:modelValue":e[6]||(e[6]=l=>n(o).textoretirada=l),class:"my-2",rows:"5",cols:"30"},null,8,["modelValue"])]),Se])],32)]),t("div",ke,[_.value?(V(),T(d,{key:0,style:{width:"25%","min-width":"100px"},class:"flex align-items-center justify-content-center m-2 mr-0",label:"Salvar",icon:"pi pi-check",severity:"primary",onClick:z})):A("",!0),a(d,{style:{width:"25%","min-width":"100px"},class:"flex align-items-center justify-content-center m-2 mr-0",label:"Voltar",icon:"pi pi-arrow-left",severity:"primary",onClick:e[7]||(e[7]=l=>u.value=0)}),_.value?A("",!0):(V(),T(d,{key:1,style:{width:"25%","min-width":"100px"},class:"flex align-items-center justify-content-center m-2 mr-0",label:"Salvar",icon:"pi pi-check",severity:"info",onClick:$}))])])])]),_:1})]),_:1},8,["activeIndex"]),a(O,{header:"Deletar Cliente",visible:x.value,"onUpdate:visible":e[11]||(e[11]=l=>x.value=l),style:{width:"400px"},modal:!0,closable:!1},{footer:i(()=>[a(d,{label:"Não",icon:"pi pi-times",onClick:e[9]||(e[9]=l=>s.deleteFuncionarioDialog=!1),class:"p-button-text"}),a(d,{label:"Sim",icon:"pi pi-check",onClick:e[10]||(e[10]=l=>P(b.value)),class:"p-button-text"})]),default:i(()=>[t("div",De,[Ie,t("span",Te,[g(" Você tem certeza que deseja deletar o Cliente "),t("b",null,y(b.value.id_cliente),1),g(" - "),t("b",null,y(b.value.nome),1),g(" ?")])])]),_:1},8,["visible"]),c.value?(V(),T(ee,{key:0})):A("",!0)])}}};export{Be as default};
