import{e as oe,s as ae,r as d,m as le,B as te,n as se,g as u,o as P,c as ie,h as s,w as f,y as S,a as D,l as b,d as a,x as i,i as p,t as O}from"./index-8679b923.js";/* empty css             */import{i as v,_ as F}from"./ImageUpload-9e2c33c8.js";import{L as ne}from"./LoadingSpinner-a3a18303.js";const de={class:"card vh"},re={class:"col-12"},ce=["src"],ue={class:"grid"},me={class:"col-12"},pe={class:"card"},ve={class:"p-fluid formgrid grid m-0 p-0"},_e={class:"full lg:col-6 md:col-6 sm:col-6"},fe=a("label",{for:"codigo"},"SKU:",-1),ge={class:"full lg:col-6 md:col-6 sm:col-6"},ye=a("label",{for:"nome"},"Nome:",-1),he={class:"full lg:col-6 md:col-6 sm:col-6"},be=a("label",{for:"nome"},"Descrição:",-1),we={class:"full lg:col-6 md:col-6 sm:col-6"},xe=a("label",{for:"codigo"},"Especificação:",-1),Ve={class:"full lg:col-6 md:col-6 sm:col-6"},Ie=a("label",{for:"tipo"},"Tipo:",-1),Pe={class:"full lg:col-6 md:col-6 sm:col-6"},$e=a("label",{for:"tipo"},"Planta:",-1),Se={class:"full med lg:col-6 md:col-6 sm:col-6"},De=a("label",{for:"UndMedida"},"Unidade de Medida:",-1),ke={class:"full lg:col-6 md:col-6 sm:col-6"},Ue=a("label",{for:"vldDias"},"Validade:",-1),Ce={class:"card p-0 col-12",style:{width:"100%"}},Ee={class:"p-fluid grid flex-wrap col-12 my-4 p-0 mx-0"},Te={class:"full lg:col-4 md:col-4 col-12 my-4 mx-0 p-0 text-center"},ze=a("h4",{class:"titulo"},[p("Imagem"),a("br"),p("Principal:")],-1),Ae={class:"full lg:col-4 md:col-4 col-12 my-4 mx-0 p-0 text-center"},Be=a("h4",{class:"titulo"},[p("Imagem"),a("br"),p("Secundária:")],-1),Fe={class:"full lg:col-4 md:col-4 col-12 my-4 mx-0 p-0 text-center"},Ne=a("h4",{class:"titulo"},[p("Informações"),a("br"),p("Adicionais:")],-1),je={class:"mt-7 grid justify-content-end flex-wrap"},Le={class:"confirmation-content"},Me=a("i",{class:"pi pi-exclamation-triangle mr-1",style:{"font-size":"2rem"}},null,-1),qe={class:""},Je={__name:"produtos",setup(Ke){const c=oe(),g=ae(),r=d(0),m=d(!1);let N=d([]),j=d([]);const R=d([{label:"EPI",value:1},{label:"Insumo",value:2},{label:"Consumivel",value:3}]),_=d(null),y=d(null),w=d(null),k=d(v),U=d(v),C=d(v),E=d([]),x=d(!1),V=d(!1),T=(o,e)=>{e==="principal"?_.value=o:e==="secundaria"?y.value=o:e==="info"&&(w.value=o)};let l=le({codigo:"",id_planta:"",id_tipoProduto:"",id_categoria:71,nome:"",descricao:" ",unidade_medida:"",validadedias:""});const z=async(o,e)=>{o?e.value=await L(o):e.value=null},G=async o=>{l=o.data,await z(l.imagem1,k),await z(l.imagem2,U),await z(l.imagemdetalhe,C),V.value=!0,r.value=1,h()},h=async()=>{const o={id_cliente:c.userIdCliente};try{m.value=!0;const e=await b.post("/produtos/listar",o,{headers:{Authorization:`Bearer ${c.token}`}});E.value=e.data,E.value.forEach(async n=>{n.imagemUrl=await L(n.imagem1)})}catch(e){console.error("Erro ao carregar produtos:",e)}finally{m.value=!1}},H=async()=>{const o={id_cliente:c.userIdCliente};try{N=(await b.post("produtos/listarplanta",o,{headers:{Authorization:`Bearer ${c.token}`}})).data,j=N.map(n=>({label:`Planta ${n.id_planta}`,value:n.id_planta}))}catch(e){console.error("Erro ao buscar opções de plantas:",e)}},J=async()=>{const o=new FormData;if(_.value){const e=`produto_${l.nome}_${l.codigo}_Princ${Date.now()}.png`;o.append("imagem1",e),o.append("file_principal",_.value)}if(w.value){const e=`produto_${l.nome}_${l.codigo}_info${Date.now()}.png`;o.append("imagemdetalhe",e),o.append("file_info",_.value)}if(y.value){const e=`produto_${l.nome}_${l.codigo}_Sec${Date.now()}.png`;o.append("imagem2",e),o.append("file_secundario",y.value)}Object.entries(l).forEach(([e,n])=>{o.append(e,n)}),o.append("id_cliente",c.userIdCliente);try{m.value=!0,await b.post("/produtos/adicionar",o,{headers:{Authorization:`Bearer ${c.token}`,"Content-Type":"multipart/form-data"}}),g.add({severity:"success",summary:"Successful",detail:"Produto cadastrado",life:3e3}),h(),r.value=0,$()}catch(e){console.error("Erro ao adicionar o produto:",e),g.add({severity:"error",summary:"Error",detail:"erro ao criar o produto",life:3e3})}finally{m.value=!1}r.value=0},Q=async()=>{let o={id_produto:l.id_produto};try{m.value=!0,await b.post("/produtos/deleteProduto",o,{headers:{Authorization:`Bearer ${c.token}`}}),g.add({severity:"success",summary:"Successful",detail:"Produto Deletado",life:3e3}),x.value=!1,h(),r.value=0,$()}catch{g.add({severity:"error",summary:"Error",detail:"Erro ao deletar o produto",life:3e3})}finally{m.value=!1}r.value=0},W=async()=>{const o=new FormData;Object.entries(l).forEach(([e,n])=>{o.append(e,n)}),_.value&&(o.append("imagem1",`produto_${l.nome}_${l.codigo}_Princ${Date.now()}.png`),o.append("file_principal",_.value)),w.value&&(o.append("imagemdetalhe",`produto_${l.nome}_${l.codigo}_info${Date.now()}.png`),o.append("file_info",w.value)),y.value&&(o.append("imagem2",`produto_${l.nome}_${l.codigo}_Sec${Date.now()}.png`),o.append("file_secundario",y.value));try{m.value=!0,await b.post("/produtos/atualizar",o,{headers:{Authorization:`Bearer ${c.token}`,"Content-Type":"multipart/form-data"}}),g.add({severity:"success",summary:"Successful",detail:"Produto atualizado",life:3e3}),h(),r.value=0,$()}catch(e){console.error("Erro ao atualizar o produto:",e),g.add({severity:"error",summary:"Error",detail:"Erro ao atualizar o produto",life:3e3})}finally{m.value=!1}},L=async o=>{if(o==="")return v;try{const e=await b.get(`/image/produto/${c.userIdCliente}/${o}`,{headers:{Authorization:`Bearer ${c.token}`}});if(e.status===200){const{image:n,mimeType:A}=e.data;return`data:${A};base64,${n}`}}catch{return v}};te(r,(o,e)=>{o!==e&&o===0&&($(),h(),V.value=!1)});const $=()=>{l={codigo:"",id_planta:"",id_tipoProduto:"",id_categoria:71,nome:"",descricao:" ",unidade_medida:"",validadedias:"",imagem1:"",imagem2:"",imagem3:"",imagem4:"",imagemdetalhe:""},_.value=null,y.value=null,w.value=null,k.value=v,U.value=v,C.value=v},X=async o=>{await G(o)};return se(async()=>{await h(),await H()}),(o,e)=>{const n=u("Column"),A=u("DataTable"),M=u("TabPanel"),B=u("InputText"),q=u("Textarea"),K=u("Dropdown"),Y=u("InputNumber"),I=u("Button"),Z=u("Dialog"),ee=u("TabView");return P(),ie("div",de,[s(ee,{activeIndex:r.value,"onUpdate:activeIndex":e[15]||(e[15]=t=>r.value=t)},{default:f(()=>[s(M,{header:"Listar Produtos"},{default:f(()=>[a("div",re,[s(A,{value:E.value,selectionMode:"single",stripedRows:"",dataKey:"id",metaKeySelection:!1,onRowSelect:X},{default:f(()=>[s(n,{header:"Imagem",class:"col-3"},{body:f(t=>[a("div",null,[a("img",{src:t.data.imagemUrl,alt:"Imagem do Produto",class:"w-6rem border-round"},null,8,ce)])]),_:1}),s(n,{field:"codigo",header:"SKU",class:"col-2"}),s(n,{field:"nome",header:"Nome",class:"col-7"})]),_:1},8,["value"])])]),_:1}),s(M,{header:"Adicionar Produto",activeIndex:r.value,"onUpdate:activeIndex":e[14]||(e[14]=t=>r.value=t)},{default:f(()=>[a("div",ue,[a("div",me,[a("div",pe,[a("div",ve,[a("div",_e,[fe,s(B,{class:"my-2",modelValue:i(l).codigo,"onUpdate:modelValue":e[0]||(e[0]=t=>i(l).codigo=t),id:"codigo",type:"text"},null,8,["modelValue"])]),a("div",ge,[ye,s(B,{class:"my-2",modelValue:i(l).nome,"onUpdate:modelValue":e[1]||(e[1]=t=>i(l).nome=t),id:"nome",type:"text"},null,8,["modelValue"])]),a("div",he,[be,s(q,{modelValue:i(l).descricao,"onUpdate:modelValue":e[2]||(e[2]=t=>i(l).descricao=t),class:"my-2 overflow-scroll",rows:"5",cols:"30"},null,8,["modelValue"])]),a("div",we,[xe,s(q,{modelValue:i(l).especificacoes,"onUpdate:modelValue":e[3]||(e[3]=t=>i(l).especificacoes=t),class:"my-2 overflow-scroll",rows:"5",cols:"30"},null,8,["modelValue"])]),a("div",Ve,[Ie,s(K,{class:"my-2",modelValue:i(l).id_tipoProduto,"onUpdate:modelValue":e[4]||(e[4]=t=>i(l).id_tipoProduto=t),options:R.value,optionLabel:"label",optionValue:"value",placeholder:"Selecione um tipo"},null,8,["modelValue","options"])]),a("div",Pe,[$e,s(K,{class:"my-2",modelValue:i(l).id_planta,"onUpdate:modelValue":e[5]||(e[5]=t=>i(l).id_planta=t),options:i(j),optionLabel:"label",optionValue:"value",placeholder:"Selecione uma planta"},null,8,["modelValue","options"])]),a("div",Se,[De,s(B,{class:"my-2",modelValue:i(l).unidade_medida,"onUpdate:modelValue":e[6]||(e[6]=t=>i(l).unidade_medida=t),id:"UndMedida",type:"text"},null,8,["modelValue"])]),a("div",ke,[Ue,s(Y,{class:"my-2",modelValue:i(l).validadedias,"onUpdate:modelValue":e[7]||(e[7]=t=>i(l).validadedias=t),inputId:"vldDias",suffix:" dias"},null,8,["modelValue"])])])]),a("div",Ce,[a("div",Ee,[a("div",Te,[ze,s(F,{onFileSelected:e[8]||(e[8]=t=>T(t,"principal")),externalImages:k.value},null,8,["externalImages"])]),a("div",Ae,[Be,s(F,{onFileSelected:e[9]||(e[9]=t=>T(t,"secundaria")),externalImages:U.value},null,8,["externalImages"])]),a("div",Fe,[Ne,s(F,{onFileSelected:e[10]||(e[10]=t=>T(t,"info")),externalImages:C.value},null,8,["externalImages"])])])])])]),a("div",je,[V.value?(P(),S(I,{key:0,style:{width:"15%"},class:"flex align-items-center justify-content-center m-2",label:"Atualizar",icon:"pi pi-refresh",severity:"primary",onClick:W})):D("",!0),V.value?(P(),S(I,{key:1,style:{width:"15%"},class:"flex align-items-center justify-content-center m-2",label:"Excluir",icon:"pi pi-trash",severity:"danger",onClick:e[11]||(e[11]=t=>x.value=!0)})):D("",!0),V.value?D("",!0):(P(),S(I,{key:2,style:{width:"15%"},class:"mr-6 flex align-items-center justify-content-center m-2",label:"Salvar",icon:"pi pi-check",severity:"info",onClick:J}))]),s(Z,{header:"Deletar Produto",visible:x.value,"onUpdate:visible":e[13]||(e[13]=t=>x.value=t),style:{width:"400px"},modal:!0,closable:!1},{footer:f(()=>[s(I,{label:"Não",icon:"pi pi-times",onClick:e[12]||(e[12]=t=>x.value=!1),class:"p-button-text"}),s(I,{label:"Sim",icon:"pi pi-check",onClick:Q,class:"p-button-text"})]),default:f(()=>[a("div",Le,[Me,a("span",qe,[p(" Você tem certeza que deseja deletar o produto "),a("b",null,O(i(l).id_produto),1),p(" - "),a("b",null,O(i(l).nome),1),p(" ?")])])]),_:1},8,["visible"])]),_:1},8,["activeIndex"])]),_:1},8,["activeIndex"]),m.value?(P(),S(ne,{key:0})):D("",!0)])}}};export{Je as default};
