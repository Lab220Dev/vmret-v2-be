import{r as d,m as ce,e as ue,q as me,C as pe,s as ve,l as _,g as m,o as y,c as Y,d as o,z as D,w as r,a as V,h as t,F as fe,U as he,i as _e,t as U,y as i,A as ye}from"./index-7226cd4f.js";import{L as be}from"./LoadingSpinner-6fe77d13.js";/* empty css                                                       */const Ve={class:"grid h-full"},ge={class:"col-12"},we={class:"card"},Ce=o("h5",{class:"mt-2"},"Dispenser Machines",-1),De={class:"col-12"},Me={class:"flex justify-content-end"},Ie=o("i",{class:"pi pi-search"},null,-1),ke={class:"mt-2"},Se={class:"mt-5 mx-0 p-fluid grid"},xe={class:"full lg:col-12 md:col-12 sm:col-12"},Pe=o("label",{for:"name"},"Cliente:",-1),Ue={class:"full lg:col-6 md:col-9 sm:col-12"},Ae=o("label",{for:"email"},"Numero da DM:",-1),$e={class:"full lg:col-6 md:col-9 sm:col-12"},Ne=o("label",{for:"email"},"Identificação da DM:",-1),Be={class:"full lg:col-12 md:col-4 sm:col-12"},Te=o("label",{class:"mt-3 ml-4",for:"switch2"},"DM Ativo?",-1),ze=o("h5",{class:"mt-2"},"Opções de DM",-1),Ee={class:"mt-5 mx-0 p-fluid grid"},Fe=o("label",{for:"fim"},null,-1),Oe={id:"fim",class:"checkbox-container flex align-content-end flex-wrap"},Le={class:"checkbox-items m-2 flex align-items-end"},Re=o("label",{for:"Voucher",class:"ml-2"}," Voucher ",-1),Ke={class:"checkbox-items m-2 flex align-items-center"},je=o("label",{for:"cracha",class:"ml-2"}," Crachá ",-1),qe={class:"checkbox-items m-2 flex align-items-center"},Qe=o("label",{for:"Biometria",class:"ml-2"}," Biometria ",-1),He={class:"checkbox-items m-2 flex align-items-center"},Ye=o("label",{for:"Facial",class:"ml-2"}," Rec. Facial ",-1),Ge={class:"full lg:col-12 md:col-4 sm:col-12"},Je=o("label",{class:"mt-3 ml-4",for:"switch3"},"Usa Mob?",-1),We={class:"full lg:col-6 md:col-6 sm:col-12"},Xe=o("label",{for:"senha"},"UserID API:",-1),Ze={class:"full lg:col-6 md:col-6 sm:col-12"},eo=o("label",{for:"senha"},"Senha API:",-1),oo={class:"full lg:col-6 md:col-6 sm:col-12"},lo=o("label",{for:"senha"},"IdCliente API:",-1),to={class:"full lg:col-6 md:col-6 sm:col-6"},ao=o("label",{for:"codigo"},"Senha Chave:",-1),so={class:"flex align-items-center justify-content-end field col-12"},io=o("h5",{class:"mt-2"},"Controladoras",-1),no={class:"mt-5 mx-0 p-fluid grid"},ro={class:"col-12"},co={class:"flex align-items-center justify-content-end field col-12"},uo={key:1,class:"card"},mo=o("h5",{class:"mt-2"},"Itens da DM",-1),po={class:"mt-5 mx-0 p-fluid grid"},vo={class:"lg:col-12 md:col-12 sm:col-12"},fo={class:"card"},ho={class:"col-12 grid"},_o={class:""},yo=o("label",{for:"Produto",class:"font-semibold col-4"},"Produto: ",-1),bo={class:"my-5"},Vo=o("label",{for:"Porta",class:"font-semibold w-6rem col-4"},"Porta: ",-1),go={class:"mb-5"},wo=o("label",{for:"Controladora",class:"font-semibold w-6rem col-4 pr-0"},"Controladora: ",-1),Co={class:"mb-5"},Do=o("label",{for:"Mola",class:"font-semibold w-6rem col-4"},"Motor 1: ",-1),Mo={class:""},Io=o("label",{for:"Mola2",class:"font-semibold w-6rem col-4"},"Motor 2: ",-1),ko={class:"flex justify-content-end gap-2"},Ao={__name:"DM",setup(So){const A=d(""),b=d(null),z=ce(),g=d(0),v=ue(),p=d(!1);let s=me({Ativo:"",Chave:"",ClienteID:"",ClienteNome:"",Created:"",Enviada:"",ID_CR_Usuario:"",ID_DM:"",IDcliente:"",Identificacao:"",Integracao:"",Numero:"",OP_Biometria:"",OP_Facial:"",OP_Senha:"",URL:"",Updated:"",UserID:"",Versao:""});const $=d(!1),G=d(!1),M=d(!1),I=d(!1),E=d([]);d([]);const F=d([]),k=d(!1),O=d([]),S=d({global:{value:null,matchMode:ye.CONTAINS}}),f=d({id_produto:"",Porta:"",Motor1:"",Motor2:"",Controladora:""}),L=d([]),R={label:"Todos",value:null},J=d([R]),W=async()=>{p.value=!0;let a=null;B?a="":(a={},a.id_cliente=v.userIdCliente);try{const e=await _.post("/DM/listar",a,{headers:{Authorization:`Bearer ${v.token}`}});L.value=e.data}catch(e){console.error("Erro ao carregar usuários:",e)}finally{p.value=!1}},K=async a=>{A.value=`Você tem certeza que deseja excluir o item ${a.Nome_Produto}?`,M.value=!0,b.value=a},X=async()=>{if(b.value){console.log(b.value),p.value=!0;try{const a=await _.post("/DM/deleteItem",{id_item:b.value.id_item},{headers:{Authorization:`Bearer ${v.token}`}});N(),z.add({severity:"success",summary:"Sucesso",detail:"Item excluído com sucesso",life:3e3})}catch(a){console.error("Erro ao excluir item:",a),z.add({severity:"error",summary:"Erro",detail:"Erro ao excluir item",life:3e3})}finally{p.value=!1,M.value=!1,b.value=null}}},Z=()=>{M.value=!1,b.value=null},N=async()=>{p.value=!0;try{const a={id_dm:s.ID_DM},e=await _.post("/DM/listaritens",a,{headers:{Authorization:`Bearer ${v.token}`}});O.value=e.data}catch(a){console.error("Erro ao carregar Itens:",a)}finally{p.value=!1}},j=async a=>{await ee(a)},ee=async a=>{s=a.data,B()?g.value=1:($.value=!0,N(),le())},B=()=>v.userRole==="Administrador",oe=a=>{if(!a)return"";try{const e=new Date(a);if(isNaN(e))throw new Error("Data inválida");const u=new Date(e.getTime()+e.getTimezoneOffset()*6e4),h=String(u.getDate()).padStart(2,"0"),w=String(u.getMonth()+1).padStart(2,"0"),n=u.getFullYear(),c=String(u.getHours()).padStart(2,"0"),C=String(u.getMinutes()).padStart(2,"0");return`${h}/${w}/${n} ${c}:${C}`}catch(e){return console.error("Erro ao formatar data:",e),"Data inválida"}},le=async()=>{const a={id_cliente:v.userIdCliente};try{p.value=!0;const e=await _.post("/produtos/listar",a,{headers:{Authorization:`Bearer ${v.token}`}});E.value=e.data.map(({id_produto:u,codigo:h,nome:w})=>({label:`${h} | ${w}`,value:u}))}catch(e){console.error("Erro ao carregar produtos:",e)}finally{p.value=!1}},te=async()=>{const a={id_cliente:v.userIdCliente,...f.value,id_dm:s.ID_DM};try{p.value=!0;const e=await _.post("/DM/adicionarItens",a,{headers:{Authorization:`Bearer ${v.token}`}});I.value=!1,ae(),N()}catch(e){console.error("Erro ao carregar produtos:",e)}finally{p.value=!1}};pe(g,(a,e)=>{a!==e&&a===0&&(resetForm(),k.value=!1)}),ve(()=>{se(),ie(),W()});const ae=()=>{f.value={id_produto:"",Porta:"",Motor1:"",Motor2:"",Controladora:""}},se=async()=>{const a={id_cliente:v.userIdCliente};try{const e=await _.post("/usuarios/listarPlanta",a,{headers:{Authorization:`Bearer ${v.token}`}});J.value=[R,...e.data.map(({id_planta:u})=>({label:`Planta  ${u}`,value:u}))]}catch(e){console.error("Erro ao buscar opções de plantas:",e)}},ie=async()=>{p.value=!0;try{const a=await _.post("/admin/cliente/listar",{headers:{Authorization:`Bearer ${v.token}`}});F.value=a.data.map(({id_cliente:e,nome:u})=>({label:u,value:e}))}catch(a){console.error("Erro ao listar plantas:",a)}finally{p.value=!1}};return(a,e)=>{const u=m("InputIcon"),h=m("InputText"),w=m("IconField"),n=m("Column"),c=m("Button"),C=m("DataTable"),q=m("TabPanel"),Q=m("Dropdown"),H=m("InputSwitch"),x=m("Checkbox"),ne=m("Textarea"),re=m("TabView"),P=m("InputNumber"),T=m("Dialog");return y(),Y(fe,null,[o("div",Ve,[o("div",ge,[o("div",we,[Ce,$.value?V("",!0):(y(),D(re,{key:0,activeIndex:g.value,"onUpdate:activeIndex":e[17]||(e[17]=l=>g.value=l)},{default:r(()=>[t(q,{header:"Listar Dispenser Machines"},{default:r(()=>[o("div",De,[t(C,{filters:S.value,"onUpdate:filters":e[1]||(e[1]=l=>S.value=l),value:L.value,selectionMode:"single",tableStyle:"min-width: 25%",rowsPerPageOptions:[5,10,20,50],stripedRows:"",dataKey:"id",metaKeySelection:!1,onRowSelect:j,paginator:"",rows:10,globalFilterFields:["id_DM","nome","email","nome_cliente","local","atualizado"]},{header:r(()=>[o("div",Me,[t(w,{iconPosition:"left"},{default:r(()=>[t(u,null,{default:r(()=>[Ie]),_:1}),t(h,{modelValue:S.value.global.value,"onUpdate:modelValue":e[0]||(e[0]=l=>S.value.global.value=l),placeholder:"Busca"},null,8,["modelValue"])]),_:1})])]),default:r(()=>[t(n,{field:"ID_DM",header:"Id"}),t(n,{field:"Numero",header:"Número"}),t(n,{field:"Identificacao",header:"Identificação"}),t(n,{field:"ClienteNome",header:"Cliente"}),t(n,{field:"local",header:"Localização"}),t(n,{field:"Ativo",header:"Ativo"},{body:r(({data:l})=>[o("i",{class:he(["pi",{"pi-check-circle text-green-500 ":l.Ativo,"pi-times-circle text-red-500":!l.Ativo}])},null,2)]),_:1}),t(n,{field:"Updated",header:"Atualizado"},{body:r(({data:l})=>[_e(U(oe(new Date(l.Updated))),1)]),_:1}),t(n,{style:{"min-width":"8rem"}},{body:r(l=>[t(c,{icon:"pi pi-trash",outlined:"",rounded:"",severity:"danger",onClick:de=>K(l.data)},null,8,["onClick"])]),_:1})]),_:1},8,["filters","value"])])]),_:1}),B()?(y(),D(q,{key:0,header:"Adicionar Dispenser Machines"},{default:r(()=>[o("h5",ke,U(k.value?"Editar ":"Nova ")+"Dispenser Machines",1),o("div",Se,[o("div",xe,[Pe,t(Q,{class:"my-2",modelValue:i(s).cliente,"onUpdate:modelValue":e[2]||(e[2]=l=>i(s).cliente=l),options:F.value,optionLabel:"label",optionValue:"value",placeholder:"Selecione um"},null,8,["modelValue","options"])]),o("div",Ue,[Ae,t(h,{class:"my-2",modelValue:i(s).usuario,"onUpdate:modelValue":e[3]||(e[3]=l=>i(s).usuario=l),id:"email"},null,8,["modelValue"])]),o("div",$e,[Ne,t(h,{class:"my-2",modelValue:i(s).usuario,"onUpdate:modelValue":e[4]||(e[4]=l=>i(s).usuario=l),id:"email"},null,8,["modelValue"])]),o("div",Be,[Te,t(H,{class:"grid mt-3 ml-3",modelValue:i(s).status,"onUpdate:modelValue":e[5]||(e[5]=l=>i(s).status=l),inputId:"switch2"},null,8,["modelValue"])])]),ze,o("div",Ee,[Fe,o("div",Oe,[o("div",Le,[t(x,{modelValue:i(s).voucher,"onUpdate:modelValue":e[6]||(e[6]=l=>i(s).voucher=l),inputId:"Voucher",value:"Voucher",binary:!0},null,8,["modelValue"]),Re]),o("div",Ke,[t(x,{modelValue:i(s).cracha,"onUpdate:modelValue":e[7]||(e[7]=l=>i(s).cracha=l),inputId:"cracha",value:"cracha",binary:!0},null,8,["modelValue"]),je]),o("div",qe,[t(x,{modelValue:i(s).biometria,"onUpdate:modelValue":e[8]||(e[8]=l=>i(s).biometria=l),inputId:"Biometria",value:"Biometria",binary:!0},null,8,["modelValue"]),Qe]),o("div",He,[t(x,{modelValue:i(s).facial,"onUpdate:modelValue":e[9]||(e[9]=l=>i(s).facial=l),inputId:"Facial",value:"Facial",binary:!0},null,8,["modelValue"]),Ye])]),o("div",Ge,[Je,t(H,{class:"grid mt-3 ml-3",modelValue:i(s).Mob,"onUpdate:modelValue":e[10]||(e[10]=l=>i(s).Mob=l),inputId:"switch3"},null,8,["modelValue"])]),o("div",We,[Xe,t(h,{class:"my-2",id:"senha",modelValue:i(s).senha,"onUpdate:modelValue":e[11]||(e[11]=l=>i(s).senha=l),type:"password"},null,8,["modelValue"])]),o("div",Ze,[eo,t(h,{class:"my-2",id:"senha",modelValue:i(s).senha,"onUpdate:modelValue":e[12]||(e[12]=l=>i(s).senha=l),type:"password"},null,8,["modelValue"])]),o("div",oo,[lo,t(h,{class:"my-2",id:"senha",modelValue:i(s).senha,"onUpdate:modelValue":e[13]||(e[13]=l=>i(s).senha=l),type:"password"},null,8,["modelValue"])]),o("div",to,[ao,t(ne,{modelValue:i(s).textoretirada,"onUpdate:modelValue":e[14]||(e[14]=l=>i(s).textoretirada=l),class:"my-2 overflow-scroll",rows:"5",cols:"30"},null,8,["modelValue"])]),o("div",so,[t(c,{label:"Salvar",icon:"pi pi-check",severity:"info",onClick:a.saveUsuario,class:"m-2"},null,8,["onClick"])])]),io,o("div",no,[t(c,{label:"Adicionar Controladoras",icon:"pi pi-check",severity:"info",onClick:a.adicionarDM,class:"full mt-4 mr-2"},null,8,["onClick"])]),o("div",ro,[t(C,{selection:a.selectedVM,"onUpdate:selection":e[15]||(e[15]=l=>a.selectedVM=l),value:a.DMOptions,dataKey:"code",tableStyle:"width:100% min-width: 50rem",size:a.small},{default:r(()=>[t(n,{selectionMode:"multiple",headerStyle:"width: 3rem"}),t(n,{field:"code",header:"Code",class:"col-12 md:col-6",style:{width:"30%"}}),t(n,{field:"nome",header:"Name",class:"col-12 md:col-6",style:{width:"70%"}})]),_:1},8,["selection","value","size"]),o("div",co,[k.value?(y(),D(c,{key:0,style:{width:"15%"},class:"flex align-items-center justify-content-center m-2 mr-0",label:"Salvar",icon:"pi pi-check",severity:"primary",onClick:a.saveDMs},null,8,["onClick"])):V("",!0),t(c,{style:{width:"15%"},class:"flex align-items-center justify-content-center m-2 mr-0",label:"Voltar",icon:"pi pi-arrow-left",severity:"primary",onClick:e[16]||(e[16]=l=>g.value=0)}),k.value?V("",!0):(y(),D(c,{key:1,style:{width:"15%"},class:"flex align-items-center justify-content-center m-2 mr-0",label:"Salvar",icon:"pi pi-check",severity:"info",onClick:a.adicionarCliente},null,8,["onClick"]))])])]),_:1})):V("",!0)]),_:1},8,["activeIndex"])),$.value?(y(),Y("div",uo,[mo,t(c,{class:"m-1",label:"Adicionar Itens",onClick:e[18]||(e[18]=l=>I.value=!0)}),o("div",po,[o("div",vo,[t(C,{value:O.value,selectionMode:"single",tableStyle:"min-width: 25%",rowsPerPageOptions:[5,10,20,50],stripedRows:"",dataKey:"id",metaKeySelection:!1,onRowSelect:j,paginator:"",rows:10},{default:r(()=>[t(n,{field:"SKU",header:"SKU"}),t(n,{field:"Nome_Produto",header:"Produto"}),t(n,{field:"Posicao",header:"Controladora/Placa/Motor 1/ Motor 2"}),t(n,{field:"QTD",header:"QTD"}),t(n,{style:{"min-width":"8rem"}},{body:r(l=>[t(c,{icon:"pi pi-trash",outlined:"",rounded:"",severity:"danger",onClick:de=>K(l.data)},null,8,["onClick"])]),_:1})]),_:1},8,["value"])])])])):V("",!0),p.value?(y(),D(be,{key:2})):V("",!0)])])]),t(T,{header:"Adicionar Produto",visible:I.value,style:{width:"30vw"},modal:!0,closable:!1},{default:r(()=>[o("div",fo,[o("div",ho,[o("div",_o,[yo,t(Q,{modelValue:f.value.id_produto,"onUpdate:modelValue":e[19]||(e[19]=l=>f.value.id_produto=l),options:E.value,optionLabel:"label",optionValue:"value",placeholder:"Selecione um produto",class:"col-8 p-0"},null,8,["modelValue","options"])]),o("div",bo,[Vo,t(P,{id:"Porta",modelValue:f.value.Porta,"onUpdate:modelValue":e[20]||(e[20]=l=>f.value.Porta=l),inputClass:"col-3 ml-3",autocomplete:"off",min:1,max:999},null,8,["modelValue"])]),o("div",go,[wo,t(P,{id:"Controladora",modelValue:f.value.Controladora,"onUpdate:modelValue":e[21]||(e[21]=l=>f.value.Controladora=l),inputClass:"col-3",autocomplete:"off",min:1,max:999},null,8,["modelValue"])]),o("div",Co,[Do,t(P,{id:"Mola",modelValue:f.value.Motor1,"onUpdate:modelValue":e[22]||(e[22]=l=>f.value.Motor1=l),inputClass:"col-3",autocomplete:"off",min:1,max:999},null,8,["modelValue"])]),o("div",Mo,[Io,t(P,{id:"Mola2",modelValue:f.value.Motor2,"onUpdate:modelValue":e[23]||(e[23]=l=>f.value.Motor2=l),inputClass:"col-3",autocomplete:"off",min:1,max:999},null,8,["modelValue"])])])]),o("div",ko,[t(c,{type:"button",label:"Cancelar",severity:"secondary",onClick:e[24]||(e[24]=l=>I.value=!1)}),t(c,{type:"button",label:"Adicionar",onClick:te})])]),_:1},8,["visible"]),t(T,{header:"Deletar Item",visible:M.value,style:{width:"30vw"},modal:!0,closable:!1},{footer:r(()=>[t(c,{label:"Cancelar",icon:"pi pi-times",class:"p-button-secondary",onClick:Z}),t(c,{label:"OK",icon:"pi pi-check",onClick:X})]),default:r(()=>[o("p",null,U(A.value),1)]),_:1},8,["visible"]),t(T,{header:"Deletar DM",visible:G.value,style:{width:"30vw"},modal:!0,closable:!1},{footer:r(()=>[t(c,{label:"OK",icon:"pi pi-check",onClick:e[25]||(e[25]=l=>a.showDialog=!1)})]),default:r(()=>[o("p",null,U(A.value),1)]),_:1},8,["visible"])],64)}}};export{Ao as default};
