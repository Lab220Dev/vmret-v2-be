import{H as E}from"./vue-datepicker-91db1dd2.js";import{r as s,e as ie,m as de,s as ce,g as c,o as b,c as L,d as n,h as t,y as P,a as S,w as u,z as j,F as ue,l as f,i as H,t as A,A as pe}from"./index-47c49ab3.js";/* empty css             */import{L as me}from"./LoadingSpinner-5d33e654.js";import"./format-7e97a1d1.js";const ve={class:"card vh"},fe={class:"form"},_e={class:"grid mt-3 mx-1 px-1"},he=n("h5",{class:"my-4 text-2xl"},"Retiradas Realizadas",-1),be={key:0,class:"p-0 m-0 p-fluid formgrid grid col-12"},ye={class:"field xl:col-3 lg:col-6 md:col-6 sm:col-6"},we=n("label",{for:"dm"},"DM:",-1),ge={class:"field xl:col-3 lg:col-6 md:col-6 sm:col-6"},Ve=n("label",{for:"planta"},"Planta:",-1),Ce={class:"field xl:col-3 lg:col-4 md:col-6 sm:col-6"},ke=n("label",{for:"perfil"},"Centro de Custo:",-1),De={class:"field xl:col-3 lg:col-4 md:col-6 sm:col-6"},xe=n("label",{for:"perfil"},"Setor:",-1),Ie={class:"field xl:col-3 lg:col-4 md:col-6 sm:col-6"},Se=n("label",{for:"perfil"},"Funcionário:",-1),Ae={class:"field xl:col-3 lg:col-4 md:col-6 sm:col-6"},Oe=n("label",{for:"perfil"},"Data Inicial:",-1),Be={class:"field xl:col-3 lg:col-4 md:col-6 sm:col-6"},Re=n("label",{for:"perfil"},"Data Final:",-1),Fe={class:"field xl:col-3 lg:col-4 md:col-6 sm:col-6"},$e={class:"field xl:col-3 lg:col-4 md:col-6 sm:col-6"},Me={class:"field xl:col-3 lg:col-4 md:col-6 sm:col-6"},Ue={class:"datatable-wrapper"},Ne={class:"flex justify-content-end"},Te=n("i",{class:"pi pi-search"},null,-1),Je={__name:"retiradasrealizadas",setup(ze){const y=s(!1),O=s(""),d=ie();de();const w=s(null),g=s(null),V=s(null),C=s(null),k=s(null),v=s([]),p={label:"Todos",value:null},B=s(null),R=s([p]),F=s([p]),$=s([p]),M=s([p]),_=s({global:{value:null,matchMode:pe.CONTAINS}}),D=s("Ainda não foi feita nenhuma busca"),x=s(!0),U=s([]),I=s(!1),a=s({dm:"",id_planta:"",id_centro_custo:"",id_setor:"",id_funcionario:"",data_inicio:new Date(new Date().getFullYear(),new Date().getMonth(),1),data_final:new Date}),N=l=>{const e=l.getDate(),o=l.getMonth()+1,i=l.getFullYear();return`${e}/${o}/${i}`},T=l=>l?new Date(l).toISOString():null,J=async()=>{const l={id_cliente:d.userIdCliente,id_dm:a.value.dm===null?void 0:a.value.dm,id_planta:a.value.id_planta===null?void 0:a.value.id_planta,id_centro_custo:a.value.id_centro_custo===null?void 0:a.value.id_centro_custo,id_setor:a.value.id_setor===null?void 0:a.value.id_setor,id_funcionario:a.value.id_funcionario===null?void 0:a.value.id_funcionario,data_inicio:T(a.value.data_inicio),data_final:T(a.value.data_final)};try{I.value=!0;const e=await f.post("relatorioRetiRe/relatorio",l,{headers:{Authorization:`Bearer ${d.token}`}});v.value=e.data,Array.isArray(v.value)&&v.value.length===0&&(O.value="Nenhum dado encontrado. Por favor, verifique sua consulta.",y.value=!0),v.value.length===0?D.value="Nenhum dado encontrado. Por favor, verifique sua consulta.":D.value=""}catch(e){console.error("Erro ao buscar retiradas:",e)}finally{I.value=!1}},K=()=>{x.value=!0,U.value={}},Q=s(null),q=l=>{const e=Object.keys(l[0]).join(","),o=l.map(i=>Object.values(i).join(",")).join(`
`);return`${e}
${o}`},Y=()=>{const l=q(v.value),e=new Blob([l],{type:"text/csv;charset=utf-8;"}),o=document.createElement("a"),i=URL.createObjectURL(e);o.setAttribute("href",i),o.setAttribute("download","RetiradasRealizadas.csv"),document.body.appendChild(o),o.click(),document.body.removeChild(o)},G=()=>{const l=JSON.stringify(v.value,null,2),e=new Blob([l],{type:"application/json;charset=utf-8;"}),o=document.createElement("a"),i=URL.createObjectURL(e);o.setAttribute("href",i),o.setAttribute("download","RetiradasRealizadas.json"),document.body.appendChild(o),o.click(),document.body.removeChild(o)},W=async()=>{const l={id_cliente:d.userIdCliente};try{const e=await f.get("/relatorioRetiRe/listardm",{params:l,headers:{Authorization:`Bearer ${d.token}`}});R.value=[p,...e.data.map(({id_dm:o})=>({label:`DM  ${o}`,value:o}))]}catch(e){console.error("Erro ao carregar lista de dms:",e)}},X=async()=>{const l={id_cliente:d.userIdCliente};try{const e=await f.post("funcionarios/listarplanta",l,{headers:{Authorization:`Bearer ${d.token}`}});F.value=[p,...e.data.map(({id_planta:o})=>({label:`Planta  ${o}`,value:o}))]}catch(e){console.error("Erro ao buscar opções de plantas:",e)}},Z=async()=>{const l={id_cliente:d.userIdCliente};try{const e=await f.post("funcionarios/listarsetor",l,{headers:{Authorization:`Bearer ${d.token}`}});$.value=[p,...e.data.map(({id_setor:o})=>({label:`Setor  ${o}`,value:o}))]}catch(e){console.error("Erro ao buscar setores/diretorias:",e)}},ee=async()=>{const l={id_cliente:d.userIdCliente};try{const e=await f.post("funcionarios/listarcentrocusto",l,{headers:{Authorization:`Bearer ${d.token}`}});M.value=[p,...e.data.map(({id_centro_custo:o})=>({label:`Centro de Custo  ${o}`,value:o}))]}catch(e){console.error("Erro ao buscar centros de custo:",e)}},oe=async()=>{const l={id_cliente:d.userIdCliente};try{const e=await f.post("/funcionarios/listar",l,{headers:{Authorization:`Bearer ${d.token}`}});B.value=e.data.map(o=>({label:o.nome,value:o.id_funcionario}))}catch(e){console.error("Erro ao carregar usuários:",e)}},le=()=>{var l,e,o,i,h;(l=w.value)!=null&&l.overlayVisible&&w.value.hide(),(e=g.value)!=null&&e.overlayVisible&&g.value.hide(),(o=V.value)!=null&&o.overlayVisible&&V.value.hide(),(i=C.value)!=null&&i.overlayVisible&&C.value.hide(),(h=k.value)!=null&&h.overlayVisible&&k.value.hide()},z=()=>{le()};return ce(()=>{W(),X(),Z(),oe(),ee()}),(l,e)=>{const o=c("Dropdown"),i=c("Button"),h=c("InputIcon"),ae=c("InputText"),te=c("IconField"),m=c("Column"),ne=c("DataTable"),se=c("Card"),re=c("Dialog");return b(),L(ue,null,[n("div",ve,[n("div",fe,[n("div",_e,[he,x.value?(b(),L("div",be,[n("div",ye,[we,t(o,{class:"drop",modelValue:a.value.dm,"onUpdate:modelValue":e[0]||(e[0]=r=>a.value.dm=r),options:R.value,optionLabel:"label",optionValue:"value",ref_key:"dropdown1",ref:w,placeholder:"Todos"},null,8,["modelValue","options"])]),n("div",ge,[Ve,t(o,{class:"drop",modelValue:a.value.id_planta,"onUpdate:modelValue":e[1]||(e[1]=r=>a.value.id_planta=r),options:F.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown2",ref:g},null,8,["modelValue","options"])]),n("div",Ce,[ke,t(o,{class:"drop",modelValue:a.value.id_centro_custo,"onUpdate:modelValue":e[2]||(e[2]=r=>a.value.id_centro_custo=r),options:M.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown3",ref:V},null,8,["modelValue","options"])]),n("div",De,[xe,t(o,{class:"drop",modelValue:a.value.id_setor,"onUpdate:modelValue":e[3]||(e[3]=r=>a.value.id_setor=r),options:$.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown4",ref:C},null,8,["modelValue","options"])]),n("div",Ie,[Se,t(o,{class:"drop",modelValue:a.value.id_funcionario,"onUpdate:modelValue":e[4]||(e[4]=r=>a.value.id_funcionario=r),options:B.value,optionLabel:"label",optionValue:"value",placeholder:"Todos",ref_key:"dropdown5",ref:k},null,8,["modelValue","options"])]),n("div",Ae,[Oe,t(P(E),{class:"drop",modelValue:a.value.data_inicio,"onUpdate:modelValue":e[5]||(e[5]=r=>a.value.data_inicio=r),showIcon:"",showOnFocus:!1,format:N,locale:"pt-BR","auto-apply":"","enable-time-picker":!1,placeholder:"Selecione uma data inicial",ref:"datepicker1",onOpen:z},null,8,["modelValue"])]),n("div",Be,[Re,t(P(E),{class:"drop",modelValue:a.value.data_final,"onUpdate:modelValue":e[6]||(e[6]=r=>a.value.data_final=r),showIcon:"",showOnFocus:!1,format:N,locale:"pt-BR","auto-apply":"","enable-time-picker":!1,placeholder:"Selecione uma data final",ref:"datepicker2",onOpen:z},null,8,["modelValue"])]),n("div",Fe,[t(i,{class:"filtrar",type:"button",label:"Filtrar Dados",icon:"pi pi-search",severity:"info",onClick:J})]),n("div",$e,[t(i,{class:"exportar",icon:"pi pi-file",label:"Exportar CSV",onClick:Y})]),n("div",Me,[t(i,{class:"exportar",icon:"pi pi-file",label:"Exportar JSON",onClick:G})])])):S("",!0),n("div",Ue,[t(ne,{filters:_.value,"onUpdate:filters":e[8]||(e[8]=r=>_.value=r),value:v.value,stripedRows:"",showGridlines:"",paginator:"",rows:10,rowsPerPageOptions:[5,10,20,50],rowHover:"",globalFilterFields:["ID_DM","Dia","matricula","nome","email","ProdutoNome","Quantidade","ProdutoSKU"],tableStyle:{width:"100%"},ref_key:"dt",ref:Q,class:""},{header:u(()=>[n("div",Ne,[t(te,{iconPosition:"left"},{default:u(()=>[t(h,null,{default:u(()=>[Te]),_:1}),t(ae,{modelValue:_.value.global.value,"onUpdate:modelValue":e[7]||(e[7]=r=>_.value.global.value=r),placeholder:"Busca"},null,8,["modelValue"])]),_:1})])]),empty:u(()=>[H(A(D.value),1)]),default:u(()=>[t(m,{field:"ID_DM",sortable:"",header:"DM"}),t(m,{field:"Dia",sortable:"",header:"Data"}),t(m,{field:"matricula",sortable:"",header:"Matricula"}),t(m,{field:"nome",sortable:"",header:"Nome"}),t(m,{field:"email",sortable:"",header:"E-mail"}),t(m,{field:"ProdutoNome",sortable:"",header:"Item"}),t(m,{field:"Quantidade",sortable:"",header:"Quant",class:"text-center"}),t(m,{field:"ProdutoSKU",sortable:"",header:"CA"})]),_:1},8,["filters","value"])]),x.value?S("",!0):(b(),j(se,{key:1},{title:u(()=>[H(A(U.value.dm),1)]),content:u(()=>[t(i,{type:"button",label:"Voltar",icon:"pi pi-check",severity:"info",onClick:K})]),_:1}))])])]),I.value?(b(),j(me,{key:0})):S("",!0),t(re,{header:"Informação",visible:y.value,style:{width:"30vw"},modal:!0,closable:!1},{footer:u(()=>[t(i,{label:"OK",icon:"pi pi-check",onClick:e[9]||(e[9]=r=>y.value=!1)})]),default:u(()=>[n("p",null,A(O.value),1)]),_:1},8,["visible"])],64)}}};export{Je as default};
