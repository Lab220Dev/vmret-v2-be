import{r as p,e as U,m as q,q as R,C as M,s as F,g as i,o as y,c as K,h as n,w as u,l as C,d as t,k as P,y as m,z as h,a as b,i as g,t as I}from"./index-a0b57296.js";const L={class:"card vh"},G={class:"col-12"},H={class:"grid"},J={class:"col-12"},O={class:"card"},Q={class:"p-fluid formgrid grid m-0 p-0"},W={class:"full lg:col-12 md:col-12 sm:col-12"},X=t("label",{for:"id_centro_custo"},"Código:",-1),Y={class:"full lg:col-12 md:col-12 sm:col-12"},Z=t("label",{for:"nome"},"Centro de Custo (Nome):",-1),ee={class:"mr-1 mt-4 grid justify-content-end"},te=t("div",{class:"mr-1 mt-7 grid justify-content-end flex-wrap"},null,-1),oe={class:"confirmation-content"},se=t("i",{class:"pi pi-exclamation-triangle mr-1",style:{"font-size":"2rem"}},null,-1),ae={class:""},ce={__name:"cdc",setup(ne){const l=p(0),c=U(),x=q(),w=p([]),r=p(!1);p([]);const _=p(!1);let s=R({nome:"",id_centro_custo:""});const T=async o=>{s=o.data,r.value=!0,l.value=1,d()},D=()=>{r.value?V():k()},d=async()=>{const o={id_cliente:c.userIdCliente};try{const e=await C.post("/cdc/listar",o,{headers:{Authorization:`Bearer ${c.token}`}});w.value=e.data}catch(e){console.error("Erro ao listar centros de custo:",e)}},k=async()=>{const o={id_cliente:c.userIdCliente,...s};try{const e=await C.post("/cdc/adicionar",o,{headers:{Authorization:`Bearer ${c.token}`}});d(),l.value=0,f()}catch(e){console.error("Erro ao adicionar centro de custo:",e)}},N=async()=>{let o={id_centro_custo:s.id_centro_custo};try{await C.post("/cdc/deleteCentro",o,{headers:{Authorization:`Bearer ${c.token}`}}),x.add({severity:"success",summary:"Successful",detail:"Centro Deletado",life:3e3}),_.value=!1,d(),l.value=0,f()}catch{x.add({severity:"error",summary:"Error",detail:"Erro ao deletar o centro de custo",life:3e3})}l.value=0},V=async()=>{const o={id_cliente:c.userIdCliente,...s};try{const e=await C.post("/cdc/atualizar",o,{headers:{Authorization:`Bearer ${c.token}`}});d(),l.value=0,f()}catch(e){console.error("Erro ao atualizar centros de custo:",e)}};M(l,(o,e)=>{o!==e&&o===0&&(f(),d(),r.value=!1)});const f=()=>{s.nome="",s.codigo="",s.id_centro_custo=""},E=async o=>{await T(o)};return F(()=>{d()}),(o,e)=>{const S=i("Column"),j=i("DataTable"),z=i("TabPanel"),B=i("InputText"),v=i("Button"),A=i("Dialog"),$=i("TabView");return y(),K("div",L,[n($,{activeIndex:l.value,"onUpdate:activeIndex":e[6]||(e[6]=a=>l.value=a)},{default:u(()=>[n(z,{header:"Listar Centros de Custo"},{default:u(()=>[t("div",G,[n(j,{value:w.value,selectionMode:"single",tableStyle:"min-width: 25%",stripedRows:"",dataKey:"id",metaKeySelection:!1,onRowSelect:E},{default:u(()=>[n(S,{field:"Codigo",header:"Código"}),n(S,{field:"Nome",header:"Centro de Custo (Nome)"})]),_:1},8,["value"])])]),_:1}),n(z,{header:"Adicionar Centro de Custo",activeIndex:l.value,"onUpdate:activeIndex":e[5]||(e[5]=a=>l.value=a)},{default:u(()=>[t("div",H,[t("div",J,[t("div",O,[t("form",{onSubmit:P(D,["prevent"])},[t("div",Q,[t("div",W,[X,n(B,{class:"my-2",id:"id_centro_custo",modelValue:m(s).id_centro_custo,"onUpdate:modelValue":e[0]||(e[0]=a=>m(s).id_centro_custo=a),required:""},null,8,["modelValue"])]),t("div",Y,[Z,n(B,{class:"my-2",id:"nome",modelValue:m(s).nome,"onUpdate:modelValue":e[1]||(e[1]=a=>m(s).nome=a),required:""},null,8,["modelValue"])])]),t("div",ee,[r.value?(y(),h(v,{key:0,style:{width:"15%"},class:"flex align-items-center justify-content-center m-2 mr-0",label:"Salvar",icon:"pi pi-check",severity:"primary",onClick:V})):b("",!0),r.value?(y(),h(v,{key:1,style:{width:"15%"},class:"flex align-items-center justify-content-center m-2 mr-0",label:"Excluir",icon:"pi pi-trash",severity:"danger",onClick:e[2]||(e[2]=a=>_.value=!0)})):b("",!0),r.value?b("",!0):(y(),h(v,{key:2,style:{width:"15%"},class:"flex align-items-center justify-content-center m-2 mr-0",label:"Salvar",icon:"pi pi-check",severity:"info",onClick:k}))])],32)]),te,n(A,{header:"Deletar Centro de Custo",visible:_.value,"onUpdate:visible":e[4]||(e[4]=a=>_.value=a),style:{width:"400px"},modal:!0,closable:!1},{footer:u(()=>[n(v,{label:"Não",icon:"pi pi-times",onClick:e[3]||(e[3]=a=>_.value=!1),class:"p-button-text"}),n(v,{label:"Sim",icon:"pi pi-check",onClick:N,class:"p-button-text"})]),default:u(()=>[t("div",oe,[se,t("span",ae,[g(" Você tem certeza que deseja deletar esse centro de custo? "),t("b",null,I(m(s).id_centro_custo),1),g(" - "),t("b",null,I(m(s).nome),1),g(" ?")])])]),_:1},8,["visible"])])])]),_:1},8,["activeIndex"])]),_:1},8,["activeIndex"])])}}};export{ce as default};
