import{r as v,e as q,m as R,q as K,C as O,s as H,g as c,o as b,c as J,h as n,w as d,z as D,a as T,l as C,d as o,S as Y,i as V,t as z,k as G,y as s}from"./index-b8796d24.js";import{L as Q}from"./LoadingSpinner-5e082fdb.js";const W={class:"card"},X={class:"col-12"},Z={class:"grid"},ee={class:"col-12"},te={class:"card"},ae={class:"p-fluid formgrid grid m-0 p-0"},oe={class:"full lg:col-12 md:col-12 sm:col-12"},le=o("label",{for:"id_planta"},"Nome:",-1),ne={class:"full lg:col-12 md:col-12 sm:col-12"},ie=o("label",{for:"cpfcnpj"},"CNPJ/CPF:",-1),se={class:"full lg:col-6 md:col-6 sm:col-6"},re=o("label",{for:"codigo"},"Menção Ficha Retirada:",-1),ce=o("label",{class:"mt-3 ml-4",for:"switch1"},"Tem integração?",-1),de=o("label",{class:"mt-3 ml-4",for:"switch2"},"Cliente Ativo?",-1),ue={class:"mr-1 mt-4 grid justify-content-end"},me={class:"confirmation-content"},pe=o("i",{class:"pi pi-exclamation-triangle mr-1",style:{"font-size":"2rem"}},null,-1),ve={class:""},ge={__name:"Clientes",setup(fe){const m=v(0),_=q(),A=R(),r=v(!1),$=v([]),f=v(!1),y=v(!1),h=v({});let l=K({nome:"",cpfcnpj:"",ativo:!0,usarApi:!1,textoretirada:""});const I=a=>{l=a.data,m.value=1,f.value=!0,p()},E=()=>{f.value?B():j()},j=async()=>{const a={...l};r.value=!0;try{const e=await C.post("/admin/cliente/adicionar",a,{headers:{Authorization:`Bearer ${_.token}`}});p(),m.value=0,x()}catch(e){console.error("Erro ao adicionar Clientes:",e)}finally{r.value=!1}},P=a=>{h.value=a,y.value=!0},U=async a=>{r.value=!0;let e={id_cliente:a.id_cliente};try{await C.post("/admin/cliente/delete",e,{headers:{Authorization:`Bearer ${_.token}`}}),A.add({severity:"success",summary:"Successful",detail:"Ciente Deletada",life:3e3}),y.value=!1,p()}catch{A.add({severity:"error",summary:"Error",detail:"Erro ao deletar a planta.",life:3e3})}finally{r.value=!1}},B=async()=>{r.value=!0;const a={id_cliente:l.id_cliente,...l};try{const e=await C.post("/admin/cliente/atualizar",a,{headers:{Authorization:`Bearer ${_.token}`}});p(),m.value=0,x()}catch(e){console.error("Erro ao atualizar Plantas:",e)}finally{r.value=!1}};O(m,(a,e)=>{a!==e&&a===0&&(x(),p(),f.value=!1)});const x=()=>{l.nome="",l.cpfcnpj="",l.ativo=!0,l.created=new Date,l.usarApi=!1,l.textoretirada=""},p=async()=>{r.value=!0;try{const a=await C.post("/admin/cliente/listar",{headers:{Authorization:`Bearer ${_.token}`}});$.value=a.data}catch(a){console.error("Erro ao listar plantas:",a)}finally{r.value=!1}},F=a=>{if(!a)return"";try{const e=new Date(a);if(isNaN(e))throw new Error("Data inválida");const i=new Date(e.getTime()+e.getTimezoneOffset()*6e4),u=String(i.getDate()).padStart(2,"0"),S=String(i.getMonth()+1).padStart(2,"0"),g=i.getFullYear(),w=String(i.getHours()).padStart(2,"0"),k=String(i.getMinutes()).padStart(2,"0");return`${u}/${S}/${g} ${w}:${k}`}catch(e){return console.error("Erro ao formatar data:",e),"Data inválida"}};return H(()=>{p()}),(a,e)=>{const i=c("Column"),u=c("Button"),S=c("DataTable"),g=c("TabPanel"),w=c("InputText"),k=c("Textarea"),N=c("InputSwitch"),M=c("TabView"),L=c("Dialog");return b(),J("div",W,[n(M,{activeIndex:m.value,"onUpdate:activeIndex":e[6]||(e[6]=t=>m.value=t)},{default:d(()=>[n(g,{header:"Listar Clientes"},{default:d(()=>[o("div",X,[n(S,{value:$.value,selectionMode:"single",tableStyle:"min-width: 25%",rowsPerPageOptions:[5,10,20,50],stripedRows:"",dataKey:"id",metaKeySelection:!1,onRowSelect:I},{default:d(()=>[n(i,{field:"id_cliente",header:"Id"}),n(i,{field:"nome",header:"Nome"}),n(i,{field:"ativo",header:"Ativo"},{body:d(({data:t})=>[o("i",{class:Y(["pi",{"pi-check-circle text-green-500 ":t.ativo,"pi-times-circle text-red-500":!t.ativo}])},null,2)]),_:1}),n(i,{field:"last_login",header:"Último Login"},{body:d(({data:t})=>[V(z(F(new Date(t.last_login))),1)]),_:1}),n(i,{style:{"min-width":"8rem"}},{body:d(t=>[n(u,{icon:"pi pi-trash",outlined:"",rounded:"",severity:"danger",onClick:_e=>P(t.data)},null,8,["onClick"])]),_:1})]),_:1},8,["value"])])]),_:1}),n(g,{header:"Adicionar Clientes"},{default:d(()=>[o("div",Z,[o("div",ee,[o("div",te,[o("form",{onSubmit:G(E,["prevent"])},[o("div",ae,[o("div",oe,[le,n(w,{class:"my-2",id:"id_planta",modelValue:s(l).nome,"onUpdate:modelValue":e[0]||(e[0]=t=>s(l).nome=t),required:""},null,8,["modelValue"])]),o("div",ne,[ie,n(w,{class:"my-2",id:"cpfcnpj",modelValue:s(l).cpfcnpj,"onUpdate:modelValue":e[1]||(e[1]=t=>s(l).cpfcnpj=t),required:""},null,8,["modelValue"])]),o("div",se,[re,n(k,{modelValue:s(l).textoretirada,"onUpdate:modelValue":e[2]||(e[2]=t=>s(l).textoretirada=t),class:"my-2 overflow-scroll",rows:"5",cols:"30"},null,8,["modelValue"])]),n(N,{class:"grid mt-3 ml-3",modelValue:s(l).usarApi,"onUpdate:modelValue":e[3]||(e[3]=t=>s(l).usarApi=t),inputId:"switch1"},null,8,["modelValue"]),ce,n(N,{class:"grid mt-3 ml-3",modelValue:s(l).ativo,"onUpdate:modelValue":e[4]||(e[4]=t=>s(l).ativo=t),inputId:"switch2"},null,8,["modelValue"]),de]),o("div",ue,[f.value?(b(),D(u,{key:0,style:{width:"15%"},class:"flex align-items-center justify-content-center m-2 mr-0",label:"Atualizar",icon:"pi pi-refresh",severity:"primary",onClick:B})):T("",!0),n(u,{style:{width:"15%"},class:"flex align-items-center justify-content-center m-2 mr-0",label:"Voltar",icon:"pi pi-trash",severity:"primary",onClick:e[5]||(e[5]=t=>m.value=0)}),f.value?T("",!0):(b(),D(u,{key:1,style:{width:"15%"},class:"flex align-items-center justify-content-center m-2 mr-0",label:"Salvar",icon:"pi pi-check",severity:"info",onClick:j}))])],32)])])])]),_:1})]),_:1},8,["activeIndex"]),n(L,{header:"Deletar Cliente",visible:y.value,"onUpdate:visible":e[9]||(e[9]=t=>y.value=t),style:{width:"400px"},modal:!0,closable:!1},{footer:d(()=>[n(u,{label:"Não",icon:"pi pi-times",onClick:e[7]||(e[7]=t=>a.deleteFuncionarioDialog=!1),class:"p-button-text"}),n(u,{label:"Sim",icon:"pi pi-check",onClick:e[8]||(e[8]=t=>U(h.value)),class:"p-button-text"})]),default:d(()=>[o("div",me,[pe,o("span",ve,[V(" Você tem certeza que deseja deletar o Cliente "),o("b",null,z(h.value.id_cliente),1),V(" - "),o("b",null,z(h.value.nome),1),V(" ?")])])]),_:1},8,["visible"]),r.value?(b(),D(Q,{key:0})):T("",!0)])}}};export{ge as default};
