import{r as c,e as O,m as R,q,C as K,s as G,g as r,o as h,c as H,d as o,h as l,w as u,z as w,a as V,l as U,S as Y,i as S,t as k}from"./index-9a3304b5.js";import{L as J}from"./LoadingSpinner-46f73b0a.js";const Q={class:"grid"},X={class:"col-12"},Z={class:"card"},ee=o("h5",{class:"mt-2"},"Usuário Web",-1),te={class:"col-12"},oe={class:"mt-2"},ae={class:"mt-5 mx-0 p-fluid grid"},le={class:"full lg:col-12 md:col-12 sm:col-12"},se=o("label",{for:"name"},"Nome:",-1),ne={class:"full lg:col-7 md:col-7 sm:col-12"},ie=o("label",{for:"email"},"E-mail:",-1),re={class:"full lg:col-5 md:col-5 sm:col-12"},ue=o("label",{for:"senha"},"Senha:",-1),de={class:"full lg:col-5 md:col-5 sm:col-12"},ce=o("label",{for:"senha"},"Confirme a Senha:",-1),me={class:"full lg:col-4 md:col-4 sm:col-12"},pe=o("label",{for:"perfil"},"Perfil:",-1),ve={class:"full lg:col-4 md:col-4 sm:col-12"},fe=o("label",{for:"planta"},"Planta:",-1),he={class:"full lg:col-4 md:col-4 sm:col-12"},ye=o("label",{class:"mt-3 ml-4",for:"switch2"},"Usuario Ativo?",-1),_e={class:"flex align-items-center justify-content-end field col-12"},be={class:"confirmation-content"},ge=o("i",{class:"pi pi-exclamation-triangle mr-1",style:{"font-size":"2rem"}},null,-1),we={class:""},De={__name:"web",setup(Ve){const m=c(0),f=O(),d=c(!1),C=R(),z={label:"Todos",value:null},p=c(!1),$=c(""),E=c([z]),s=q({nome:"",email:"",perfil:"",planta:"",senha:"",Status:""}),T=c([]),x=c([{name:"Gestor",value:"gestor"},{name:"Master",value:"master"},{name:"Operador",value:"operador"},{name:"Liberação Avulsa",value:"avulsa"}]),B=a=>{show.value=!0,s.value=a.data},I=()=>{m.value=0,_()},A=()=>{p.value?P():N()},N=async()=>{const a={...s};try{const e=await U.post("/usuario/adicionar",a,{headers:{Authorization:`Bearer ${f.token}`}});C.add({severity:"success",summary:"Successful",detail:"Usuario WEB criado",life:3e3}),y(),m.value=0,_()}catch(e){console.error("Erro ao adicionar Usuario:",e)}finally{d.value=!1}d.value=!0},P=async()=>{d.value=!0;const a={...s};try{const e=await U.post("/usuario/atualizar",a,{headers:{Authorization:`Bearer ${f.token}`}});C.add({severity:"success",summary:"Successful",detail:"Usuario WEB atualizado",life:3e3}),y(),m.value=0,_()}catch(e){console.error("Erro ao atualizar o Usuario:",e)}finally{d.value=!1}d.value=!0},L=async()=>{const a={id_cliente:f.userIdCliente};try{const e=await U.post("/usuarios/listarPlanta",a,{headers:{Authorization:`Bearer ${f.token}`}});E.value=[z,...e.data.map(({id_planta:n})=>({label:`Planta  ${n}`,value:n}))]}catch(e){console.error("Erro ao buscar opções de plantas:",e)}},y=async()=>{d.value=!0;const a={};try{const e=await U.post("/usuarios/listar",a,{headers:{Authorization:`Bearer ${f.token}`}});T.value=e.data}catch(e){console.error("Erro ao carregar usuários:",e)}finally{d.value=!1}},j=a=>{if(!a)return"";try{const e=new Date(a);if(isNaN(e))throw new Error("Data inválida");const n=new Date(e.getTime()+e.getTimezoneOffset()*6e4),i=String(n.getDate()).padStart(2,"0"),D=String(n.getMonth()+1).padStart(2,"0"),b=n.getFullYear(),v=String(n.getHours()).padStart(2,"0"),g=String(n.getMinutes()).padStart(2,"0");return`${i}/${D}/${b} ${v}:${g}`}catch(e){return console.error("Erro ao formatar data:",e),"Data inválida"}};K(m,(a,e)=>{a!==e&&a===0&&(_(),y(),p.value=!1)}),G(()=>{L(),y()});const _=()=>{s.nome="",s.Status=!0,s.email="",s.perfil="",s.planta="",s.senha=""};return(a,e)=>{const n=r("Column"),i=r("Button"),D=r("DataTable"),b=r("TabPanel"),v=r("InputText"),g=r("Dropdown"),F=r("InputSwitch"),W=r("TabView"),M=r("Dialog");return h(),H("div",Q,[o("div",X,[o("div",Z,[ee,l(W,{activeIndex:m.value,"onUpdate:activeIndex":e[9]||(e[9]=t=>m.value=t)},{default:u(()=>[l(b,{header:"Listar  Usuário Web"},{default:u(()=>[o("div",te,[l(D,{value:T.value,selectionMode:"single",tableStyle:"min-width: 25%",rowsPerPageOptions:[5,10,20,50],stripedRows:"",dataKey:"id",metaKeySelection:!1,onRowSelect:B,paginator:"",rows:10},{default:u(()=>[l(n,{field:"id_usuario",header:"Id"}),l(n,{field:"nome",header:"Nome"}),l(n,{field:"email",header:"E-mail"}),l(n,{field:"role",header:"role"}),l(n,{field:"ativo",header:"Ativo"},{body:u(({data:t})=>[o("i",{class:Y(["pi",{"pi-check-circle text-green-500 ":t.ativo,"pi-times-circle text-red-500":!t.ativo}])},null,2)]),_:1}),l(n,{field:"last_login",header:"Último Login"},{body:u(({data:t})=>[S(k(j(new Date(t.last_login))),1)]),_:1}),l(n,{style:{"min-width":"8rem"}},{body:u(t=>[l(i,{icon:"pi pi-trash",outlined:"",rounded:"",severity:"danger",onClick:Ue=>a.deleteUsuario(t.data)},null,8,["onClick"])]),_:1})]),_:1},8,["value"])])]),_:1}),l(b,{header:"Adicionar Usuário Web"},{default:u(()=>[o("h5",oe,k(p.value?"Editar ":"Novo ")+"Usuário Web",1),o("div",ae,[o("div",le,[se,l(v,{class:"my-2",modelValue:s.nome,"onUpdate:modelValue":e[0]||(e[0]=t=>s.nome=t),id:"name",type:"text"},null,8,["modelValue"])]),o("div",ne,[ie,l(v,{class:"my-2",modelValue:s.email,"onUpdate:modelValue":e[1]||(e[1]=t=>s.email=t),id:"email"},null,8,["modelValue"])]),o("div",re,[ue,l(v,{class:"my-2",id:"senha",modelValue:s.senha,"onUpdate:modelValue":e[2]||(e[2]=t=>s.senha=t),type:"password"},null,8,["modelValue"])]),o("div",de,[ce,l(v,{class:"my-2",id:"senha",modelValue:$.value,"onUpdate:modelValue":e[3]||(e[3]=t=>$.value=t),type:"password"},null,8,["modelValue"])]),o("div",me,[pe,l(g,{class:"my-2",id:"perfil",modelValue:s.perfil,"onUpdate:modelValue":e[4]||(e[4]=t=>s.perfil=t),options:x.value,optionLabel:"label",optionValue:"value",placeholder:"Escolha um"},null,8,["modelValue","options"])]),o("div",ve,[fe,l(g,{class:"my-2",id:"planta",modelValue:s.planta,"onUpdate:modelValue":e[5]||(e[5]=t=>s.planta=t),options:E.value,optionLabel:"label",optionValue:"value",placeholder:"Todos"},null,8,["modelValue","options"])]),o("div",he,[ye,l(F,{class:"grid mt-3 ml-3",modelValue:s.status,"onUpdate:modelValue":e[6]||(e[6]=t=>s.status=t),inputId:"switch2"},null,8,["modelValue"])]),o("div",_e,[p.value?(h(),w(i,{key:0,style:{width:"15%"},class:"buttons flex align-items-center justify-content-center m-2",label:"Atualizar",icon:"pi pi-refresh",severity:"primary",onClick:a.atualizarFuncionario},null,8,["onClick"])):V("",!0),p.value?(h(),w(i,{key:1,style:{width:"15%"},class:"buttons flex align-items-center justify-content-center m-2",label:"Excluir",icon:"pi pi-trash",severity:"danger",onClick:e[7]||(e[7]=t=>a.deleteFuncionarioDialog=!0)})):V("",!0),l(i,{style:{width:"15%"},class:"flex align-items-center justify-content-center m-2 mr-0",label:"Voltar",icon:"pi pi-trash",severity:"primary",onClick:e[8]||(e[8]=t=>I())}),p.value?V("",!0):(h(),w(i,{key:2,style:{width:"15%"},class:"buttons flex align-items-center justify-content-center m-2",label:"Salvar",icon:"pi pi-check",severity:"info",onClick:A}))])])]),_:1})]),_:1},8,["activeIndex"]),l(M,{header:"Deletar Usuario",visible:a.deleteUsuarioDialog,"onUpdate:visible":e[12]||(e[12]=t=>a.deleteUsuarioDialog=t),style:{width:"400px"},modal:!0,closable:!1},{footer:u(()=>[l(i,{label:"Não",icon:"pi pi-times",onClick:e[10]||(e[10]=t=>a.deleteFuncionarioDialog=!1),class:"p-button-text"}),l(i,{label:"Sim",icon:"pi pi-check",onClick:e[11]||(e[11]=t=>a.deleteUsuario(a.item)),class:"p-button-text"})]),default:u(()=>[o("div",be,[ge,o("span",we,[S(" Você tem certeza que deseja deletar o Usuario "),o("b",null,k(a.item.id_cliente),1),S(" - "),o("b",null,k(a.item.nome),1),S(" ?")])])]),_:1},8,["visible"]),d.value?(h(),w(J,{key:0})):V("",!0)])])])}}};export{De as default};
