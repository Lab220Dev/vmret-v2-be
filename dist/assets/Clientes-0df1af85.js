import{r as f,e as K,m as H,q as J,C as Y,s as G,g as s,o as C,c as Q,h as a,w as i,z as I,a as T,l as V,d as l,S as W,i as y,t as A,k as X,y as r,A as Z}from"./index-808fe755.js";import{L as ee}from"./LoadingSpinner-dd6b9365.js";const te={class:"card"},le={class:"col-12"},ae={class:"flex justify-content-end"},oe=l("i",{class:"pi pi-search"},null,-1),ne={class:"grid"},ie={class:"col-12"},se={class:"card"},re={class:"p-fluid formgrid grid m-0 p-0"},ce={class:"full lg:col-6 md:col-12 sm:col-12"},de={class:""},ue=l("label",{for:"id_planta"},"Nome:",-1),me={class:"mt-4"},pe=l("label",{for:"cpfcnpj"},"CNPJ/CPF:",-1),fe={class:"full lg:col-6 md:col-6 sm:col-6"},ve=l("label",{for:"codigo"},"Menção Ficha Retirada:",-1),_e={class:"full xl:col-4 flex flex-column align-items-center m-0 lg:col-2 md:col-4 sm:col-12"},he=l("label",{class:"mt-3 ml-4",for:"switch1"},"Tem integração?",-1),ye={class:"full xl:col-4 flex flex-column align-items-center m-0 lg:col-2 md:col-4 sm:col-12"},ge=l("label",{class:"mt-3 ml-4",for:"switch2"},"Cliente Ativo?",-1),be={class:"mr-1 mt-4 grid justify-content-end"},we={class:"confirmation-content"},xe=l("i",{class:"pi pi-exclamation-triangle mr-1",style:{"font-size":"2rem"}},null,-1),Ce={class:""},Ie={__name:"Clientes",setup(Ve){const u=f(0),g=K(),$=H(),c=f(!1),j=f([]),_=f(!1),b=f(!1),w=f({}),x=f({global:{value:null,matchMode:Z.CONTAINS}});let n=J({nome:"",cpfcnpj:"",ativo:!0,usarApi:!1,textoretirada:""});const M=o=>{n=o.data,u.value=1,_.value=!0,v()},U=()=>{_.value?N():z()},z=async()=>{const o={...n};c.value=!0;try{const e=await V.post("/admin/cliente/adicionar",o,{headers:{Authorization:`Bearer ${g.token}`}});v(),u.value=0,S()}catch(e){console.error("Erro ao adicionar Clientes:",e)}finally{c.value=!1}},E=o=>{w.value=o,b.value=!0},P=async o=>{c.value=!0;let e={id_cliente:o.id_cliente};try{await V.post("/admin/cliente/delete",e,{headers:{Authorization:`Bearer ${g.token}`}}),$.add({severity:"success",summary:"Successful",detail:"Ciente Deletada",life:3e3}),b.value=!1,v()}catch{$.add({severity:"error",summary:"Error",detail:"Erro ao deletar a planta.",life:3e3})}finally{c.value=!1}},N=async()=>{c.value=!0;const o={id_cliente:n.id_cliente,...n};try{const e=await V.post("/admin/cliente/atualizar",o,{headers:{Authorization:`Bearer ${g.token}`}});v(),u.value=0,S()}catch(e){console.error("Erro ao atualizar Plantas:",e)}finally{c.value=!1}};Y(u,(o,e)=>{o!==e&&o===0&&(S(),v(),_.value=!1)});const S=()=>{n.nome="",n.cpfcnpj="",n.ativo=!0,n.created=new Date,n.usarApi=!1,n.textoretirada=""},v=async()=>{c.value=!0;try{const o=await V.post("/admin/cliente/listar",{headers:{Authorization:`Bearer ${g.token}`}});j.value=o.data}catch(o){console.error("Erro ao listar plantas:",o)}finally{c.value=!1}},L=o=>{if(!o)return"";try{const e=new Date(o);if(isNaN(e))throw new Error("Data inválida");const m=new Date(e.getTime()+e.getTimezoneOffset()*6e4),h=String(m.getDate()).padStart(2,"0"),k=String(m.getMonth()+1).padStart(2,"0"),p=m.getFullYear(),d=String(m.getHours()).padStart(2,"0"),D=String(m.getMinutes()).padStart(2,"0");return`${h}/${k}/${p} ${d}:${D}`}catch(e){return console.error("Erro ao formatar data:",e),"Data inválida"}};return G(()=>{v()}),(o,e)=>{const m=s("InputIcon"),h=s("InputText"),k=s("IconField"),p=s("Column"),d=s("Button"),D=s("DataTable"),B=s("TabPanel"),q=s("Textarea"),F=s("InputSwitch"),R=s("TabView"),O=s("Dialog");return C(),Q("div",te,[a(R,{activeIndex:u.value,"onUpdate:activeIndex":e[8]||(e[8]=t=>u.value=t)},{default:i(()=>[a(B,{header:"Listar Clientes"},{default:i(()=>[l("div",le,[a(D,{filters:x.value,"onUpdate:filters":e[1]||(e[1]=t=>x.value=t),value:j.value,selectionMode:"single",tableStyle:"min-width: 25%",rowsPerPageOptions:[5,10,20,50],stripedRows:"",dataKey:"id",metaKeySelection:!1,onRowSelect:M,globalFilterFields:["id_cliente","nome","last_login"]},{header:i(()=>[l("div",ae,[a(k,{iconPosition:"left"},{default:i(()=>[a(m,null,{default:i(()=>[oe]),_:1}),a(h,{modelValue:x.value.global.value,"onUpdate:modelValue":e[0]||(e[0]=t=>x.value.global.value=t),placeholder:"Busca"},null,8,["modelValue"])]),_:1})])]),default:i(()=>[a(p,{field:"id_cliente",header:"Id"}),a(p,{field:"nome",header:"Nome"}),a(p,{field:"ativo",header:"Ativo"},{body:i(({data:t})=>[l("i",{class:W(["pi",{"pi-check-circle text-green-500 ":t.ativo,"pi-times-circle text-red-500":!t.ativo}])},null,2)]),_:1}),a(p,{field:"last_login",header:"Último Login"},{body:i(({data:t})=>[y(A(L(new Date(t.last_login))),1)]),_:1}),a(p,{style:{"min-width":"8rem"}},{body:i(t=>[a(d,{icon:"pi pi-trash",outlined:"",rounded:"",severity:"danger",onClick:Se=>E(t.data)},null,8,["onClick"])]),_:1})]),_:1},8,["filters","value"])])]),_:1}),a(B,{header:"Adicionar Clientes"},{default:i(()=>[l("div",ne,[l("div",ie,[l("div",se,[l("form",{onSubmit:X(U,["prevent"])},[l("div",re,[l("div",ce,[l("div",de,[ue,y(),a(h,{class:"my-2",id:"id_planta",modelValue:r(n).nome,"onUpdate:modelValue":e[2]||(e[2]=t=>r(n).nome=t),required:""},null,8,["modelValue"])]),l("div",me,[pe,a(h,{class:"my-2",id:"cpfcnpj",modelValue:r(n).cpfcnpj,"onUpdate:modelValue":e[3]||(e[3]=t=>r(n).cpfcnpj=t),required:""},null,8,["modelValue"])])]),l("div",fe,[ve,a(q,{style:{overflow:"hidden","max-height":"200px","min-width":"500px"},modelValue:r(n).textoretirada,"onUpdate:modelValue":e[4]||(e[4]=t=>r(n).textoretirada=t),class:"my-2",rows:"5",cols:"30"},null,8,["modelValue"])]),l("div",_e,[he,a(F,{class:"grid mt-3 ml-3",modelValue:r(n).usarApi,"onUpdate:modelValue":e[5]||(e[5]=t=>r(n).usarApi=t),inputId:"switch1"},null,8,["modelValue"])]),l("div",ye,[ge,a(F,{class:"grid mt-3 ml-3",modelValue:r(n).ativo,"onUpdate:modelValue":e[6]||(e[6]=t=>r(n).ativo=t),inputId:"switch2"},null,8,["modelValue"])])]),l("div",be,[_.value?(C(),I(d,{key:0,style:{width:"15%"},class:"flex align-items-center justify-content-center m-2 mr-0",label:"Salvar",icon:"pi pi-check",severity:"primary",onClick:N})):T("",!0),a(d,{style:{width:"15%"},class:"flex align-items-center justify-content-center m-2 mr-0",label:"Voltar",icon:"pi pi-arrow-left",severity:"primary",onClick:e[7]||(e[7]=t=>u.value=0)}),_.value?T("",!0):(C(),I(d,{key:1,style:{width:"15%"},class:"flex align-items-center justify-content-center m-2 mr-0",label:"Salvar",icon:"pi pi-check",severity:"info",onClick:z}))])],32)])])])]),_:1})]),_:1},8,["activeIndex"]),a(O,{header:"Deletar Cliente",visible:b.value,"onUpdate:visible":e[11]||(e[11]=t=>b.value=t),style:{width:"400px"},modal:!0,closable:!1},{footer:i(()=>[a(d,{label:"Não",icon:"pi pi-times",onClick:e[9]||(e[9]=t=>o.deleteFuncionarioDialog=!1),class:"p-button-text"}),a(d,{label:"Sim",icon:"pi pi-check",onClick:e[10]||(e[10]=t=>P(w.value)),class:"p-button-text"})]),default:i(()=>[l("div",we,[xe,l("span",Ce,[y(" Você tem certeza que deseja deletar o Cliente "),l("b",null,A(w.value.id_cliente),1),y(" - "),l("b",null,A(w.value.nome),1),y(" ?")])])]),_:1},8,["visible"]),c.value?(C(),I(ee,{key:0})):T("",!0)])}}};export{Ie as default};
